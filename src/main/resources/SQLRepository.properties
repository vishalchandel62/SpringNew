#For LOCAL testing
VALID_RNB_REG=select RNB_PASS from COM_RNB_USER_MST where RNBID = ? and RNB_USER_STATUS = 'A'
VALID_RNB_REG_FOR_ALIAS=select RNB_PASS,RNBID from COM_RNB_USER_MST where ALIAS_NAME = ? and RNB_USER_STATUS = 'A'
#SELECT_COUNT_ALIAS_RNBID=SELECT COUNT(*) FROM RNBID_ALIASID_MAPPING WHERE CUSTOMER_ID = ?
SELECT_COUNT_ALIAS_RNBID=SELECT COUNT(*),CUSTOMER_ID FROM RNBID_ALIASID_MAPPING WHERE ALIAS_ID = ? group by CUSTOMER_ID
INSERT_ALIAS_CUSTID_MAPPING=INSERT INTO RNBID_ALIASID_MAPPING(ALIAS_ID,CUSTOMER_ID) VALUES(?,?)
SELECT_CUSTID_FOR_ALIAS=SELECT CUSTOMER_ID FROM RNBID_ALIASID_MAPPING WHERE ALIAS_ID= ?
SELECT_COUNT_FOR_PORTAL_EXIST=select count(*) from SME_APP_LOGIN_INFO where LOGIN_ID = ? and LOGIN_TYPE_PORTAL = 'Y'

VALID_DEBIT_REG=select RNB_DEBIT_CARD_NO,RNB_DEBIT_CARD_PASS,EXPIRY_DATE from COM_RNB_USER_MST where RNBID = ? and RNB_USER_STATUS = 'A'
VALID_DEBIT_REG_FOR_ALIAS=select RNB_DEBIT_CARD_NO,RNB_DEBIT_CARD_PASS,EXPIRY_DATE,RNBID from COM_RNB_USER_MST where ALIAS_NAME = ? and RNB_USER_STATUS = 'A'

VERIFY_OTP=select OTP_KEY,OTP_VALUE from COM_RNB_USER_MST where RNBID = ?
TAKE_MOB_NO=select RNB_MOB_NO from COM_RNB_USER_MST where RNBID = ?
UPDATE_OTP=update COM_RNB_USER_MST set OTP_VALUE =? where RNBID=? 

#FOR GET ALL AUS SIGNATORY FROM XREF TABLE
SELECT_AUS_SIGNATORY=SELECT DISTINCT a. COD_CUST  FROM VW_CH_ACCT_CUST_XREF a  WHERE COD_ACCT_NO IN    (SELECT COD_ACCT_NO    FROM VW_CH_ACCT_CUST_XREF    WHERE COD_CUST =      (SELECT  distinct COD_CUST      FROM VW_CH_ACCT_CUST_XREF      WHERE COD_ACCT_NO IN        (SELECT COD_ACCT_NO FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST= ?    AND COD_ACCT_CUST_REL='SOW'     )      AND COD_ACCT_CUST_REL='SOW'      )    )  AND Cod_Acct_Cust_Rel IN ('AUS','TRU','SOW')
#Change Query for AUS SIgnatory from Com_approver_mst on 09-01-2019
SELECT_AUS_SIGNATORY_FROM_APPROVER_TABLE=select DISTINCT APPROVER_CD from COM_APPROVE_MST where CUSTOMER_ID = ? and AUTH_STATUS = 'A' 


#for fd 
SELECT_FD_COUNT=SELECT COUNT(*) FROM SME_CREATE_FD_DTL WHERE CUSTOMER_ID = ? AND FD_ADD_STATUS =?
SELECT_FD_LIST_MAKER=SELECT CUSTOMER_ID,MAKER_ID,SOURCE_ACC_NO,DEPOSIT_AMT,JOINT_HOLDER_FALG,PRODUCT_CD,MONTHS,DAYS,SWEEP_IN_FLAG,BRANCH_CD,FLAG_SC_WAIVE,FLAG_RESTRICT_ACC,PAY_IN_MODE,PAY_IN_NARRATION,INTEREST_PAYOUT_FREQ,INTEREST_COMPOUNDING_FREQ,PRIN_PAYOUT_ACC,INTEREST_PAYOUT_ACC,PAN,TRANSACTIONAL_BRANCH,TO_CHAR(FD_ADD_DT, 'DD MON YYYY HH24:MI:SS'),REFERENCE_NO,INSTRUCTION_ACCOUNT_NO FROM SME_CREATE_FD_DTL WHERE MAKER_ID = ? AND FD_ADD_STATUS =?
UPDATE_APP_REJ_FD=UPDATE SME_CREATE_FD_DTL SET FD_ADD_STATUS = ? ,APPROVE_REJECT_DATE = SYSDATE ,REMARKS = ?,CUSTOMER_ID=? WHERE REFERENCE_NO = ?
SELECT_FD_DTL_FROM_DB=SELECT SOURCE_ACC_NO,DEPOSIT_AMT,JOINT_HOLDER_FALG,PRODUCT_CD,MONTHS,DAYS,SWEEP_IN_FLAG,BRANCH_CD,FLAG_SC_WAIVE,FLAG_RESTRICT_ACC,PAY_IN_MODE,PAY_IN_NARRATION,INTEREST_PAYOUT_FREQ,INTEREST_COMPOUNDING_FREQ,PRIN_PAYOUT_ACC,INTEREST_PAYOUT_ACC,PAN,TRANSACTIONAL_BRANCH,INSTRUCTION_ACCOUNT_NO FROM SME_CREATE_FD_DTL WHERE RES_RESFERENCE_NO = ?

#For Registration of User
RESISTER_USER=Insert into SME_REG_USER_INFO (CUST_ID,CUST_NAME,COMPANY_ID,COMPANY_NAME,RM_ID,HAS_MAKER,REGISTERED_DT,REG_ID,REG_MODE) values (?,?,?,?,?,?,sysdate,?,'MOBILE')
INSERT_APP_LOGIN_DETAILS_REG_TIME= Insert into SME_APP_LOGIN_INFO (LOGIN_ID,USERNAME,PASSWORD,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,TOKEN,LOGIN_NAME,REG_ID)values (?,?,?,?,?,?,?,?,?,?,?,?)
SELECT_REGI_ID=SELECT RESISTRAION_ID_SEQ.NEXTVAL FROM DUAL
CHECK_VALID_USER=SELECT REG_ID FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ? AND DEVICE_IMEI = ? AND TOKEN = ?
CHECK_VALID_USER1=SELECT TOKEN,REG_ID,LOGIN_COUNT,USER_LOCKED,USER_BLOCKED FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ?
#CHECK_VALID_USER2=SELECT COUNT(*) FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ? AND PASSWORD = ?
CHECK_VALID_USER2=SELECT COUNT(*),LOGIN_COUNT,TO_CHAR(LOGOUT_DATE, 'DD MON YYYY HH24:MI:SS'),REG_ID,USER_TYPE FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ? AND PASSWORD = ? GROUP BY LOGIN_COUNT, TO_CHAR(LOGOUT_DATE, 'DD MON YYYY HH24:MI:SS'),REG_ID,USER_TYPE
INSERT_LOGIN_DATE=UPDATE SME_APP_LOGIN_INFO SET LAST_REQUEST_TIME = sysdate, LOGIN_DATE = sysdate,LOGIN_COUNT = ?, LOGOUT_MODE = ?  WHERE REG_ID = ?

################ Added by 2157 on 20 july 2018 for MPIN count issues ############
UPDATE_MPIN_COUNT=UPDATE SME_APP_LOGIN_INFO SET MPIN_COUNT=0 WHERE REG_ID = ?

INSERT_LOGIN_DATE2=UPDATE SME_APP_LOGIN_INFO SET LAST_REQUEST_TIME = sysdate, LOGIN_DATE = sysdate WHERE REG_ID = ?
SELECT_REQ_TIME=select TO_CHAR(LAST_REQUEST_TIME, 'DD-MON-YYYY HH24:MI:SS') from SME_APP_LOGIN_INFO where LOGIN_ID = ?
UPDATE_REQ_TIME=UPDATE SME_APP_LOGIN_INFO SET LAST_REQUEST_TIME = sysdate WHERE LOGIN_ID = ?
#SET_REG_APIN_MPIN=UPDATE SME_REG_USER_INFO SET MPIN = ?, APIN = ? WHERE REG_ID = ?
SET_REG_APIN_MPIN=UPDATE SME_REG_USER_INFO SET MPIN = ?, APIN = ? WHERE CUST_ID = ?

#aDDED ON 22-01-2018 FOR EXPIRY PASSWORD DETAILS
INSERT_SME_REGISTRATION_DATE_DTL=INSERT INTO SME_REGISTRATION_DATE_DTL VALUES (?,?,sysdate,sysdate+?,?)
INSERT_SME_REGISTRATION_DATE_DTL_PORTAL=INSERT INTO SME_REGISTRATION_DATE_DTL VALUES (?,sysdate,?,?,sysdate+?)
UPDATE_SME_REGISTRATION_DATE_DTL=UPDATE SME_REGISTRATION_DATE_DTL SET PORTAL_REG_DATE = TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),MOBILE_REG_DATE =sysdate ,REMAIN_DATE_FOR_EXPIRE_M =sysdate+?, REMAIN_DATE_FOR_EXPIRE_P=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS') where REG_ID = ?
UPDATE_SME_REGISTRATION_DATE_DTL_PORTAL=UPDATE SME_REGISTRATION_DATE_DTL SET PORTAL_REG_DATE = sysdate,MOBILE_REG_DATE =TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS') ,REMAIN_DATE_FOR_EXPIRE_M =TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'), REMAIN_DATE_FOR_EXPIRE_P=sysdate+? where REG_ID = ?
COUNT_SME_REGISTRATION_DATE_DTL=SELECT COUNT(*),TO_CHAR(PORTAL_REG_DATE, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(MOBILE_REG_DATE, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(REMAIN_DATE_FOR_EXPIRE_M, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(REMAIN_DATE_FOR_EXPIRE_P, 'DD-MON-YYYY HH24:MI:SS') FROM SME_REGISTRATION_DATE_DTL WHERE REG_ID = ? group by PORTAL_REG_DATE,MOBILE_REG_DATE,REMAIN_DATE_FOR_EXPIRE_M,REMAIN_DATE_FOR_EXPIRE_P
DATE_DIFF_FOR_MOB_PASS=select extract( day from DATE_DIFF ) days from (select REMAIN_DATE_FOR_EXPIRE_M - sysdate as DATE_DIFF from SME_REGISTRATION_DATE_DTL where REG_ID = ?)
DATE_DIFF_FOR_PORTAL_PASS=select extract( day from DATE_DIFF ) days from (select REMAIN_DATE_FOR_EXPIRE_P - sysdate as DATE_DIFF from SME_REGISTRATION_DATE_DTL where REG_ID = ?)
#select (REMAIN_DATE_FOR_EXPIRE_P-sysdate) as DATE_DIFF from SME_REGISTRATION_DATE_DTL where REG_ID = ?

#SET_PASS_IN_APP_LOGIN=UPDATE SME_APP_LOGIN_INFO SET PASSWORD = ? WHERE REG_ID = ?
#SET_PASS_IN_APP_LOGIN=UPDATE SME_APP_LOGIN_INFO SET PASSWORD = ? WHERE LOGIN_ID = ?
SET_PASS_IN_APP_LOGIN=UPDATE SME_APP_LOGIN_INFO SET PASSWORD = ?,PORTAL_PASS = ? WHERE LOGIN_ID = ?
CHECK_REG_EXIST=select count(*) from SME_REG_USER_INFO where cust_id=?
CHECK_LOGOUT_MODE=SELECT COUNT(*),MPIN_COUNT FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ? AND LOGOUT_MODE = 'T' group by MPIN_COUNT
UPDATE_LOGOUT_MODE=UPDATE SME_APP_LOGIN_INFO SET LOGOUT_MODE = 'F',LAST_REQUEST_TIME = sysdate, LOGIN_DATE = sysdate WHERE REG_ID = ?
INSERT_KEY_FOR_IMEI=Insert into SME_IMEI_PUBKEY_ENTRY (IMEI_NO,PUB_KEY) values (?,?)
GET_IMEI=SELECT DEVICE_IMEI FROM SME_APP_LOGIN_INFO WHERE TOKEN = ?
GET_TOKEN=SELECT TOKEN FROM SME_APP_LOGIN_INFO WHERE DEVICE_IMEI = ?
GET_KEY=SELECT PUB_KEY FROM SME_IMEI_PUBKEY_ENTRY WHERE IMEI_NO = ?
#SELECT_MPIN=select count(*) from SME_REG_USER_INFO where CUST_ID = ? and MPIN = ?
SELECT_MPIN = SELECT count(*),A.MPIN_COUNT from SME_REG_USER_INFO S,SME_APP_LOGIN_INFO A  where S.CUST_ID =A.LOGIN_ID AND S.CUST_ID = ? and S.MPIN = ? GROUP BY (A.MPIN_COUNT)
CHECK_IMEI_EXIT=select count(*) from SME_APP_LOGIN_INFO where DEVICE_IMEI = ?



#New Query added by prabhat 18 may 2017
CHECK_IMEI_IN_PUBKEY_TABLE=select count(*) from SME_IMEI_PUBKEY_ENTRY where IMEI_NO = ?
DELETE_PUBKEY_TMP=DELETE FROM SME_IMEI_PUBKEY_ENTRY_TMP where IMEI_NO  =?
DELETE_LOGIN_TABLE_TMP=DELETE FROM SME_APP_LOGIN_INFO_TMP where LOGIN_ID  =?
DELETE_REG_TABLE_TMP=DELETE FROM SME_REG_USER_INFO_TMP where CUST_ID  =?




CHECK_IMEI_USER_EXIT=select count(*) from SME_APP_LOGIN_INFO where LOGIN_ID = ? and DEVICE_IMEI = ?
CHECK_USER_EXIT=select count(*) from SME_APP_LOGIN_INFO where LOGIN_ID = ? and LOGIN_TYPE_MOBILE = 'Y'
UPDATE_LOGIN_TOKEN=UPDATE SME_APP_LOGIN_INFO SET TOKEN = ? WHERE LOGIN_ID = ?
LOGOUT_USER=UPDATE SME_APP_LOGIN_INFO SET LOGOUT_DATE = sysdate,LOGOUT_MODE = ?, SESSION_ID = ? WHERE LOGIN_ID = ?
UPDATE_LOGIN_FAILURE_UPDATE=UPDATE SME_APP_LOGIN_INFO SET LAST_FAILURE_ATTEMPT_TIME = sysdate,LOGIN_COUNT=? WHERE LOGIN_ID = ?
UPDATE_MPIN_FAILURE_UPDATE=UPDATE SME_APP_LOGIN_INFO SET LAST_FAILURE_ATTEMPT_TIME = sysdate,MPIN_COUNT=? WHERE LOGIN_ID = ?
UPDATE_MPIN_SUCCESS_UPDATE=UPDATE SME_APP_LOGIN_INFO SET LAST_FAILURE_ATTEMPT_TIME = sysdate,MPIN_COUNT=0 WHERE LOGIN_ID = ?
USER_LOCKED=UPDATE SME_APP_LOGIN_INFO SET USER_LOCKED='Y' WHERE LOGIN_ID = ?
#Added By Deepak For CHECKER BlockUnBlockFlow on 26-08-2022 Added Only USER_BLOCKED Field
CHANGE_LOGIN_PASS=update SME_APP_LOGIN_INFO set PASSWORD = ?,LAST_REQUEST_TIME = sysdate,LOGIN_COUNT=0,MPIN_COUNT=0,USER_LOCKED='N',USER_BLOCKED='N' where LOGIN_ID = ? 
CHANGE_REG_MPIN_APIN=update SME_REG_USER_INFO set MPIN = ?,APIN = ? where CUST_ID = ?


#FOR LOGIN TO MAKER
CHECK_VALID_MAKER_USER=select REG_ID,LOGIN_COUNT,USER_LOCKED,FIRST_LOGIN from SME_APP_LOGIN_INFO where LOGIN_ID = ?
UPDATE_FIRST_LOGIN_STATUS=update SME_APP_LOGIN_INFO set FIRST_LOGIN = 'N' where LOGIN_ID = ?
SELECT_MAKER_DTL=select SMEMAKERNAME,SMEMAILID,SMEMAKERCD,MOBNO from COM_MAKER_MST where MAKER_ALIAS_NAME = ? AND ACTIVE_FLAG = 'Y'
SELECT_MAKER_SERVICE_CD=select SERVICE_CD from COM_SERVICE_MAKER_MST where SMEMAKERCD = ? AND ACTIVE_FLAG = 'Y'
CAHNGE_PASSWORD_MAKER=update SME_APP_LOGIN_INFO set PASSWORD = ?, FIRST_LOGIN = 'N',LAST_REQUEST_TIME = sysdate where LOGIN_ID = ?
UPDATE_MAKER_COUNT=update SME_APP_LOGIN_INFO set LOGIN_COUNT = 0,LAST_REQUEST_TIME = sysdate where LOGIN_ID = ?
SELECT_COUNT_MAKER_EXITS=select count(*) from COM_MAKER_MST where MAKER_ALIAS_NAME = ? and ACTIVE_FLAG = 'Y'
SELECT_COUNT_EMAILID_FOR_MAKER=select count(*),SMEMAILID,SALUTATION,SMEMAKERNAME from COM_MAKER_MST where MAKER_ALIAS_NAME = ? AND ACTIVE_FLAG = 'Y' group by SMEMAILID,SALUTATION,SMEMAKERNAME 

#Newly added script for maker changes by prabhat dated 13 SEP 2017 
DELETE_MAKER=UPDATE COM_MAKER_MST SET ACTIVE_FLAG = 'N', MAKER_CD = ?, MAKER_DT = SYSDATE , MAKER_CAL_DT = SYSDATE WHERE MAKER_ALIAS_NAME = ? AND ACTIVE_FLAG = 'Y'
DELETE_MAKER_SERVICE_LIST=UPDATE COM_SERVICE_MAKER_MST SET ACTIVE_FLAG = 'N', MAKER_CD = ?, MAKER_DT = SYSDATE , MAKER_CAL_DT = SYSDATE WHERE SMEMAKERCD = ? AND ACTIVE_FLAG = 'Y'
DELETE_MAKER_LOGIN_DTL=DELETE SME_APP_LOGIN_INFO WHERE LOGIN_ID = ?

#For Create Maker Query
SELECT_MAKER_LIST=select MAKER_ALIAS_NAME,SMEMAKERNAME,MOBNO,SMEMAILID,ACTIVE_FLAG,SMEMAKERCD,SALUTATION,TRANSACTIONCNT from COM_MAKER_MST where AUTHORIZER_CUST_ID = ? and ACTIVE_FLAG = 'Y' and MAKER_ALIAS_NAME is not null order by SMEMAKERNAME
SELECT_MAKER_SERVICE_LIST=select SERVICE_CD from COM_SERVICE_MAKER_MST where SMEMAKERCD = ?
SELECT_SERVICE_LIST=select SERVICE_CD,SERVICE_DESC from COM_SERVICE_MST where ACTIVE_FLAG = 'Y' and SERVICE_CD in (
SELECT_CLUB_SERVICE_LIST=SELECT CLUB_SERVICE_CODE,CLUB_SERVICE_DESC,MAIN_SERVICE_LIST FROM COM_CLUB_SERVICE_MST WHERE ACTIVE_FLAG = 'A' order by CLUB_SEQUENCE asc
#CREATE_NEW_MAKER=Insert into COM_MAKER_MST (SMEMAKERCD,SMEMAKERNAME,SMEMAILID,MOBNO,AUTHORIZER_CUST_ID,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,PASSWORD,MAKER_ALIAS_NAME,SALUTATION) values (?,?,?,?,?,?,'A',?,sysdate,sysdate,?,sysdate,sysdate,'Y',1,?,?,?)
CREATE_NEW_MAKER=Insert into COM_MAKER_MST (SMEMAKERCD,SMEMAKERNAME,SMEMAILID,MOBNO,AUTHORIZER_CUST_ID,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,PASSWORD,MAKER_ALIAS_NAME,SALUTATION,INTIATED_TIME,TOKEN,FORGO_PASS_FLAG,TRANSACTIONCNT,AUTHOR_TIME) values (?,?,?,?,?,?,'A',?,sysdate,sysdate,?,sysdate,sysdate,'Y',1,?,?,?,sysdate,?,?,?,systimestamp)

CREATE_NEW_MAKER_TMP=Insert into COM_MAKER_MST_TMP (SMEMAKERCD,SMEMAKERNAME,SMEMAILID,MOBNO,AUTHORIZER_CUST_ID,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,PASSWORD) values (?,?,?,?,?,MAKER_MASTER_SEQ.NEXTVAL,'A',?,sysdate,sysdate,?,sysdate,sysdate,'Y',1,?)
CHECK_MAKER_EXIST=select count(*),SMEMAILID,PASSWORD,ID from COM_MAKER_MST where MAKER_ALIAS_NAME = ? and AUTHORIZER_CUST_ID = ? group by SMEMAILID,PASSWORD,ID
#UPDATE_MAKER=update COM_MAKER_MST set SMEMAKERNAME = ?,SMEMAILID = ?,MOBNO = ?,AUTHOR_CD = ?,AUTHOR_DT = sysdate,AUTHOR_CAL_DT =sysdate,LAST_CHANGE_ID =? ,PASSWORD =?,AUTH_STATUS = 'A',ACTIVE_FLAG = 'Y' where SMEMAKERCD = ? and AUTHORIZER_CUST_ID = ?
UPDATE_MAKER=UPDATE COM_MAKER_MST set SMEMAKERNAME = ?,SMEMAILID = ?,MOBNO = ?,AUTHOR_DT = sysdate,AUTHOR_CAL_DT =sysdate,LAST_CHANGE_ID =? ,PASSWORD =?,AUTH_STATUS = 'A',ACTIVE_FLAG = 'Y',SALUTATION = ?,TRANSACTIONCNT=?,FORGO_PASS_FLAG='P' where MAKER_ALIAS_NAME = ? and AUTHORIZER_CUST_ID = ?
UPDATE_MAKER_WITHOUT_PASSWORD=UPDATE COM_MAKER_MST set SMEMAKERNAME = ?,SMEMAILID = ?,MOBNO = ?,AUTHOR_DT = sysdate,AUTHOR_CAL_DT =sysdate,LAST_CHANGE_ID =?,AUTH_STATUS = 'A',ACTIVE_FLAG = 'Y',SALUTATION = ? ,TRANSACTIONCNT=? where MAKER_ALIAS_NAME = ? and AUTHORIZER_CUST_ID = ?
UPDATE_MAKER_TMP=update COM_MAKER_MST_TMP set SMEMAKERNAME = ?,SMEMAILID = ?,MOBNO = ?,AUTHOR_CD = ?,AUTHOR_DT = sysdate,AUTHOR_CAL_DT =sysdate,LAST_CHANGE_ID =? ,PASSWORD =?,AUTH_STATUS = 'A',ACTIVE_FLAG = 'Y' where SMEMAKERCD = ? and AUTHORIZER_CUST_ID = ?
UPDATE_LOGIN_INFO_PASSWORD=update SME_APP_LOGIN_INFO set PASSWORD = ?,FIRST_LOGIN = 'Y' where LOGIN_ID = ?
CHECK_MAKER_LOGIN_EXIT=select count(*) from SME_APP_LOGIN_INFO where LOGIN_ID = ?
SME_MAKER_DTL_INSERT_INTO_LOGIN_TABLE=Insert into SME_APP_LOGIN_INFO (LOGIN_ID,USERNAME,LOGIN_DATE,LOGOUT_DATE,LOGOUT_MODE,EXCEPTION_CD,PASSWORD,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,TOKEN,LOGIN_NAME,LAST_REQUEST_TIME,REG_ID,LOGIN_COUNT,LAST_FAILURE_ATTEMPT_TIME,USER_LOCKED,FIRST_LOGIN,USER_TYPE) values (?,?,null,null,'T',null,?,'NA','NA','NA','NA',null,'NA','NA','NA',null,RESISTRAION_ID_SEQ.NEXTVAL,0,null,'N','Y','M')
SME_MAKER_DTL_UPDATE_INTO_LOGIN_TABLE=update SME_APP_LOGIN_INFO set USERNAME = ?,PASSWORD = ?,LOGIN_COUNT = '0',USER_LOCKED = 'N' ,FIRST_LOGIN = ? where LOGIN_ID = ?
SME_MAKER_DTL_UPDATE_INTO_LOGIN_TABLE_WITHOUT_PASSWORD=update SME_APP_LOGIN_INFO set USERNAME = ?,LOGIN_COUNT = '0',USER_LOCKED = 'N' where LOGIN_ID = ?
CHECK_MAKER_SERVICE_EXITS=select count(*) from COM_SERVICE_MAKER_MST where SMEMAKERCD = ? and ACTIVE_FLAG = 'Y'
CREATE_NEW_MAKER_SERVICE=Insert into COM_SERVICE_MAKER_MST (SMEMAKERCD,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID) values (?,?,SERVICE_MAKERID_SEQ.NEXTVAL,'A',?,sysdate,sysdate,?,sysdate,sysdate,'Y',1)
UPDATE_MAKER_SERVICE=update COM_SERVICE_MAKER_MST set SERVICE_CD = ?,AUTH_STATUS = 'A',AUTHOR_CD = ?, AUTHOR_DT = sysdate ,AUTHOR_CAL_DT = sysdate ,ACTIVE_FLAG = 'Y' where SMEMAKERCD = ?
#For TEMP insertion query
INSERT_KEY_FOR_IMEI_TMP=Insert into SME_IMEI_PUBKEY_ENTRY_TMP (IMEI_NO,PUB_KEY,TOKEN) values (?,?,?)
DELETE_KEY_TMP_IF_EXIST=DELETE SME_IMEI_PUBKEY_ENTRY_TMP where IMEI_NO = ?
DELETE_KEY_TMP_IF_EXIST1=DELETE SME_IMEI_PUBKEY_ENTRY_TMP where TOKEN = ?

#For_CHECKER BlockUnBlockFlow By Deepak on 02-08-2022
GET_SINGLE_CUSTOMER_DATA_FROM_LOGIN_TABLE=SELECT USER_LOCKED,USER_BLOCKED FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID= ? AND USER_TYPE= ?
UPDATE_CUSTOMER_FOR_BLOCK=UPDATE SME_APP_LOGIN_INFO SET USER_BLOCKED='Y' WHERE LOGIN_ID=? AND USER_TYPE= ?
UPDATE_CUSTOMER_FOR_UNBLOCK=UPDATE SME_APP_LOGIN_INFO SET USER_LOCKED='N', USER_BLOCKED='N' WHERE USER_TYPE='A' AND LOGIN_ID = ?
UPDATE_OLD_TOKEN_FOR_SESSION_OUT = UPDATE MSME_SECURITYLOG_DTL SET TIMEDIFFERENCE=0, SESSION_ACTIVE='N' WHERE USERID= ? AND REQUESTTIME>SYSDATE-2  

#For_CHECKER BlockUnBlockFlow By Deepak on 17-08-2022 
CHECK_USER_VALID=SELECT count(*) from SME_APP_LOGIN_INFO where LOGIN_ID = ? AND USER_TYPE= ?   
SELECT_SRN_IF_EMPTY=SELECT MAX(SRN) FROM SME_MAINTAIN_API_DTL WHERE CUSTOMER_ID=? AND  TO_CHAR(API_INITIATE_DATETIME,'dd-MM-yy')=TO_CHAR(SYSDATE,'dd-MM-yy')


#UPDATE Pub Key Main Table
UPDATE_PUBKEY=update SME_IMEI_PUBKEY_ENTRY set PUB_KEY = ? where IMEI_NO = ?


GET_KEY_TMP=SELECT PUB_KEY FROM SME_IMEI_PUBKEY_ENTRY_TMP WHERE TOKEN = ?
RESISTER_USER_TMP=Insert into SME_REG_USER_INFO_TMP (CUST_ID,CUST_NAME,COMPANY_ID,COMPANY_NAME,RM_ID,HAS_MAKER,REGISTERED_DT,REG_ID,REG_MODE) values (?,?,?,?,?,?,sysdate,?,?)

DELETE_USER_TMP_IF_EXIST=DELETE SME_REG_USER_INFO_TMP where CUST_ID  =?
INSERT_APP_LOGIN_DETAILS_REG_TIME_TMP_MOBILE=Insert into SME_APP_LOGIN_INFO_TMP (LOGIN_ID,USERNAME,PASSWORD,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,TOKEN,LOGIN_NAME,REG_ID,USER_TYPE,LOGIN_TYPE_MOBILE)values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)
INSERT_APP_LOGIN_DETAILS_REG_TIME_TMP_PORTAL=Insert into SME_APP_LOGIN_INFO_TMP (LOGIN_ID,USERNAME,PASSWORD,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,TOKEN,LOGIN_NAME,REG_ID,USER_TYPE,LOGIN_TYPE_PORTAL)values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)

DELETE_APP_LOGIN_TMP_IF_EXIST=DELETE SME_APP_LOGIN_INFO_TMP where LOGIN_ID  =?
SELECT_USER_DAT_FROM_VERTUAL=SELECT COD_CUST_ID, NAM_CUST_FULL, REF_CUST_TELEX, REF_CUST_EMAIL, SSC,SERVICE_RM,ASSET_RM,SERVICE_RM_EMAILID,SERVICE_RM_MOB,ASSET_RM_MOB,ASSET_RM_EMAILID,ASSET_RM_NAME,SERVICE_RM_NAME FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID = ?


#As per new registration
INSERT_KEY_FOR_IMEI_MAIN=Insert into SME_IMEI_PUBKEY_ENTRY select IMEI_NO,PUB_KEY from SME_IMEI_PUBKEY_ENTRY_TMP where TOKEN = ?
INSERT_LOGIN_DETAIL_MAIN=insert into SME_APP_LOGIN_INFO select * from SME_APP_LOGIN_INFO_TMP where LOGIN_ID = ?
INSERT_REG_CRED_MAIN=insert into SME_REG_USER_INFO select * from SME_REG_USER_INFO_TMP where CUST_ID = ?
UPDATE_TOKEN=UPDATE SME_APP_LOGIN_INFO SET TOKEN = ? WHERE DEVICE_IMEI = ?
GET_IMEI_TMP=SELECT PUB_KEY FROM SME_IMEI_PUBKEY_ENTRY_TMP WHERE TOKEN = ?
INSERT_DOC_UPLOAD_DETAIL=Insert into CUST_DOC_UPLOAD_DETAILS (CUSTOMER_ID,DOC_CAT,DOC_TYPE,DOC_ID,DOC_FILE_NAME,PURPOSE,REMARKS,UPLOAD_DATE,BROWSE_FILE_NAME,REQ_ID,CHUNK_SIZE,CHUNK_TOTAL_NO,FILE_TYPE,MAKER_ID,MAKER_STATUS,FREQUENCY_CD,FREQUENCY_VALUE,EXPIRY_DT) values (?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?)     
SELECT_DOC_UPLOAD_DEATIL=select DOC_CAT,DOC_TYPE,DOC_ID,CHUNK_SIZE,CHUNK_TOTAL_NO,CHUNK_NO,FILE_TYPE,CUSTOMER_ID,REMARKS,MAKER_STATUS,EXPIRY_DT,FREQUENCY_CD,FREQUENCY_VALUE,UPLOADED_FILE_NAME,MAKER_ID from CUST_DOC_UPLOAD_DETAILS where REQ_ID = ?
UPDATE_DOC_UPLOAD_DETAIL=update CUST_DOC_UPLOAD_DETAILS set UPLOAD_STATUS = 'P',CHUNK_NO = ? where REQ_ID = ?
UPDATE_DOC_UPLOAD_DETAIL1=update CUST_DOC_UPLOAD_DETAILS set UPLOAD_STATUS = ?,SERVER_UPLOAD_TIME = sysdate,UPLOADED_FILE_NAME = ? where REQ_ID = ?

SELECT_DOC_UPLOAD_DATA=SELECT CUSTOMER_ID,DOC_CAT,DOC_TYPE,DOC_ID,DOC_FILE_NAME,PURPOSE,REMARKS FROM CUST_DOC_UPLOAD_DETAILS WHERE REQ_ID = ?
UPDATE_DOC_UPLOAD1=UPDATE CUST_DOC_UPLOAD_DETAILS SET UPLOAD_STATUS='S-30',SERVER_UPLOAD_TIME=sysdate,DOC_INDEX_NO=? where REQ_ID = ?
UPDATE_DOC_UPLOAD2=UPDATE CUST_DOC_UPLOAD_DETAILS SET UPLOAD_STATUS='M-20' where REQ_ID = ?
SELECT_BANNER_IMG_DTL=SELECT PRIO_IMG_NO,DES_IMG_NAME,FOR_IMAGE_FLAG FROM RC_COM_PROMO_MST WHERE AUTH_STATUS = 'A' and FOR_IMAGE_FLAG = ? and ROWNUM < 5 order by PRIO_IMG_NO 
INSERT_REG_DATA_BACKUP=insert into SME_REG_USER_INFO_BACKUP select * from SME_REG_USER_INFO where CUST_ID = ?
SELECT_PORTAL_CREDENTIAL_FOR_REG_TABLE=SELECT MPIN,APIN FROM SME_REG_USER_INFO WHERE CUST_ID = ?
UPDATE_MOBILE_CREDENTIAL_AFTER_PORTAL_SET_PASSWORD=UPDATE SME_REG_USER_INFO SET MPIN = ?, APIN = ? WHERE CUST_ID = ?


DELETE_REG_DATA_MAIN=DELETE FROM SME_REG_USER_INFO where CUST_ID  =?
DELETE_LOGIN_DATA_MAIN=DELETE FROM SME_APP_LOGIN_INFO where LOGIN_ID  =?
DELETE_IMEI_MAIN=DELETE FROM SME_IMEI_PUBKEY_ENTRY where IMEI_NO  =?

SELECT_LOGINID=SELECT LOGIN_ID FROM SME_APP_LOGIN_INFO WHERE DEVICE_IMEI = ?
DELETE_LOGIN_TABLE=DELETE FROM SME_APP_LOGIN_INFO where DEVICE_IMEI = ? 
DELETE_LOGIN_TABLE_NXT=DELETE FROM SME_APP_LOGIN_INFO where LOGIN_ID = ? 
DELETE_PUBKEY_TABLE=DELETE FROM SME_IMEI_PUBKEY_ENTRY where IMEI_NO = ? 
SELECT_LOGIN_IMEI=SELECT DEVICE_IMEI,REG_ID,PORTAL_PASS,USER_TYPE FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ?
#select REG_ID,PORTAL_PASS,USER_TYPE from SME_APP_LOGIN_INFO where LOGIN_ID = ?

#For Group Beneficiary 
#INSERT_GROUP_BENE_DTL=Insert into SME_GROUP_BENE_DTL (CUSTOMER_ID,GROUP_ID,BENE_ID,BENE_DTL,GROUP_MK_DATE,BENE_ADD_DATE,BENE_MOD_DATE,GROUP_MOD_DATE) values (?,?,?,?,SYSDATE,SYSDATE,SYSDATE,SYSDATE)
INSERT_GROUP_BENE_DTL=Insert into SME_GROUP_BENE_DTL (CUSTOMER_ID,GROUP_ID,BENE_ID,BENE_DTL,GROUP_MK_DATE,BENE_ADD_DATE,BENE_MOD_DATE,GROUP_MOD_DATE,REF_NO,GROUP_MODE,MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT)values ( ?,?,?,?,SYSDATE,SYSDATE,SYSDATE,SYSDATE,?,?,?,?,?)

INSERT_GROUP_BENE_DTL_NEW=Insert into SME_GROUP_BENE_DTL (CUSTOMER_ID,GROUP_ID,BENE_ID,BENE_DTL,GROUP_MK_DATE,BENE_ADD_DATE,BENE_MOD_DATE,GROUP_MOD_DATE,REF_NO,GROUP_MODE,MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT) values ( ?,?,?,?,SYSDATE,SYSDATE,SYSDATE,SYSDATE,?,?,?,?,?)

GET_DELETE_GROUP_BENE_REF_NO=SELECT DISTINCT REF_NO FROM SME_GROUP_BENE_DTL where CUSTOMER_ID = ? AND GROUP_ID = ?
DELETE_GROUP_BENE_DTL=Update SME_GROUP_BENE_DTL set GROUP_ADD_FLG = 'N',BENE_ADD_FLAG = 'N' , GROUP_MOD_DATE = SYSDATE,GROUP_MODE = ?,MAKER_ID = ?,BENE_ADD_STATUS_M = ?,BENE_MAKER_DT = ? where CUSTOMER_ID = ? AND GROUP_ID = ?
INSERT_GROUP_BENE_DTL_VIA_MAKER=INSERT into SME_GROUP_BENE_DTL_TMP (CUSTOMER_ID,GROUP_ID,BENE_MOD_DATE,BENE_ADD_FLAG,GROUP_ADD_FLG,GROUP_MOD_DATE,MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT,REF_NO,GROUP_MODE,GROUP_MK_DATE,BENE_ID,BENE_DTL) values(?,?,sysdate,'Y','Y',sysdate,?,'I',sysdate,?,'D',sysdate,'NA',?)
SELECT_GROUP_LIST=SELECT DISTINCT GROUP_ID FROM SME_GROUP_BENE_DTL WHERE CUSTOMER_ID = ? AND GROUP_ADD_FLG = 'Y' AND (BENE_ADD_STATUS_M is null or BENE_ADD_STATUS_M = 'A')
SELECT_GROUP_LIST1=SELECT DISTINCT GROUP_ID FROM SME_GROUP_BENE_DTL WHERE CUSTOMER_ID  IN (SELECT CUSTOMER_ID FROM SME_REG_USER_INFO WHERE COMPANY_ID=?) AND GROUP_ADD_FLG = 'Y' AND (BENE_ADD_STATUS_M is null or BENE_ADD_STATUS_M = 'A')
SELECT_GROUP_DTL=SELECT BENE_DTL,CUSTOMER_ID FROM SME_GROUP_BENE_DTL WHERE CUSTOMER_ID = ? AND GROUP_ID = ? AND BENE_ADD_FLAG = 'Y' AND GROUP_ADD_FLG = 'Y'
SELECT_GROUP_DTL1=SELECT BENE_DTL,CUSTOMER_ID FROM SME_GROUP_BENE_DTL WHERE CUSTOMER_ID IN (SELECT DISTINCT(APPROVER_CD) FROM COM_APPROVE_MST WHERE CUSTOMER_ID=?)  AND GROUP_ID = ? AND BENE_ADD_FLAG = 'Y' AND GROUP_ADD_FLG = 'Y'
CHECK_GROUP_EXIT=SELECT COUNT(*),REF_NO FROM SME_GROUP_BENE_DTL WHERE CUSTOMER_ID = ? AND GROUP_ID = ? GROUP BY REF_NO
CHECK_GROUP_BENE_EXIT=SELECT COUNT(*) FROM SME_GROUP_BENE_DTL WHERE CUSTOMER_ID = ? AND BENE_ID = ? AND GROUP_ID = ?
UPDATE_GROUP_BENE=UPDATE SME_GROUP_BENE_DTL SET BENE_DTL = ? , GROUP_ADD_FLG = 'Y' , BENE_ADD_FLAG = 'Y' , BENE_MOD_DATE = SYSDATE , GROUP_MOD_DATE = SYSDATE,GROUP_MODE = ?,MAKER_ID = ?,BENE_ADD_STATUS_M = ?,BENE_MAKER_DT = ? WHERE CUSTOMER_ID = ? AND GROUP_ID = ? AND BENE_ID = ?
############ FOR MAKER INFORMATION BY 2157 ON 17 APR 2018
SELECT_GROUP_MAKER_INFO=SELECT DISTINCT MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT FROM SME_GROUP_BENE_DTL_TMP WHERE REF_NO = ?
DELETE_BENEID_FROM_GROUP_BENEID=delete from SME_GROUP_BENE_DTL where CUSTOMER_ID = ? and BENE_ID = ?


SELECT_TRANSFER_TYPE_FROM_BENELIST=SELECT BENE_TRANSFER_TYPE FROM SME_BENEFICIARY_DTL WHERE BENE_ID = ? AND CUSTOMER_ID = ?
SELECT_BENE_DTL_FROM_GROUP_LIST=SELECT DISTINCT BENE_DTL FROM SME_GROUP_BENE_DTL WHERE BENE_ID = ? AND CUSTOMER_ID = ?
UPDATE_BENEDTL_FROM_GROUPLIST=UPDATE SME_GROUP_BENE_DTL SET BENE_DTL = ? WHERE BENE_ID = ? AND CUSTOMER_ID = ?


INSERT_GROUP_BENE_DTL_MAKER=INSERT into SME_GROUP_BENE_DTL_TMP (CUSTOMER_ID,GROUP_ID,BENE_ID,BENE_DTL,GROUP_MK_DATE,BENE_ADD_DATE,BENE_MOD_DATE,GROUP_MOD_DATE,MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT,REF_NO,GROUP_MODE)
#ADDED BY PRABHAT ON 04/09/17
DELETE_EXITS_GROUP_FROM_TMP=DELETE SME_GROUP_BENE_DTL_TMP WHERE CUSTOMER_ID = ? AND MAKER_ID = ? AND GROUP_ID = ? AND BENE_ADD_STATUS_M = 'I'
COUNT_GROUP_EXIST_IN_TEMP_TABLE=SELECT COUNT(*) FROM SME_GROUP_BENE_DTL_TMP WHERE CUSTOMER_ID = ? AND GROUP_ID = ? AND BENE_ADD_STATUS_M = 'I'
#For Group Maker list
#SELECT_GROUP_ID=SELECT distinct GROUP_ID FROM SME_GROUP_BENE_DTL_TMP WHERE MAKER_ID = ? AND BENE_ADD_STATUS_M = ?
SELECT_GROUP_ID=SELECT distinct GROUP_ID FROM SME_GROUP_BENE_DTL_TMP WHERE MAKER_ID = ? AND ((CUSTOMER_ID = ? AND BENE_ADD_STATUS_M = 'I' AND GROUP_MODE = 'N') OR (CUSTOMER_ID = ? AND BENE_ADD_STATUS_M = 'I' AND GROUP_MODE IN ('M','D')))
SELECT_GROUP_DTL_TMP=SELECT BENE_DTL,GROUP_MK_DATE,MAKER_ID,REF_NO,GROUP_MODE FROM SME_GROUP_BENE_DTL_TMP WHERE CUSTOMER_ID IN (?,?) AND GROUP_ID = ? AND BENE_ADD_FLAG = 'Y' AND GROUP_ADD_FLG = 'Y' AND BENE_ADD_STATUS_M = ?
SELECT_REF_NO_FOR_GROUP=SELECT ADD_GROUP_SEQ.NEXTVAL FROM DUAL
UPDATE_MAKER_GROUP_SATUS=update SME_GROUP_BENE_DTL_TMP set BENE_ADD_STATUS_M = ?,GROUP_MOD_DATE = sysdate,COMMENTS =?,CUSTOMER_ID=? where REF_NO = ?
DLETE_MAKER_GROUP_ENTRY_FROM_TMP_TABLE=DELETE SME_GROUP_BENE_DTL_TMP WHERE REF_NO = ? AND BENE_ADD_STATUS_M = 'A'



#For Loan And Trade Summary
#SELECT_LOAN_DTL=SELECT DISTINCT(L.CONTRACT_REF_NO),L.PRINCIPAL_OUTSTANDING_BAL,L.AMOUNT,L.MATURITY_DATE FROM VW_LOAN_DTL L WHERE L.COUNTERPARTY=?
#SELECT_ODCC_DTL=SELECT COD_CUST,BALANCE_AVAILABE,COD_ACCT_NO FROM VW_OD WHERE COD_CUST=?
#SELECT_LINE_ID=SELECT DISTINCT(LINE_ID) AS LINE_ID,regexp_substr(LINE_ID,'\\d+$') AS ID from VW_LIMITS WHERE CUSTOMER_NO=? AND MAIN_LINE IS NULL
#SELECT_MAIN_LINE_LIMIT=SELECT LINE_ID,UTILISATION,LIMIT_AMOUNT,LINE_EXPIRY_DATE,DESCRIPTION from VW_LIMITS where MAIN_LINE=? AND CUSTOMER_NO=?
#SELECT_LIMIT_UTILIZATION=SELECT REF_NO,CCY,AMT FROM VW_LIMIT_UTIL WHERE CUST_ID=? AND LINE_ID=?
#SELECT_PRE_SHIPMENT= select COUNTERPARTY,CONTRACT_REF_NO,CURRENCY,PRINCIPAL_OUTSTANDING_BAL  from vw_loan_dtl where COUNTERPARTY=? AND product in ('PCFC','EPCL')
#SELECT_POST_SHIPMENT= select COUNTERPARTY, CONTRACT_REF_NO,CONTRACT_CCY, BILL_DUE_AMT  from vw_bills_post_shipmnt where COUNTERPARTY=?
#SELECT_BG=select COUNTERPARTY, CONTRACT_REF_NO, CONTRACT_CCY, OS_LIABILITY from glbl_temp_bg where COUNTERPARTY=?
#SELECT_LC=select COUNTERPARTY, CONTRACT_REF_NO, CONTRACT_CCY, OS_LIABILITY from glbl_temp_lc where COUNTERPARTY=?

#For Loan And Trade Summary
SELECT_LOAN_DTL=SELECT DISTINCT(L.CONTRACT_REF_NO),L.PRINCIPAL_OUTSTANDING_BAL,L.LCY_AMOUNT,L.MATURITY_DATE,L.CURRENCY,L.AMOUNT FROM VW_LOAN_DTL L WHERE L.COUNTERPARTY=?
SELECT_ODCC_DTL=SELECT COD_CUST,BALANCE_AVAILABE,COD_ACCT_NO FROM VW_OD WHERE COD_CUST=?
#SELECT_LINE_ID=SELECT DISTINCT(LINE_ID) AS LINE_ID,regexp_substr(LINE_ID,'(\\d+)$') AS ID from VW_LIMITS WHERE CUSTOMER_NO=? AND MAIN_LINE IS NULL
#SELECT_MAIN_LINE_LIMIT=SELECT LINE_ID,UTILISATION,LIMIT_AMOUNT,LINE_EXPIRY_DATE,DESCRIPTION from VW_LIMITS where MAIN_LINE=cast(? as char(33)) AND CUSTOMER_NO=?
#SELECT_LIMIT_UTILIZATION=SELECT REF_NO,CCY,AMT FROM VW_LIMIT_UTIL WHERE CUST_ID=? AND LINE_ID=?
SELECT_PRE_SHIPMENT= select COUNTERPARTY,CONTRACT_REF_NO,CURRENCY,PRINCIPAL_OUTSTANDING_BAL,BOOKING_DATE  from vw_loan_dtl where COUNTERPARTY=? AND product in ('PCFC','EPCL')
SELECT_POST_SHIPMENT= select COUNTERPARTY, CONTRACT_REF_NO,CONTRACT_CCY, BILL_DUE_AMT,BOOK_DATE  from vw_bills_post_shipmnt where COUNTERPARTY=?
SELECT_BG=select G.COUNTERPARTY, G.CONTRACT_REF_NO, G.CONTRACT_CCY, G.OS_LIABILITY,G.BOOK_DATE from glbl_temp_bg G where COUNTERPARTY=?
SELECT_LC=select COUNTERPARTY, CONTRACT_REF_NO, CONTRACT_CCY, OS_LIABILITY,BOOK_DATE from glbl_temp_lc where COUNTERPARTY=?
SELECT_LOAN_SCHEDULE=SELECT L.CONTRACT_REF_NO,L.COMPONENT,L.DUE_DATE,L.CURRENCY_AMT_DUE,L.AMOUNT_SETTLED,L.BALANCE_OUTSTANDING FROM VW_LOAN_SCHEDULE L WHERE DUE_DATE >=? AND DUE_DATE<=? AND L.CONTRACT_REF_NO=?
SELECT_ACCT_NO=SELECT COD_ACCT_NO FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST=? 
SELECT_COD_CUST=SELECT COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO=cast(? as char(48)) AND COD_ACCT_CUST_REL='SOW'
SELECT_LIMIT_UTILIZATION=SELECT REF_NO,CCY,AMT FROM VW_LIMIT_UTIL WHERE TRIM(LINE_ID)=TRIM(?) AND CUST_ID=? 
#SELECT_LIMIT_DETAILS=SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY FROM VW_LIMITS WHERE CUSTOMER_NO = ? ORDER BY ord
#SELECT_LIMIT_DETAILS=SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY FROM VW_LIMITS WHERE CUSTOMER_NO = ? and LINE_EXPIRY_DATE BETWEEN SYSDATE-30 AND SYSDATE+30  ORDER BY ord
#SELECT_LIMIT_DETAILS=SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE  DESCRIPTION='PARENT LINE' AND CUSTOMER_NO = ? UNION SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE  LINE_EXPIRY_DATE BETWEEN SYSDATE-30 AND SYSDATE+30  AND CUSTOMER_NO = ?  ORDER BY ord
SELECT_LIMIT_DETAILS1=SELECT LL.ORD,LL.LIAB_ID,LL.CUSTOMER_NO,LL.LINE_ID,LL.DESCRIPTION,LL.MAIN_LINE,LL.LIMIT_AMOUNT,LL.UTILISATION,LL.AVAILABLE_AMOUNT,LL.REVOLVING_LINE,LL.LINE_START_DATE,LL.LINE_EXPIRY_DATE,LL.AVAILABILITY_FLAG,LL.LIMIT_CCY,NVL(LL.MAIN_LINE,LL.DESCRIPTION) FROM VW_LIMITS LL WHERE  LL.LINE_ID=?  AND LL.CUSTOMER_NO = ? ORDER BY LL.ord
SELECT_LIMIT_DETAILS=SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION)FROM VW_LIMITS WHERE  DESCRIPTION='PARENT LINE' AND CUSTOMER_NO = ? and LINE_EXPIRY_DATE BETWEEN SYSDATE-30 AND SYSDATE+30 UNION SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE CUSTOMER_NO = ? AND  LINE_EXPIRY_DATE BETWEEN SYSDATE-30 AND SYSDATE+30  union SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS  where (liab_id,line_id) in(SELECT liab_id,MAIN_LINE FROM VW_LIMITS WHERE CUSTOMER_NO = ? and LINE_EXPIRY_DATE BETWEEN SYSDATE-30 AND SYSDATE+30)ORDER BY ord
SELECT_LIMIT_WITHOUT_EXPIRY_DETAILS=SELECT ORD,LIAB_ID,CUSTOMER_NO,TRIM(LINE_ID) AS LINE_ID, TRIM(DESCRIPTION) AS DESCRIPTION,TRIM(MAIN_LINE) MAIN_LINE ,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE CUSTOMER_NO  = ? ORDER BY ord
 
 
 

###############################Default Limit Setup CR Start##########################################

CHECK_CUSTOMER_SOLE_PROPRIETOR_LOCAL=SELECT COUNT(*) FROM CI_CUSTMAST WHERE COD_CUST_ID = ? AND FLG_CUST_TYP='S'
CHECK_CUSTOMER_SOLE_PROPRIETOR_UAT=SELECT COUNT(*) FROM fcrlive_1.ci_custmast@CBS_UAT  WHERE COD_CUST_ID = ? AND FLG_CUST_TYP='S'
CHECK_CUSTOMER_SOLE_PROPRIETOR_LIVE=SELECT COUNT(*) FROM fcrlive_1.ci_custmast@CBS_RD_LINK  WHERE COD_CUST_ID = ? AND FLG_CUST_TYP='S'

SELECT_ACCOUNT_OF_SOLE_PROP_CUSTOMER=SELECT COD_ACCT_NO FROM  VW_CH_ACCT_CUST_XREF where COD_CUST=?
SELECT_GROUPID_FROM_GROUPNAME=SELECT GROUP_ID FROM COM_SERVICEGROUP WHERE GROUP_NAME = ?
SELECT_SERVICECD_FROM_COM_SERVICE_MST=SELECT SERVICE_CD FROM com_service_mst WHERE SERVICE_TYPE = (SELECT GROUP_ID FROM COM_SERVICEGROUP WHERE GROUP_NAME = 'Financial Transactions - Onscreen')
CHECK_CUSTOMER_LIMIT_SETUP_OR_NOT=SELECT COUNT(*) FROM COM_APPROVAL_GRP_MST WHERE SERVICECDID = ? 

INSERT_SOLE_PROPCUSTOMER_LIMITDATA_IN_COM_APPROVAL_GRP_MST=INSERT INTO COM_APPROVAL_GRP_MST (SERVICECDID, ACCOUNT_NO, SERVICE_CD,ID, AUTH_STATUS, MAKER_CD, MAKER_DT, MAKER_CAL_DT, AUTHOR_CD,AUTHOR_DT, AUTHOR_CAL_DT,ACTIVE_FLAG, LAST_CHANGE_ID, APPROVER_LIST, OPERATION_MODE, TOTAL_SCORE, BANK_ID, DAILY_LIMIT, DATA_SOURCE) VALUES (?, ?, ?, (select max(ID) from COM_APPROVALMAPPING_MST) + 1,?, NULL, sysdate, sysdate, NULL, sysdate, sysdate, ?, ?, ?, ?, ?,?, ?,NULL)
INSERT_SOLE_PROPCUSTOMER_LIMITDATA_IN_COM_APPROVALMAPPING_MST=INSERT INTO COM_APPROVALMAPPING_MST (SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DATA_SOURCE) VALUES (?,?,?,(select max(ID) from COM_APPROVALMAPPING_MST) + 1,?,NULL,SYSDATE,SYSDATE,NULL,SYSDATE,SYSDATE,?,?,?,?,?,?,NULL)
INSERT_CUSTOMER_LIMIT_CONCERN_DATA=INSERT INTO SME_CUSTOMER_CONCERN_DATA (ID, CUST_ID, CUST_ID_DATE_TIME, CONCERN_FLAG) VALUES ((SELECT COALESCE(MAX(ID), 0) + 1 FROM SME_CUSTOMER_CONCERN_DATA), ?, SYSDATE, 'Y')
########################################## End #########################################################
 
 
 
 
#######################
#  For EEFC
SELECT_EEFC_ACC_DTL=SELECT COD_ACCT_NO,NAM_CCY_SHORT,BAL_AVAILABLE,LCY_BAL FROM VW_EEFC WHERE COD_CUST = ?

#For Offers ---- Notification ----- Inbox
#SELECT_INBOX=  SELECT NOTIFICATION_ID, NOTIFICATION_TAG_NAME, NOTIFICATION_DESCRIPTION, TO_CHAR(CREATED_ON, 'DD-MON-YYYY HH24:MI:SS')  from NOTIFICATION where CUSTOMER_ID=?
SELECT_INBOX=SELECT NOTIFICATION_ID, NOTIFICATION_TAG_NAME, NOTIFICATION_DESCRIPTION, TO_CHAR(CREATED_ON, 'DD-MON-YYYY HH24:MI:SS')  from NOTIFICATION where (CUSTOMER_ID IS NULL OR CUSTOMER_ID = '') or CUSTOMER_ID=?
#SELECT_NOTIFICATION=  SELECT NOTIFICATION_ID, NOTIFICATION_TAG_NAME, NOTIFICATION_DESCRIPTION, TO_CHAR(CREATED_ON, 'DD-MON-YYYY HH24:MI:SS')  from NOTIFICATION where CUSTOMER_ID=? and SEND_STATUS = 'N'
SELECT_NOTIFICATION=SELECT NOTIFICATION_ID, NOTIFICATION_TAG_NAME, NOTIFICATION_DESCRIPTION, TO_CHAR(CREATED_ON, 'DD-MON-YYYY HH24:MI:SS'),MODULE_NAME  from NOTIFICATION where ((CUSTOMER_ID IS NULL OR CUSTOMER_ID = '') and SEND_STATUS = 'N' ) or (CUSTOMER_ID=? and SEND_STATUS = 'N') AND CREATED_ON >= sysdate -7 order by CREATED_ON desc
INSERT_NOTIFICATION=Insert into NOTIFICATION (NOTIFICATION_ID,NOTIFICATION_TAG_NAME,NOTIFICATION_DESCRIPTION,CUSTOMER_ID,CREATED_ON,SEND_STATUS) values (NOTIFICATION_SEQ.NEXTVAL,?,?,?,SYSDATE,'N')
SELECT_OFFER=SELECT OFFER_ID, OFFER_TAG_NAME, OFFER_DESCRIPTION, CUSTOMER_ID, TO_CHAR(CREATED_ON, 'DD-MON-YYYY'), TO_CHAR(VALID_TO, 'DD-MON-YYYY'),READ_FLAG,MODULE_NAME from OFFER where CUSTOMER_ID IN (?,'NA') AND CREATED_ON >= sysdate -7 ORDER BY CREATED_ON desc
SELECT_OFFER_COUNT=SELECT COUNT(*) from OFFER where CUSTOMER_ID IN (?,'NA') AND CREATED_ON >= sysdate -7 ORDER BY CREATED_ON desc

#For Payment due and Overdue
SELECT_PAYMENT_DUE= SELECT CUST_ID,CONTRACT_REF_NO,DUE_IN_DAYS,TO_CHAR(DUE_DATE, 'DD-MON-YYYY'),COMPONENT,CURRENCY,AMOUNT_DUE FROM CUSTOMER_PAYMENTS_DUE where CUST_ID=?
SELECT_OVERDUE= SELECT CUST_ID,CONTRACT_REF_NO,CURRENCY,COMPONENT,TO_CHAR(DUE_DATE, 'DD-MON-YYYY'),DAYS_DPD,AMOUNT_DUE FROM CUSTOMER_OVERDUE_DETAIL where CUST_ID=?


#For Margin Shortfall
SELECT_MARGIN_SHORTFALL = SELECT FACILITY_ID, CONTRACT_REF_NO, CONTRACT_OS_INR, ADDITIONAL_MARGIN_REQUIRED FROM MARGIN_SHORTFALL WHERE CLIENT_ID=?


#Bulk And Salary Trabsaction 

SELECT_SAL_BENE_LIST=select BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_IFSC,BENE_MOBILE_NO,BENE_DESC,BENE_ADDED_AMT,BANK_NAME,BENE_ACCOUNT_NAME,CUSTOMER_ID from SME_BENEFICIARY_DTL where CUSTOMER_ID = ? and BENE_ADD_FLAG = 'Y' and BENE_TYPE = ? and BENE_MODE in ('A','U')
SELECT_SAL_BENE_LIST1=select BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_IFSC,BENE_MOBILE_NO,BENE_DESC,BENE_ADDED_AMT,BANK_NAME,BENE_ACCOUNT_NAME,CUSTOMER_ID from SME_BENEFICIARY_DTL where CUSTOMER_ID IN (SELECT DISTINCT(APPROVER_CD) FROM COM_APPROVE_MST WHERE CUSTOMER_ID=?) and BENE_ADD_FLAG = 'Y' and BENE_TYPE = ? and BENE_MODE in ('A','U')

INSERT_BULK_DTL=Insert into SME_BULK_TRANSACTION_DTL (CUSTOMER_ID,GROUP_ID,ADDED_BENE_DTL,TOTAL_PAY_AMT,BULK_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TRANSACTION_STATUS,EXCLUDED_BENE_DTL,INITIATED_DATE_TIME,TRANSACTION_DATE_TIME,TRAN_REF_NO,GRP_TRANS_TYPE,FILE_BENE_DTL) values (?,?,?,?,?,?,?,?,?,sysdate,sysdate,?,?,?)
INSERT_BULK_FILE_DTL_MAKER=Insert into SME_BULK_TRANSACTION_DTL (CUSTOMER_ID,GROUP_ID,ADDED_BENE_DTL,TOTAL_PAY_AMT,BULK_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TRANSACTION_STATUS,EXCLUDED_BENE_DTL,INITIATED_DATE_TIME,TRANSACTION_DATE_TIME,TRAN_REF_NO,GRP_TRANS_TYPE,MAKER_ID,MAKER_STATUS,MAKER_INITIATED_DT,FILE_BENE_DTL) values (?,?,?,?,?,?,?,?,?,sysdate,sysdate,?,?,?,?,sysdate,?)



INSERT_BULK_FILE_UPLOAD=Insert into SME_BULK_FILE_UPLOAD_DTL (CUSTOMER_ID,NO_OF_RECIPIENTS,TOTAL_AMT,BULK_TRANSFER_TYPE,SOURCE_ACC,REMARKS,BULK_FILE_NAME,UPLOAD_DATE_TIME,TRANSCTION_STATUS,MODIFY_STATUS_DATE_TIME,TRANSC_REF_NO,SOURCE_FILE_NAME) values (?,?,?,?,?,?,?,?,'I-10','',BULK_FILE_UPLOAD_REF_NO_SEQ.NEXTVAL,?)
ADD_EMP_BENE=Insert into SME_EMPLOYEE_BENE (EMPLOYEE_ID,EMPLOYEE_NAME,TRANSFER_TYPE,BANK_IFSC,EMP_ACC_NO,EMP_SALARY,EMP_CONTACT_NO,EMP_EMAIL_ID,EMP_BENE_MK_DT,EMP_BENE_FLAG,ADD_BENE_FLAG,CUSTOMER_ID,ACCOUNTNAME,BANK_NAME) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?)
UPDATE_EMP_BENE=UPDATE SME_EMPLOYEE_BENE SET ADD_BENE_FLAG = 'Y' WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
SELECT_EMP_BENE_DTL=SELECT EMPLOYEE_ID,EMPLOYEE_NAME,TRANSFER_TYPE,BANK_IFSC,EMP_ACC_NO,EMP_SALARY,EMP_CONTACT_NO,EMP_EMAIL_ID,ACCOUNTNAME,BANK_NAME FROM SME_EMPLOYEE_BENE WHERE CUSTOMER_ID = ? AND EMP_BENE_FLAG = 'Y' AND ADD_BENE_FLAG = 'Y'
DELETE_EMP_BENE=UPDATE SME_EMPLOYEE_BENE SET EMP_BENE_FLAG = 'N',ADD_BENE_FLAG='N' WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
SELECT_SAL_TXN_REF=SELECT SALARY_TRANS_REFNO_SEQ.NEXTVAL FROM DUAL
INSERT_SALRY_INFO=Insert into SME_SALARY_TRANSACTION_DTL (CUSTOMER_ID,BENE_DTL,TOTAL_EMP,SALARY_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TRANSACTION_STATUS,INITIATED_DATE_TIME,TRANSACTION_DATE_TIME,TRAN_REF_NO,SALARY_GRP_NAME,TOTAL_AMT,TXN_TRANSFER_TYPE,FILE_BENE_DTL) values (?,?,?,?,?,?,?,sysdate,?,?,?,?,?,?)
INSERT_SALRY_INFO_MAKER=Insert into SME_SALARY_TRANSACTION_DTL (CUSTOMER_ID,BENE_DTL,TOTAL_EMP,SALARY_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TRANSACTION_STATUS,INITIATED_DATE_TIME,TRANSACTION_DATE_TIME,TRAN_REF_NO,SALARY_GRP_NAME,TOTAL_AMT,TXN_TRANSFER_TYPE,MAKERID,MAKER_STATUS,MAKER_DT,FILE_BENE_DTL) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate,?)
UPDATE_TXN_REF_sal=UPDATE SME_SALARY_TRANSACTION_DTL SET AUTH_REF_NO = ?,TRANSACTION_STATUS = ?,CUSTOMER_ID=?,TRANSACTION_DATE_TIME = sysdate WHERE TRAN_REF_NO = ?
UPDATE_TXN_REF_sal3=UPDATE SME_SALARY_TRANSACTION_DTL SET CUSTOMER_ID=? WHERE AUTH_REF_NO = ?
UPDATE_TXN_REF_SALARY=UPDATE SME_SALARY_TRANSACTION_DTL SET BENE_DTL=? WHERE AUTH_REF_NO = ?
UPDATE_TXN_REF_BULK_FILE=UPDATE SME_BULK_TRANSACTION_DTL SET ADDED_BENE_DTL=? WHERE AUTH_REF_NO = ?
SELECT_FILE_NAME_SALARY=SELECT BENE_DTL FROM SME_SALARY_TRANSACTION_DTL WHERE AUTH_REF_NO = ?
SELECT_FILE_NAME_BULK=SELECT ADDED_BENE_DTL FROM SME_BULK_TRANSACTION_DTL WHERE AUTH_REF_NO = ?

#SELECT_TOTAL_SALARY=select SUM(EMP_SALARY) from SME_EMPLOYEE_BENE where CUSTOMER_ID = ? and EMP_BENE_FLAG = 'Y' and ADD_BENE_FLAG = 'Y'
SELECT_TOTAL_SALARY=select TOTAL_AMT,TRAN_REF_NO,TOTAL_EMP,TRANSACTION_DATE_TIME from SME_SALARY_TRANSACTION_DTL where TRAN_REF_NO = (select MAX(TRAN_REF_NO) from SME_SALARY_TRANSACTION_DTL where CUSTOMER_ID = ? and TRANSACTION_STATUS in ('A-40','E-50'))
SELECT_LAST_TRANS_DTL=select TOTAL_AMT,TOTAL_EMP,INITIATED_DATE_TIME,TRAN_REF_NO from SME_SALARY_TRANSACTION_DTL where CUSTOMER_ID = ? and TRAN_REF_NO = (select MAX(TRAN_REF_NO) from SME_SALARY_TRANSACTION_DTL where CUSTOMER_ID = ? and TRANSACTION_STATUS = 'I-10')
MODIFY_EMP_BENE1=UPDATE SME_EMPLOYEE_BENE SET TRANSFER_TYPE = ?,EMP_ACC_NO = ?,EMP_SALARY = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
MODIFY_EMP_BENE2=UPDATE SME_EMPLOYEE_BENE SET TRANSFER_TYPE = ?,EMP_SALARY = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
MODIFY_EMP_BENE3=UPDATE SME_EMPLOYEE_BENE SET EMP_ACC_NO = ?,EMP_SALARY = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
MODIFY_EMP_BENE4=UPDATE SME_EMPLOYEE_BENE SET TRANSFER_TYPE = ?,EMP_ACC_NO = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
MODIFY_EMP_BENE5=UPDATE SME_EMPLOYEE_BENE SET EMP_ACC_NO = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
MODIFY_EMP_BENE6=UPDATE SME_EMPLOYEE_BENE SET EMP_SALARY = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
MODIFY_EMP_BENE7=UPDATE SME_EMPLOYEE_BENE SET TRANSFER_TYPE = ? WHERE EMPLOYEE_ID = ? AND CUSTOMER_ID = ?
SELECT_SINGLE_EMP_DTL=SELECT EMPLOYEE_NAME,TRANSFER_TYPE,BANK_IFSC,EMP_ACC_NO,EMP_SALARY,EMP_CONTACT_NO,EMP_EMAIL_ID,ACCOUNTNAME,BANK_NAME FROM SME_EMPLOYEE_BENE WHERE CUSTOMER_ID = ? AND EMPLOYEE_ID = ?

INSERT_BULK_DTL_MAKER=Insert into SME_BULK_TRANSACTION_DTL (CUSTOMER_ID,GROUP_ID,ADDED_BENE_DTL,TOTAL_PAY_AMT,BULK_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TRANSACTION_STATUS,EXCLUDED_BENE_DTL,INITIATED_DATE_TIME,TRANSACTION_DATE_TIME,TRAN_REF_NO,MAKER_ID,MAKER_STATUS,MAKER_INITIATED_DT,GRP_TRANS_TYPE,REF_NO,FILE_BENE_DTL) values (?,?,?,?,?,?,?,?,?,sysdate,sysdate,BULK_TRANS_REF_NO_SEQ.NEXTVAL,?,'I',sysdate,?,?,?)
SELECT_MAKER_TXN_DTL_REF_NO=SELECT MAKER_TXN_REF_SEQ.NEXTVAL FROM DUAL


SELECT_SAL_DTL_FOR_TXN=SELECT CUSTOMER_ID,BENE_DTL,TOTAL_EMP,SALARY_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TRAN_REF_NO,TOTAL_AMT,TXN_TRANSFER_TYPE,FILE_BENE_DTL FROM SME_SALARY_TRANSACTION_DTL WHERE AUTH_REF_NO = ?
##Added 2440 for salary upload issue 06-12-22
INSERT_SAL_TXN_REF_DTL=INSERT INTO SME_SALARY_API_TXN_REF_DTL (SALARY_TXN_NO,EMPLOYEE_ID,REFERENCE_NO,ERROR_DTL,TXN_DT,TXN_SR_NO) VALUES (?,?,?,?,sysdate,?)
#############################
UPDATE_TXN_REF_sal1=UPDATE SME_SALARY_TRANSACTION_DTL SET TRANSACTION_STATUS = ?,TRANSACTION_DATE_TIME=? WHERE TRAN_REF_NO = ?
SELECT_CNT_SME_SALARY_API_TXN_REF_DTL=SELECT COUNT(*) FROM SME_SALARY_API_TXN_REF_DTL WHERE SALARY_TXN_NO = ? AND REFERENCE_NO <> '000'
SELECT_SME_SALARY_API_TXN_REF_DTL=SELECT EMPLOYEE_ID,TXN_DT,SALARY_TXN_NO,ERROR_DTL FROM SME_SALARY_API_TXN_REF_DTL WHERE SALARY_TXN_NO = ? AND REFERENCE_NO = '000'

#For Bulk DTl in authorization 
SELECT_BULK_TXN_REF=SELECT BULK_TRANS_REF_NO_SEQ.NEXTVAL FROM DUAL
SELECT_BULK_DTL_FOR_TXN=SELECT CUSTOMER_ID,GROUP_ID,ADDED_BENE_DTL,BULK_TRANSFER_TYPE,TOTAL_PAY_AMT,SOURCE_ACCOUNT_NO,REMARKS,TRAN_REF_NO,GRP_TRANS_TYPE FROM SME_BULK_TRANSACTION_DTL WHERE AUTH_REF_NO = ?
##Added 2418 for Bulk upload issue 25-11-22
INSERT_BULK_TXN_REF_DTL=INSERT INTO SME_BULK_API_TXN_REF_DTL (BULK_TXN_NO,BENE_ID,REFERENCE_NO,ERROR_DTL,TXN_DT, TXN_SR_NO) VALUES(?,?,?,?,sysdate,?)
#############################
UPDATE_TXN_REF_BULK1=UPDATE SME_BULK_TRANSACTION_DTL SET TRANSACTION_STATUS = ?,TRANSACTION_DATE_TIME = ? WHERE TRAN_REF_NO = ?
UPDATE_TXN_REF_BULK3=UPDATE SME_BULK_TRANSACTION_DTL SET CUSTOMER_ID = ? WHERE AUTH_REF_NO = ?
SELECT_CNT_SME_BULK_API_TXN_REF_DTL=SELECT COUNT(*) FROM SME_BULK_API_TXN_REF_DTL WHERE BULK_TXN_NO = ? AND REFERENCE_NO <> '000'
UPDATE_TXN_REF_BULK=UPDATE SME_BULK_TRANSACTION_DTL SET AUTH_REF_NO = ?,TRANSACTION_STATUS = ?,CUSTOMER_ID=?,TRANSACTION_DATE_TIME = sysdate WHERE TRAN_REF_NO = ?
SELECT_SME_BULK_API_TXN_REF_DTL=SELECT BENE_ID,TXN_DT,BULK_TXN_NO,ERROR_DTL FROM SME_BULK_API_TXN_REF_DTL WHERE BULK_TXN_NO = ? AND REFERENCE_NO = '000'


UPDATE_TXN_REF_SINGLE_TXN=UPDATE SME_BULK_TRANSACTION_DTL SET APPROVER_ID = ? WHERE AUTH_REF_NO = ?
UPDATE_TXN_REF_BULK2=UPDATE SME_SINGLE_TXN_MAKER_DTL SET CUSTOMER_ID = ? WHERE AUTH_REF_NO = ?

INSERT_TXN_DTL=Insert into SME_SINGLE_TXN_REF_DTL (REQ_TXN_NO,FROM_ACCOUNT_NO,TO_ACCOUNT_NO,BENE_ID,REFERENCE_NO,ERROR_DTL,TXN_DT) values (?,?,?,?,?,?,sysdate)


### Pending authorization

#For Fetch customer id of approver
SELECT_CUSTOMERID_FROM_APPROVAL=SELECT distinct CUSTOMER_ID FROM COM_APPROVE_MST WHERE APPROVER_CD = ?
#For Approval Check
SELECT_APPROVER_NAME=SELECT APPROVER_LIST, OPERATION_MODE, TOTAL_SCORE FROM COM_APPROVALMAPPING_MST WHERE SERVICECDID=? AND ACCOUNT_NO=? AND SERVICE_CD=? AND ACTIVE_FLAG = 'Y'
#Get Transaction for Auth
SELECT_PENDING_TXN= SELECT DISTINCT(A.TRAN_REF_NO), A.BAL_APPROVER_SCORE, C.APPROVER_ID FROM SME_TRANSACTION_DTL A, COM_APPROVALMAPPING_MST B, COM_APPROVE_MST C where A.CUSTOMER_ID=B.SERVICECDID AND A.SOURCE_ACC_NO=B.ACCOUNT_NO AND A.CUSTOMER_ID=C.CUSTOMER_ID AND C.APPROVER_CD = ? AND B.APPROVER_LIST LIKE ? AND (A.AUTH_STATUS = ? OR A.AUTH_STATUS = ?) order by A.TRAN_REF_NO desc
#Update Transaction DTL
UPDATE_TRANSACTION_DTL = UPDATE SME_TRANSACTION_DTL SET BAL_APPROVER_SCORE = ? WHERE TRAN_REF_NO = ?
#Insert_Activity_Log
INSERT_ACTIVTY_LOG=INSERT INTO SME_TXN_APPROVAL_ACTIVITY_LOG (TRAN_REF_NO, CUSTOMER_ID, AUTH_CD, AUTH_DT, AUTH_ACTION, ID,IP_ADD_INFO) VALUES (?,?,?,SYSDATE,?,SME_ACTIVITY_LOG_SEQ.NEXTVAL,?)
#INSERT_INTO_TXN_TABLE
SELECT_TRNS_REF_NO=SELECT SME_TRANSACTION_DTL_SEQ.NEXTVAL FROM DUAL
INSERT_TXN_TABLE=INSERT INTO SME_TRANSACTION_DTL(TRAN_DATE, CUSTOMER_ID, SOURCE_ACC_NO, DEST_ACC_NO, TRAN_AMOUNT, REMARKS, AUTH_STATUS, MAKER_CD, MAKER_DT, OPERATION_MODE, REQ_APPROVER_SCORE, BAL_APPROVER_SCORE,BENE_NAME, BENE_NICKNAME, BENE_IFSC_CD, SERVICE_CD,BANK_NAME,TRAN_TYPE,TRAN_REF_NO,MOBILE_NO,ACTUAL_REMARKS) VALUES(SYSDATE, ?, ?, ?, ?, ?, ?, ?, TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?)
INSERT_TXN_TABLE_CUST=INSERT INTO SME_TRANSACTION_DTL(TRAN_DATE, CUSTOMER_ID, SOURCE_ACC_NO, DEST_ACC_NO, TRAN_AMOUNT, REMARKS, AUTH_STATUS, MAKER_CD, MAKER_DT, OPERATION_MODE, REQ_APPROVER_SCORE, BAL_APPROVER_SCORE,BENE_NAME, BENE_NICKNAME, BENE_IFSC_CD, SERVICE_CD,BANK_NAME,TRAN_TYPE,TRAN_REF_NO,MOBILE_NO,ACTUAL_REMARKS) VALUES(SYSDATE, ?, ?, ?, ?, ?, ?, ?, SYSDATE, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?)
#SELECT_APPROVER_DTL
SELECT_APPROVER_DTL=SELECT APPROVER_ID FROM COM_APPROVE_MST WHERE APPROVER_CD=? AND CUSTOMER_ID=?
#SELECT_TRANSACTION_DTL
SELECT_TRANSACTION_DTL=SELECT BAL_APPROVER_SCORE,OPERATION_MODE FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO=?
#Update_Txn_Status
Update_Txn_Status=UPDATE SME_TRANSACTION_DTL SET AUTH_STATUS=? WHERE TRAN_REF_NO=?
#Select Transaction Details
SELECT_TRANSACTIONS_DTL=SELECT TRAN_AMOUNT,TRAN_TYPE,TO_CHAR(TRAN_DATE, 'DD-MON-YYYY HH24:MI:SS'),BENE_NAME,DEST_ACC_NO,BENE_IFSC_CD,NVL(BANK_NAME,'NA'),CUSTOMER_ID,BENE_NICKNAME,SOURCE_ACC_NO,SERVICE_CD,NVL(MOBILE_NO,'NA'),NVL(ACTUAL_REMARKS,'NA'),MAKER_CD FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO=?
#SELECT_SOL_OWNER_DETAILS
SELECT_SOL_OWNER_DETAILS=SELECT COD_ACCT_NO FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST=? AND COD_ACCT_CUST_REL='SOW' AND COD_ACCT_NO=cast(? as char(48))




#*********************************************************
# Here SQL For Maker Related Addition in DB like 
#          BENEFICIARY ADD/UPDATE/DELETE
#
#*********************************************************
#For Beneficiary
INSERT_BENE_DTL=Insert into SME_BENEFICIARY_DTL (BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_MOBILE_NO,BENE_IFSC,BENE_DESC,MAKER_ID,CUSTOMER_ID,BENE_ADD_DT,BENE_ADD_FLAG,BENE_STATUS,BENE_MODE,REFERENCE_NO,BENE_TYPE,GROUP_NAME,BENE_ADDED_AMT,BANK_NAME,BENE_ACCOUNT_NAME,BENE_DELETED_TRANSFER_TYPE,RES_REFERENCE_NO,AUTHOR_TIME,BENE_PUSH_FLAG) values (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?,?,systimestamp,?)
BENE_REFERENCE_NO=SELECT SME_BENEFICIARY_REF_SEQ.NEXTVAL FROM DUAL
INSERT_BENE_DTL_TMP=Insert into SME_BENEFICIARY_DTL_TMP (BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_MOBILE_NO,BENE_IFSC,BENE_DESC,MAKER_ID,CUSTOMER_ID,BENE_ADD_DT,BENE_ADD_FLAG,BENE_STATUS,BENE_MODE,REFERENCE_NO,BENE_TYPE,GROUP_NAME,BENE_ADDED_AMT,BANK_NAME,BENE_ACCOUNT_NAME,BENE_DELETED_TRANSFER_TYPE) values (?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?,?,?,?,?)
SELECT_BENE_EXITS=select REFERENCE_NO,BENE_TRANSFER_TYPE,BENE_DELETED_TRANSFER_TYPE from SME_BENEFICIARY_DTL where upper(BENE_ID) = ? and CUSTOMER_ID = ?
SELECT_BENE_EXITS_TMP=select REFERENCE_NO,BENE_TRANSFER_TYPE,BENE_DELETED_TRANSFER_TYPE from SME_BENEFICIARY_DTL_TMP where upper(BENE_ID) = ? and CUSTOMER_ID = ? and BENE_STATUS = ?
#COUNT_BENE_EXITS_TMP=select COUNT(*) from SME_BENEFICIARY_DTL_TMP where upper(BENE_ID) = ? and CUSTOMER_ID = ? and BENE_STATUS = ? and BENE_TYPE= ?
COUNT_BENE_EXITS_TMP=select COUNT(*) from SME_BENEFICIARY_DTL_TMP where upper(BENE_ID) = ? and CUSTOMER_ID = ? and BENE_STATUS = ? 
#COUNT_EMP_BENE_EXITS_TMP=select COUNT(*) from SME_BENEFICIARY_DTL_TMP where upper(BENE_ID) = ? and CUSTOMER_ID = ? and BENE_STATUS = ? and BENE_TYPE='SAL'


UPDATE_BENE_DTL=update SME_BENEFICIARY_DTL set BENE_NAME = ?,BENE_TRANSFER_TYPE = ?,BENE_ACCOUNT_NO = ?,BENE_EMAIL_ID = ?,BENE_MOBILE_NO = ?,BENE_IFSC = ?,BENE_DESC = ?,MAKER_ID = ?,BENE_ADD_DT = SYSDATE,BENE_ADD_FLAG = ?,BENE_STATUS = ?,BENE_MODE = ?,CUSTOMER_ID = ?,BENE_ADDED_AMT = ?,BANK_NAME = ?,BENE_ACCOUNT_NAME = ? where REFERENCE_NO = ?
UPDATE_BENE_DTL_TMP=update SME_BENEFICIARY_DTL_TMP set BENE_NAME = ?,BENE_TRANSFER_TYPE = ?,BENE_ACCOUNT_NO = ?,BENE_EMAIL_ID = ?,BENE_MOBILE_NO = ?,BENE_IFSC = ?,BENE_DESC = ?,MAKER_ID = ?,BENE_ADD_DT = SYSDATE,BENE_ADD_FLAG = ?,BENE_STATUS = ?,BENE_MODE = ?,CUSTOMER_ID = ?,BENE_ADDED_AMT = ?,BANK_NAME = ?,BENE_ACCOUNT_NAME = ?,BENE_DELETED_TRANSFER_TYPE = ?,BENE_TYPE=? where REFERENCE_NO = ?
UPDATE_BENE_DTL_AUTH=update SME_BENEFICIARY_DTL set BENE_NAME = ?,BENE_TRANSFER_TYPE = ?,BENE_ACCOUNT_NO = ?,BENE_EMAIL_ID = ?,BENE_MOBILE_NO = ?,BENE_IFSC = ?,BENE_DESC = ?,BENE_ADD_DT = SYSDATE,BENE_ADD_FLAG = ?,BENE_STATUS = ?,BENE_MODE = ?,CUSTOMER_ID = ?,BENE_ADDED_AMT = ?,BANK_NAME = ?,BENE_ACCOUNT_NAME = ?,BENE_DELETED_TRANSFER_TYPE = ?,BENE_TYPE=?,RES_REFERENCE_NO=?,AUTHOR_TIME = systimestamp,BENE_PUSH_FLAG=? where REFERENCE_NO = ?
UPDATE_BENE_REF_NO_IN_AUTH=UPDATE SME_BENEFICIARY_DTL set REFERENCE_NO = ? where REFERENCE_NO = ?
UPDATE_BENE_DTL_FOR_DEL=update SME_BENEFICIARY_DTL_TMP set BENE_TRANSFER_TYPE = ?,MAKER_ID = ?,BENE_ADD_DT = SYSDATE,BENE_ADD_FLAG = ?,BENE_STATUS = ?,BENE_MODE = ?,CUSTOMER_ID = ?,BENE_DELETED_TRANSFER_TYPE = ? where REFERENCE_NO = ?
UPDATE_BENE_DTL_FOR_DEL_AUTH=update SME_BENEFICIARY_DTL set BENE_TRANSFER_TYPE = ?,BENE_ADD_DT = SYSDATE,BENE_ADD_FLAG = ?,BENE_STATUS = ?,BENE_MODE = ?,CUSTOMER_ID = ?,BENE_DELETED_TRANSFER_TYPE = ?,RES_REFERENCE_NO=? where REFERENCE_NO = ?
#FOR PAYTOALLSINFLE Transfer VIA MAKER
#INSERT_PAYTO_BENE_DTL=Insert into SME_PAYTOBENE_DTL (CUSTOMER_ID,MAKER_ID,SOURCE_ACCOUNRT_NO,BENE_ID,TRANSFER_TYPE,TRANSFER_AMT,BENE_INFO,TRANSFER_ADD_FLAG,TRANSFER_ADD_STATUS,TRANSFER_ADD_DT,REFERENCE_NO) values (?,?,?,?,?,?,?,'N','I',SYSDATE,SME_PAYTOBENE_REF_SEQ.NEXTVAL)
INSERT_TXN_DTL_VIA_MAKER=Insert into SME_SINGLE_TXN_MAKER_DTL (REF_NO,SERVICECD,BENEID,BENE_IFSC,BENE_NAME,MOBILE_NO,EMAIL,AMOUNT,FROM_ACC,TO_ACC,REMARKS,MAKE_DT,MAKER_ID,APPROVER_ID,COMPANY_ID,TRANSFER_TYPE) values (?,?,?,?,?,?,?,?,?,?,?,sysdate,?,?,?,?)
INSERT_TXN_DTL_REF_NO=SELECT SME_SINGLE_TXN_MAKER_DTL_SEQ.NEXTVAL FROM DUAL
INSERT_APPROVAL_GROUP_IN_MAIN_TABLE=Insert into SME_GROUP_BENE_DTL (CUSTOMER_ID,GROUP_ID,BENE_ID,BENE_DTL,GROUP_MK_DATE,BENE_ADD_DATE,BENE_MOD_DATE,GROUP_MOD_DATE,MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT,REF_NO) select CUSTOMER_ID,GROUP_ID,BENE_ID,BENE_DTL,GROUP_MK_DATE,BENE_ADD_DATE,BENE_MOD_DATE,GROUP_MOD_DATE,MAKER_ID,BENE_ADD_STATUS_M,BENE_MAKER_DT,REF_NO from SME_GROUP_BENE_DTL_TMP where REF_NO=?
UPDATE_GROUP_CUSTID= update SME_GROUP_BENE_DTL set CUSTOMER_ID = ? where REF_NO = ?

#FOR FD ACC
COUNT_FOR_CREATE_FD_FROM_MAKER=SELECT COUNT(*) FROM SME_CREATE_FD_DTL WHERE CUSTOMER_ID = ? AND SOURCE_ACC_NO = ? AND JOINT_HOLDER_FALG = ? AND PRODUCT_CD =? AND MONTHS = ? AND DAYS = ? AND SWEEP_IN_FLAG = ? AND BRANCH_CD = ? AND INTEREST_PAYOUT_FREQ = ? AND INTEREST_COMPOUNDING_FREQ = ? AND TRANSACTIONAL_BRANCH = ? AND INSTRUCTION_ACCOUNT_NO = ? AND FD_ADD_STATUS = ?
SELECT_FDACC_SEQ=SELECT SME_FDACC_REF_SEQ.NEXTVAL FROM DUAL
#INSERT_FDACC_DTL=Insert into SME_CREATE_FD_DTL (CUSTOMER_ID,MAKER_ID,SOURCE_ACC_NO,DEPOSIT_AMT,JOINT_HOLDER_FALG,PRODUCT_CD,MONTHS,DAYS,SWEEP_IN_FLAG,BRANCH_CD,FLAG_SC_WAIVE,FLAG_RESTRICT_ACC,PAY_IN_MODE,PAY_IN_NARRATION,INTEREST_PAYOUT_FREQ,INTEREST_COMPOUNDING_FREQ,PRIN_PAYOUT_ACC,INTEREST_PAYOUT_ACC,PAN,TRANSACTIONAL_BRANCH,FD_ADD_FLAG,FD_ADD_STATUS,FD_ADD_DT,REFERENCE_NO) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
INSERT_FDACC_DTL=Insert into SME_CREATE_FD_DTL (CUSTOMER_ID,MAKER_ID,SOURCE_ACC_NO,DEPOSIT_AMT,JOINT_HOLDER_FALG,PRODUCT_CD,MONTHS,DAYS,SWEEP_IN_FLAG,BRANCH_CD,FLAG_SC_WAIVE,FLAG_RESTRICT_ACC,PAY_IN_MODE,PAY_IN_NARRATION,INTEREST_PAYOUT_FREQ,INTEREST_COMPOUNDING_FREQ,PRIN_PAYOUT_ACC,INTEREST_PAYOUT_ACC,PAN,TRANSACTIONAL_BRANCH,FD_ADD_FLAG,FD_ADD_STATUS,FD_ADD_DT,REFERENCE_NO,INSTRUCTION_ACCOUNT_NO) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?)
UPDATE_FD_REQ_REF=UPDATE SME_CREATE_FD_DTL SET RES_RESFERENCE_NO = ? WHERE REFERENCE_NO = ?


#FOR RD ACC
INSERT_RDACC_DTL=Insert into SME_CREATE_RD_DTL (CUSTOMER_ID,MAKER_ID,JOINT_HOLDER_FLAG,PRODUCT_CD,ACCOUNT_NO,INSTALLMENT_AMT,TERM_PERIOD,BRANCH_CD_RD,PAN,TRANSACTION_BRANCH,RD_ADD_FLAG,RD_STATUS_FLAG,RD_ADD_DT,REFERENCE_NO) values (?,?,?,?,?,?,?,?,?,?,'A','I',sysdate,SME_RDACC_REF_SEQ.NEXTVAL)
#FOR SI
SELECT_COUNT_EXIST_FOR_SI=SELECT COUNT(*) FROM SME_OPEN_SI_DTL WHERE CUSTOMER_ID = ? AND BENE_ID = ? AND SOURCE_ACCOUNT_NO = ? AND CREDIT_AMT = ? AND FREQUENCY_CD = ? AND START_DT = ? AND END_DT = ? AND SI_ADD_STATUS = ?
INSERT_SI_DTL=Insert into SME_OPEN_SI_DTL (CUSTOMER_ID,MAKER_ID,REQUEST_TYPE,NEFT_SI_ID,BENE_ID,BEDNE_NAME,BENE_IFSC_CD,SOURCE_ACCOUNT_NO,BENE_ACCOUNT_NO,CREDIT_AMT,FREQUENCY_CD,START_DT,END_DT,NARRATION,SI_ADD_FLAG,SI_ADD_STATUS,SI_ADD_DT,REFERENCE_NO) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,SYSDATE,?)
SELECT_SI_REFRENCE_NO = SELECT SME_SI_REF_SEQ.NEXTVAL FROM DUAL
UPDATE_SI_AUTH_REF_NO=UPDATE SME_OPEN_SI_DTL SET RES_REFERENCE_NO = ? WHERE REFERENCE_NO = ?  

#FOR CASA TO CASA FT
INSERT_CASATOCASA_DTL=Insert into SME_CASATOCASA_DTL (CUSTOMER_ID,MAKER_ID,FROM_ACCOUNT_NO,TO_ACCOUNT_NO,TRANSACTION_AMT,NARRATION,REFERENCE_NO1,REFERENCE_NO2,REFERENCE_NO3,TXN_CODE,CTC_ADD_FLAG,CTC_ADD_STATUS,CTC_ADD_DT,REFERENCE_NO) values (?,?,?,?,?,?,?,?,?,?,'N','I',SYSDATE,SME_CASATOCASA_SEQ.NEXTVAL)
#FOR PERSON TO ACC FT
INSERT_P2A_DTL=Insert into SME_PERSONTOACC_DTL (CUSTOMER_ID,MAKER_ID,FROM_ACCOUNT_NO,TO_ACCOUNT_NO,MOBILE_NO,IFSC_CD,NARRATION,TRANSACTION_AMT,PTOA_ADD_FLAG,PTOA_ADD_STATUS,PTOA_ADD_DT,REFERENCE_NO) values (?,?,?,?,?,?,?,?,'N','I',SYSDATE,SME_P2A_SEQ.NEXTVAL)


#*********************************************************
#
# Pending Authorization from Maker 
#
#*********************************************************
#FOR BENE
SELECT_MAKER_ID=select distinct SMEMAKERCD from COM_MAKER_MST where AUTHOR_CD = ? and AUTH_STATUS = 'A'
SELECT_NEW_BENEFICIARY_FOR_PLIST=select BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_MOBILE_NO,BENE_IFSC,BENE_DESC,BENE_ADD_DT,BENE_MODE,REFERENCE_NO from SME_BENEFICIARY_DTL_TMP where MAKER_ID = ? and BENE_STATUS = 'I' and BENE_MODE = 'A'
SELECT_UPDATE_BENEFICIARY_FOR_PLIST=select BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_MOBILE_NO,BENE_IFSC,BENE_DESC,BENE_ADD_DT,BENE_MODE,REFERENCE_NO,BENE_DELETED_TRANSFER_TYPE from SME_BENEFICIARY_DTL_TMP where MAKER_ID = ? and CUSTOMER_ID = ? and BENE_STATUS = 'I' and BENE_MODE = 'U'  
SELECT_DELETE_BENEFICIARY_FOR_PLIST=select BENE_ID,BENE_DELETED_TRANSFER_TYPE,BENE_ADD_DT,BENE_MODE,REFERENCE_NO,BENE_TYPE from SME_BENEFICIARY_DTL_TMP where MAKER_ID = ? and CUSTOMER_ID = ? and BENE_STATUS = 'I' and BENE_MODE = 'D'
SELECT_CASA_FT_FROM_MAKER=select FROM_ACCOUNT_NO,TO_ACCOUNT_NO,TRANSACTION_AMT,NARRATION,CTC_ADD_FLAG,CTC_ADD_STATUS,CTC_ADD_DT,REFERENCE_NO from SME_CASATOCASA_DTL where MAKER_ID = ? and CTC_ADD_STATUS = 'I'
SELECT_P2A_FT_FROM_MAKER=select FROM_ACCOUNT_NO,TO_ACCOUNT_NO,MOBILE_NO,IFSC_CD,NARRATION,TRANSACTION_AMT,PTOA_ADD_FLAG,PTOA_ADD_STATUS,PTOA_ADD_DT,REFERENCE_NO from SME_PERSONTOACC_DTL where MAKER_ID = ? and PTOA_ADD_STATUS = 'I'
SELECT_BENE_FT_FROM_MAKER=select SOURCE_ACCOUNRT_NO,BENE_ID,TRANSFER_TYPE,TRANSFER_AMT,BENE_INFO,TRANSFER_ADD_FLAG,TRANSFER_ADD_STATUS,TRANSFER_ADD_DT,REFERENCE_NO from SME_PAYTOBENE_DTL where MAKER_ID = ? and TRANSFER_ADD_STATUS = 'I'
UPDATE_BENE_APPROVAL=update SME_BENEFICIARY_DTL_TMP set BENE_STATUS = ?,RES_ERROR_MSG = ? , BENE_ADD_DT = sysdate where REFERENCE_NO = ?
ALL_SINGLE_FUND_TRANS_APPROVAL=UPDATE SME_SINGLE_TXN_MAKER_DTL SET APPROVER_ID = ?,APPROVE_STATUS = ?,APP_REJ_DT = sysdate,REMARKS = ?,RES_REF_NO = ? WHERE REF_NO = ?

ALL_SINGLE_FUND_TRANS_APPROVAL_WITHOUT_REMARKS = UPDATE SME_SINGLE_TXN_MAKER_DTL SET APPROVER_ID = ?,APPROVE_STATUS = ?,APP_REJ_DT = sysdate,RES_REF_NO = ? WHERE REF_NO = ?

SELECT_ALL_BENE_FROM_DB=select BENE_ID,BENE_TRANSFER_TYPE from SME_BENEFICIARY_DTL where CUSTOMER_ID = ? and BENE_ADD_FLAG = 'Y' and BENE_MODE in ('A','U')
#SELECT_BENEDTL_FROM_DB=select BENE_NAME,BENE_ACCOUNT_NO,BENE_IFSC,BENE_MOBILE_NO from SME_BENEFICIARY_DTL where CUSTOMER_ID = ? and BENE_ID = ? and BENE_TRANSFER_TYPE = ?
SELECT_BENEDTL_FROM_DB=select BENE_NAME,BENE_ACCOUNT_NO,BENE_IFSC,BENE_MOBILE_NO,BENE_TRANSFER_TYPE,BANK_NAME,BENE_EMAIL_ID from SME_BENEFICIARY_DTL where CUSTOMER_ID = ? and upper(BENE_ID) = ?
#FOR BULK TRANSACTION
SELECT_BULK_TRANSACTION_FORM=select GROUP_ID,TOTAL_PAY_AMT,BULK_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TO_CHAR(MAKER_INITIATED_DT, 'DD-MON-YYYY HH24:MI:SS'),TRAN_REF_NO,GRP_TRANS_TYPE,ADDED_BENE_DTL,FILE_BENE_DTL from SME_BULK_TRANSACTION_DTL where MAKER_ID = ? and MAKER_STATUS = ?
UPDATE_BT_APPROVAL=update SME_BULK_TRANSACTION_DTL set MAKER_STATUS = ? where TRAN_REF_NO = ?
FETCH_BULK_DTL_TXN=SELECT GROUP_ID,TOTAL_PAY_AMT,ADDED_BENE_DTL,FILE_BENE_DTL FROM SME_BULK_TRANSACTION_DTL WHERE AUTH_REF_NO=?
FETCH_SALARY_DTL_TXN=SELECT TOTAL_AMT,BENE_DTL,FILE_BENE_DTL FROM SME_SALARY_TRANSACTION_DTL WHERE AUTH_REF_NO=?


SELECT_SALARY_TRANSACTION_FORM=select TOTAL_EMP,SALARY_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,REMARKS,TO_CHAR(MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),TXN_TRANSFER_TYPE,TRAN_REF_NO,TOTAL_AMT,BENE_DTL,FILE_BENE_DTL from SME_SALARY_TRANSACTION_DTL where MAKERID = ? and MAKER_STATUS = ?

SALARY_TXN_APP_REJ=UPDATE SME_SALARY_TRANSACTION_DTL set MAKER_STATUS = ? , INITIATED_DATE_TIME = sysdate , TRANSACTION_STATUS = ?  ,REMARKS = ? , CUSTOMER_ID =? where TRAN_REF_NO = ?
SALARY_TXN_APP_REJ_WIThOUT_REMARKS=UPDATE SME_SALARY_TRANSACTION_DTL set MAKER_STATUS = ? , INITIATED_DATE_TIME = sysdate , TRANSACTION_STATUS = ?   , CUSTOMER_ID =? where TRAN_REF_NO = ?

#BULK_TXN_APP_REJ=UPDATE SME_BULK_TRANSACTION_DTL set MAKER_STATUS = ? , INITIATED_DATE_TIME = sysdate , TRANSACTION_STATUS = ? ,REMARKS = ? where TRAN_REF_NO = ?
BULK_TXN_APP_REJ=UPDATE SME_BULK_TRANSACTION_DTL set MAKER_STATUS = ? , TRANSACTION_DATE_TIME = TO_CHAR(SYSDATE, 'DD-MON-YYYY HH24:MI:SS')  , TRANSACTION_STATUS = ? ,REMARKS = ?,CUSTOMER_ID=? where TRAN_REF_NO = ?
#added by 2330 to leep the maker remarks intact
BULK_TXN_APP_REJ_WITHOUT_UPDATE=UPDATE SME_BULK_TRANSACTION_DTL set MAKER_STATUS = ? , TRANSACTION_DATE_TIME = TO_CHAR(SYSDATE, 'DD-MON-YYYY HH24:MI:SS')  , TRANSACTION_STATUS = ? ,CUSTOMER_ID=? where TRAN_REF_NO = ?

#*****************************************************************
#
# API CALL from After AuthroriZation
#
#*****************************************************************
SELECT_NEW_BENEFICIARY_FOR_API=select BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_MOBILE_NO,BENE_IFSC,BENE_DESC,BENE_MODE,BENE_DELETED_TRANSFER_TYPE,BENE_TYPE,MAKER_ID,BANK_NAME,BENE_ADDED_AMT from SME_BENEFICIARY_DTL_TMP where REFERENCE_NO = ?
SELECT_DELETE_BENEFICIARY_FOR_API=select BENE_ID,BENE_TRANSFER_TYPE from SME_BENEFICIARY_DTL where REFERENCE_NO = ?
UPDATE_BENE_STATUS_IF_SUCC=update SME_BENEFICIARY_DTL_TMP set BENE_ADD_FLAG = 'Y',RES_REFERENCE_NO = ? where REFERENCE_NO = ?
UPDATE_BENE_STATUS_IF_FAIL=update SME_BENEFICIARY_DTL_TMP set BENE_ADD_FLAG = 'N',RES_ERROR_MSG = ? where REFERENCE_NO = ?


#Get COUNT FOR BENEFICIARY
#SELECT_PENDING_BENEFICIARY_COUNT= SELECT COUNT(1) FROM SME_BENEFICIARY_DTL_TMP WHERE CUSTOMER_ID = ? AND BENE_STATUS=?
SELECT_PENDING_BENEFICIARY_COUNT=SELECT COUNT(1) FROM SME_BENEFICIARY_DTL_TMP WHERE (CUSTOMER_ID = ? AND BENE_STATUS='I' AND BENE_MODE = 'A') or  (CUSTOMER_ID = ? AND BENE_STATUS='I' AND BENE_MODE IN ('U','D'))
#SELECT_PENDING_GROUPBENE_COUNT=SELECT distinct GROUP_ID FROM SME_GROUP_BENE_DTL_TMP WHERE CUSTOMER_ID=? AND BENE_ADD_STATUS_M=?
SELECT_PENDING_GROUPBENE_COUNT=SELECT distinct GROUP_ID FROM SME_GROUP_BENE_DTL_TMP WHERE (CUSTOMER_ID=? AND BENE_ADD_STATUS_M='I' AND GROUP_MODE = 'N') OR  (CUSTOMER_ID=? AND BENE_ADD_STATUS_M='I' AND GROUP_MODE IN ('M','D'))
SELECT_PENDING_GROUPBENE_TRANS_COUNT=SELECT COUNT(1) FROM SME_BULK_TRANSACTION_DTL WHERE CUSTOMER_ID=? AND MAKER_STATUS=?
SELECT_PENDING_DOCUPLOAD_COUNT=SELECT COUNT(1) FROM CUST_DOC_UPLOAD_DETAILS WHERE CUSTOMER_ID=? AND MAKER_STATUS=?
SELECT_ALL_SINGLE_TXN_COUNT=SELECT COUNT(*) FROM SME_SINGLE_TXN_MAKER_DTL WHERE COMPANY_ID = ? AND APPROVE_STATUS = ? AND SERVICECD like ?

SELECT_COUNT_FOR_BULK=SELECT COUNT(*) FROM SME_BULK_TRANSACTION_DTL WHERE MAKER_STATUS = ? AND CUSTOMER_ID = ?
SELECT_COUNT_FOR_SAL=SELECT COUNT(*) FROM SME_SALARY_TRANSACTION_DTL WHERE MAKER_STATUS = ? AND CUSTOMER_ID = ?

#SELECT PENDING ALL TYPE OF FUND TRANSFER(SINGLY)
SELECT_FT02_DTL=SELECT REF_NO,SERVICECD,BENEID,AMOUNT,FROM_ACC,REMARKS,TO_CHAR(MAKE_DT, 'DD-MON-YYYY HH24:MI:SS'),MAKER_ID,APPROVER_ID,TRANSFER_TYPE,BENE_IFSC,BENE_NAME,MOBILE_NO,TO_ACC FROM SME_SINGLE_TXN_MAKER_DTL WHERE MAKER_ID = ? AND APPROVE_STATUS = ? AND SERVICECD = 'FT02'
#--------Group verfication for Checker CR----29-03-2023---2459
SELECT_FT03_DTL=SELECT REF_NO,SERVICECD,BENE_IFSC,AMOUNT,FROM_ACC,TO_ACC,REMARKS,TO_CHAR(MAKE_DT, 'DD-MON-YYYY HH24:MI:SS'),MAKER_ID,APPROVER_ID,MOBILE_NO,BENE_NAME FROM SME_SINGLE_TXN_MAKER_DTL WHERE MAKER_ID = ? AND APPROVE_STATUS = ? AND SERVICECD = 'FT03'
SELECT_FT01_DTL=SELECT REF_NO,SERVICECD,AMOUNT,FROM_ACC,TO_ACC,REMARKS,TO_CHAR(MAKE_DT, 'DD-MON-YYYY HH24:MI:SS'),MAKER_ID,APPROVER_ID FROM SME_SINGLE_TXN_MAKER_DTL WHERE MAKER_ID = ? AND APPROVE_STATUS = ? AND SERVICECD = 'FT01'

#SELECT SI LIST FROM MAKER INITIATION
SELECT_SI_LIST_MAKER= SELECT CUSTOMER_ID,MAKER_ID,BENE_ID,BEDNE_NAME,BENE_IFSC_CD,SOURCE_ACCOUNT_NO,BENE_ACCOUNT_NO,CREDIT_AMT,NARRATION,REFERENCE_NO,TO_CHAR(SI_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),NEFT_SI_ID,FREQUENCY_CD,START_DT,END_DT,REQUEST_TYPE FROM SME_OPEN_SI_DTL WHERE MAKER_ID = ? AND SI_ADD_STATUS = ? 
UPDATE_SI_APP_REJ=UPDATE SME_OPEN_SI_DTL SET SI_ADD_STATUS = ?, RES_ERROR_MSG = ?,CUSTOMER_ID = ? WHERE REFERENCE_NO = ?
UPDATE_SI_APP_DOUBLE=UPDATE SME_OPEN_SI_DTL SET SI_ADD_STATUS = ? WHERE REFERENCE_NO = ?
SELECT_SI_FROM_DB=SELECT CUSTOMER_ID,BENE_ID,BEDNE_NAME,BENE_IFSC_CD,SOURCE_ACCOUNT_NO,BENE_ACCOUNT_NO,CREDIT_AMT,NARRATION,REFERENCE_NO,SI_ADD_DT,NEFT_SI_ID,FREQUENCY_CD,START_DT,END_DT,REQUEST_TYPE,REFERENCE_NO FROM SME_OPEN_SI_DTL WHERE RES_REFERENCE_NO = ?
#SELECT DOC UPLOAD INITIATION FROM MAKER 
SELECT_DOC_UPLOAD_LIST_MAKER=SELECT UPLOADED_FILE_NAME,CUSTOMER_ID,TO_CHAR(UPLOAD_DATE, 'DD-MON-YYYY HH24:MI:SS'),BROWSE_FILE_NAME,REQ_ID,REMARKS FROM CUST_DOC_UPLOAD_DETAILS WHERE MAKER_ID = ? AND MAKER_STATUS = ?
UPDATE_DOC_UPLOAD_APP_REJ=UPDATE CUST_DOC_UPLOAD_DETAILS SET MAKER_STATUS = ?, REMARKS = ?,CUSTOMER_ID = ? WHERE REQ_ID = ?  
# Added by Prabhat for get upload file name at the time of rejection on 09-01-2019
SELECT_DOC_NAME_FOR_REJ=SELECT UPLOADED_FILE_NAME FROM CUST_DOC_UPLOAD_DETAILS WHERE REQ_ID = ?
#UPDATE_DOC_UPLOAD_APP_REJ=UPDATE CUST_DOC_UPLOAD_DETAILS SET MAKER_STATUS = ?, REMARKS = ? WHERE REQ_ID = ?  


SELECT_CUSTID_FROM_XREF = SELECT COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO =(SELECT DISTINCT(COD_ACCT_NO) FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST=? AND cod_acct_no=cast(? as char(48)) AND COD_ACCT_CUST_REL='AUS' )AND COD_CUST <>?

#SELECT_COUNT_FROM_APPROVE_MST = SELECT APPROVER_CD,APPROVER_ID FROM COM_APPROVE_MST WHERE CUSTOMER_ID=?
SELECT_COUNT_FROM_APPROVE_MST = SELECT COUNT(1) FROM COM_APPROVE_MST WHERE CUSTOMER_ID=?

SELECT_FROM_APPROVE_MST = SELECT APPROVER_CD,APPROVER_ID FROM COM_APPROVE_MST WHERE CUSTOMER_ID=? ORDER by APPROVER_ID ASC
#CHECK IF rs.next()==false INSERT INTO APPROVE_MST ELSE check if approver_cd exist or not then insert
INSERT_INTO_APPROVE_MST =INSERT INTO COM_APPROVE_MST(CUSTOMER_ID,APPROVER_CD,APPROVER_NAME,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,BANK_ID,APPROVER_ID) VALUES (?,?,'CJ',COM_APPROVE_MST_SEQ.NEXTVAL,'A','CJ',SYSDATE,SYSDATE,'CJ',SYSDATE,SYSDATE,'Y',1,'YES',?)
#CHECK IF SERVICECDID AND ACCOUNT IS PRESENT IN APPROVING_MST
SELECT_COUNT_FROM_APPROVING_MST = SELECT COUNT(1) FROM COM_APPROVALMAPPING_MST WHERE SERVICECDID=? AND ACCOUNT_NO=?
#CHECK IF COUNT==0 INSERT INTO APPROVING_MST ELSE DO NOTHING
INSERT_INTO_APPROVING_MST =INSERT INTO COM_APPROVALMAPPING_MST(SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID) VALUES (?,?,?,COM_APPROVALMAPPING_MST_SEQ.NEXTVAL,'A','CJ',SYSDATE,SYSDATE,'CJ',SYSDATE,SYSDATE,'Y',1,?,'J',?,'YES')
#UPDATE APPROVING MST
UPDATE_APPROVING_MST=UPDATE COM_APPROVALMAPPING_MST SET AUTH_STATUS= ?,APPROVER_LIST=?,TOTAL_SCORE=? WHERE SERVICECDID=? AND ACCOUNT_NO=? AND SERVICE_CD=?

#TO Document List from Admin
SELECT_CAT=select CATEGORY_ID,CATEGORY_NAME from RC_COM_DOC_CATEGORY_MST where ACTIVE_FLAG = 'Y'

SELECT_TYPE=select TYPE_ID,TYPE_NAME from RC_COM_DOC_TYPE where CATEGORY_ID = ? and ACTIVE_FLAG = 'Y'

SELECT_DOC=select DOC_CODE_NAME,DOC_NAME,DOCUMENT_EXPIRY1,PERIOD_OF_EXPIRY from RC_COM_DOC_NAME where CATEGORY_ID = ? and TYPE_ID = ? and ACTIVE_FLAG = 'Y'

#For Select Company ID of Customer
#CUSTOMER_COMPANY_ID=select distinct(COD_CUST) from VW_CH_ACCT_CUST_XREF where COD_ACCT_CUST_REL = 'SOW' and COD_ACCT_NO in (select COD_ACCT_NO from VW_CH_ACCT_CUST_XREF where COD_CUST = ?)

#### Modified on 24092019 : For Live change in SOW (Multiple) by shraddha 2299 FOR AMC
CUSTOMER_COMPANY_ID=select distinct(COD_CUST) from VW_CH_ACCT_CUST_XREF where COD_ACCT_CUST_REL = 'SOW' AND COD_PROD NOT IN (404) and COD_ACCT_NO in (select COD_ACCT_NO from VW_CH_ACCT_CUST_XREF where COD_CUST = ? )

SELECT_COMPANY_ID=select COMPANY_ID from SME_REG_USER_INFO where CUST_ID = ?

#LIST_OF_COMP_ACCOUNT=select distinct COD_ACCT_NO from VW_CH_ACCT_CUST_XREF where COD_CUST = TO_CHAR(?)
#Add new Product code - 237 for version 7.9.0 on 11-04-2023
#Product code - 237 addition in Yes MSME
LIST_OF_COMP_ACCOUNT=select distinct COD_ACCT_NO from VW_CH_ACCT_CUST_XREF where COD_CUST = TO_CHAR(?) AND ((cod_prod between 501 and 599) or (cod_prod between 901 and 999) or (cod_prod between 601 and 899) OR COD_PROD IN (207,208,237,204,210,240,236,249))
#LIST OF ACCOUNT NUMBER FOR CUSTOMER
LIST_OF_ACCOUNT=select distinct COD_ACCT_NO from VW_CH_ACCT_CUST_XREF where COD_CUST = ?


############################################################
#      
#      RM related queries
#
###########################################################
TOTAL_COUNT_RELATIONSHIP=select count(*) from (select CUSTOMER_NO from VW_TOT_ASSET where RM_ADID = ? union select COD_CUST_ID from VW_TOT_LIAB where EMP_ADID = ?) where rownum > 0
CHECK_COUNT_SUM_ASSET=select count(*),sum(TOT_ASSET) from VW_TOT_ASSET where RM_ADID = ?
CHECK_COUNT_SUM_LIAB=select count(*),sum(TOT_BOOK_VAL) from VW_TOT_LIAB where EMP_ADID = ? 
CHECK_COUNT_SUM_OVERDUE=select count(*),sum(AMOUNT_DUE) from VW_CUST_RM_WISE_OVERDUE where RM_ADID = ?
UNION_CUSTOMER_FOR_ASSET_AND_LIAB=select CUSTOMER_NO from VW_TOT_ASSET where RM_ADID = ? union select COD_CUST_ID from VW_TOT_LIAB where EMP_ADID = ?
GET_ASSETAMOUNT=select TOT_ASSET from VW_TOT_ASSET where CUSTOMER_NO = ?
GET_LIABAMOUNT=select TOT_BOOK_VAL from VW_TOT_LIAB where COD_CUST_ID = ?
GET_CUSTOMERNAME=select NAM_CUST_FULL,REF_CUST_TELEX from MV_CI_CUSTMAST_ALL where COD_CUST_ID = ?
GET_LIMIT_COUNT=select count(*) from VW_LIMITS where CUSTOMER_NO = ? and MAIN_LINE is null

######################################################################33
GET_LOGIN_REQUEST=SELECT COUNT(*) FROM SME_REQUEST WHERE REQUEST_ID=?
INSERT_LOGIN_REQUEST=INSERT INTO SME_REQUEST(REQUEST_ID) VALUES(?)
###########################################################################



################################################
HOLIDAY_EXIST=select count(*) from SFMS_NHL_NODE_HOLIDAY_LST where NHL_DATE = sysdate
HOLIDAY_EXIST_NEFT=select count(*),NHL_DESC from SFMS_NHL_NODE_HOLIDAY_LST where to_date(NHL_DATE,'DD-MM-YYYY') = to_date(sysdate,'DD-MM-YYYY') GROUP BY NHL_DESC
################################################

################################################
# APPLICATION STATUS
SELECT_APP_STATUS=SELECT PROP_REC_DATE,TO_CHAR(PERIOD, 'DD-MON-YYYY'),FINAL_STATUS from VW_APP_STATUS where MSME_APPL_NUM = ?
################################################

################################################
# CHEQUE REFERRAL
SELECT_CHEQUE_REFERAL=select NAM_CUST_FULL,COD_ACCT_NO,AMOUNT,CHQ_NO from CUSTOMER_CHQ_REFERAL where CUSTOMER_CHQ_REFERAL = ?
################################################

SELECT_LIMIT_WITHOUT_EXPIRY_DETAILS=SELECT ORD,LIAB_ID,CUSTOMER_NO,LINE_ID,DESCRIPTION,MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE CUSTOMER_NO  = ? ORDER BY ord

SELECT_COUNT_FOR_SI=SELECT COUNT(*) FROM SME_OPEN_SI_DTL WHERE CUSTOMER_ID = ? AND SI_ADD_STATUS = ?
SELECT_SI_DATA_FOR_SI=SELECT BENE_ID,BEDNE_NAME,SOURCE_ACCOUNT_NO,BENE_ACCOUNT_NO,CREDIT_AMT,FREQUENCY_CD,START_DT,END_DT,NARRATION,SI_ADD_DT,REFERENCE_NO FROM SME_OPEN_SI_DTL WHERE MAKER_ID = ? AND SI_ADD_STATUS = ?

#check status of approver
CHECK_BENE_INITIATE_STATUS=SELECT COUNT(*) FROM SME_BENEFICIARY_DTL_TMP WHERE REFERENCE_NO = ? AND BENE_STATUS = 'I'
CHECK_BT_INITIATE_STATUS=SELECT COUNT(*),GRP_TRANS_TYPE,SOURCE_ACCOUNT_NO,TOTAL_PAY_AMT FROM SME_BULK_TRANSACTION_DTL WHERE MAKER_STATUS = 'I' AND TRAN_REF_NO = ? GROUP BY GRP_TRANS_TYPE,SOURCE_ACCOUNT_NO,TOTAL_PAY_AMT



#CHECK_FT_INITIATE_STATUS=SELECT COUNT(*) FROM SME_SINGLE_TXN_MAKER_DTL WHERE APPROVE_STATUS <> 'I' AND REF_NO = ?
CHECK_FT_INITIATE_STATUS=SELECT COUNT(*),TRANSFER_TYPE,FROM_ACC,AMOUNT FROM SME_SINGLE_TXN_MAKER_DTL WHERE APPROVE_STATUS = 'I' AND REF_NO = ? GROUP BY TRANSFER_TYPE,FROM_ACC,AMOUNT
#CHECK_GB_INITIATE_STATUS=SELECT COUNT(*) FROM SME_GROUP_BENE_DTL_TMP where BENE_ADD_STATUS_M <> 'I' AND REF_NO = ?
CHECK_GB_INITIATE_STATUS=SELECT COUNT(*),GROUP_ID,BENE_ID,BENE_DTL FROM SME_GROUP_BENE_DTL_TMP where BENE_ADD_STATUS_M = 'I' AND REF_NO = ? GROUP BY GROUP_ID,BENE_ID,BENE_DTL
CHECK_SAL_INITIATED_STATUS=SELECT COUNT(*),TXN_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,TOTAL_AMT FROM SME_SALARY_TRANSACTION_DTL WHERE MAKER_STATUS = 'I' AND TRAN_REF_NO = ? GROUP BY TXN_TRANSFER_TYPE,SOURCE_ACCOUNT_NO,TOTAL_AMT
CHECK_SI_INITIATE_STATUS=SELECT COUNT(*) FROM SME_OPEN_SI_DTL where SI_ADD_STATUS <> 'I' AND REFERENCE_NO = ?

CHECK_FD_INITIATE_STATUS=SELECT COUNT(*) FROM SME_CREATE_FD_DTL where FD_ADD_STATUS <> 'I' AND REFERENCE_NO = ?
CHECK_DU_INITIATE_STATUS=SELECT COUNT(*) FROM CUST_DOC_UPLOAD_DETAILS where MAKER_STATUS <> 'I' AND REQ_ID = ?


#CHECK IMPS TXN TOTAL These query commented because YBL Raised changes ovvver call with Prabhat Neha Amit
#SELECT_CHECK_IMPS_TXN_TOTAL= select sum(TRAN_AMOUNT) from (select TRAN_AMOUNT,SOURCE_ACC_NO,TRAN_REF_NO,TRAN_DATE from SME_TRANSACTION_DTL where  TRAN_DATE >= trunc(SYSDATE) and SOURCE_ACC_NO = ? and AUTH_STATUS in ('I','P','A') and TRAN_TYPE in ('IMPS','AD-HOC'))where ROWNUM>0
#SELECT_CHECK_ADHOC_TXN_TOTAL= select sum(TRAN_AMOUNT) from (select TRAN_AMOUNT,SOURCE_ACC_NO,TRAN_REF_NO,TRAN_DATE from SME_TRANSACTION_DTL where  TRAN_DATE >= trunc(SYSDATE) and SOURCE_ACC_NO = ? and AUTH_STATUS in ('I','P','A') and TRAN_TYPE = 'AD-HOC')where ROWNUM>0

#CHECK IMPS TXN TOTAL 
SELECT_CHECK_IMPS_TXN_TOTAL= select sum(TRAN_AMOUNT) from (select TRAN_AMOUNT,SOURCE_ACC_NO,TRAN_REF_NO,TRAN_DATE from SME_TRANSACTION_DTL where  TRAN_DATE >= trunc(SYSDATE) and SOURCE_ACC_NO = ? and AUTH_STATUS in ('A') and TRAN_TYPE in ('IMPS','AD-HOC'))where ROWNUM>0
SELECT_CHECK_ADHOC_TXN_TOTAL= select sum(TRAN_AMOUNT) from (select TRAN_AMOUNT,SOURCE_ACC_NO,TRAN_REF_NO,TRAN_DATE from SME_TRANSACTION_DTL where  TRAN_DATE >= trunc(SYSDATE) and SOURCE_ACC_NO = ? and AUTH_STATUS in ('A') and TRAN_TYPE = 'AD-HOC')where ROWNUM>0

#FOR GENERIC NOTIFICATION
SELECT_MESSAGE_TYPE=select MESSAGE_TAG_NAME,MESSAGE_BODY from SME_MESSAGE_MST where MESSAGE_CODE = ?
SELECT_ACCOUNT_DTL=select SERVICE_CD,SOURCE_ACC_NO,CUSTOMER_ID,MAKER_CD from SME_TRANSACTION_DTL where TRAN_REF_NO = ?
SELECT_CUSTOMER_DTL=select APPROVER_LIST from COM_APPROVALMAPPING_MST where ACCOUNT_NO = ? and SERVICE_CD = ?
INSERT_NOTIFICATION_ALL=Insert into NOTIFICATION (NOTIFICATION_ID,NOTIFICATION_TAG_NAME,NOTIFICATION_DESCRIPTION,CUSTOMER_ID,CREATED_ON,SEND_STATUS) values (NOTIFICATION_SEQ.NEXTVAL,?,?,?,SYSDATE,'N')
READ_NOTIFICATION=update NOTIFICATION set SEND_STATUS = 'Y' where NOTIFICATION_ID=?
READ_ALL_NOTIFICATION=update NOTIFICATION set SEND_STATUS = 'Y' where CUSTOMER_ID=?
READ_INBOX=update OFFER set READ_FLAG = 'Y' where OFFER_ID=?
COUNT_INBOX_UNREAD_MSG=SELECT COUNT(*) FROM OFFER WHERE READ_FLAG = 'N' AND CREATED_ON >= sysdate -7 AND CUSTOMER_ID = ?

#Validate Session
VALIDATE_SESSION_ID=SELECT COUNT(*) FROM SME_APP_LOGIN_INFO WHERE SESSION_ID = ?

#EXTRA QUERY
SELECT_MAKER_ALIAS_MAPPING=SELECT SMEMAKERCD,MAKER_ALIAS_NAME FROM COM_MAKER_MST WHERE ACTIVE_FLAG = 'Y'

#BACKUP FILE
INSERT_SME_APP_LOGIN_INFO_BACKUP=insert into SME_APP_LOGIN_INFO_BACKUP select * from SME_APP_LOGIN_INFO where LOGIN_ID = ?
SELECT_PORTAL_CREDENTIAL=select REG_ID,PASSWORD,USER_TYPE,LOGIN_TYPE_MOBILE,TO_CHAR(LOGIN_DATE, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(LOGOUT_DATE, 'DD-MON-YYYY HH24:MI:SS'),LOGOUT_MODE,EXCEPTION_CD,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,TOKEN,LOGIN_NAME,TO_CHAR(LAST_REQUEST_TIME, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(LAST_FAILURE_ATTEMPT_TIME, 'DD-MON-YYYY HH24:MI:SS'),FIRST_LOGIN,SESSION_ID from SME_APP_LOGIN_INFO where LOGIN_ID = ?
UPDATE_LOGIN_TABLE_FOR_PORTAL_AT_REG=UPDATE SME_APP_LOGIN_INFO SET PORTAL_PASS = ?,PASSWORD = ?,USER_TYPE=?,LOGIN_TYPE_MOBILE=?,LOGIN_DATE=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LOGOUT_DATE=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LOGOUT_MODE=?,EXCEPTION_CD=?,DEVICE_NAME=?,DEVICE_PLATFORM=?,DEVICE_UUID=?,DEVICE_VERSION=?,DEVICE_DATE=?,DEVICE_IMEI=?,TOKEN=?,LOGIN_NAME=?,LAST_REQUEST_TIME=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LAST_FAILURE_ATTEMPT_TIME=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),FIRST_LOGIN=?,SESSION_ID = ? WHERE LOGIN_ID = ?
UPDATE_LOGIN_TABLE_FOR_PORTAL_AT_REG_IN_APP=UPDATE SME_APP_LOGIN_INFO SET PORTAL_PASS = ?,PASSWORD = ?,LOGIN_DATE=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LOGOUT_DATE=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LAST_REQUEST_TIME=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LAST_FAILURE_ATTEMPT_TIME=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LOGIN_TYPE_PORTAL='Y',SESSION_ID = ? WHERE LOGIN_ID = ?
UPDATE_LOGIN_TABLE_FOR_PORTAL_AT_REG1=UPDATE SME_APP_LOGIN_INFO SET PORTAL_PASS = ?,LOGIN_DATE=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LOGOUT_DATE=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LAST_REQUEST_TIME=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LAST_FAILURE_ATTEMPT_TIME=TO_DATE(?, 'DD-MON-YYYY HH24:MI:SS'),LOGIN_TYPE_PORTAL='Y',SESSION_ID = ? WHERE LOGIN_ID = ?
SELECT_PORTAL_CREDENTIAL_AT_APP_BINDING=select REG_ID,PORTAL_PASS,USER_TYPE,LOGIN_TYPE_PORTAL,TO_CHAR(LOGIN_DATE, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(LOGOUT_DATE, 'DD-MON-YYYY HH24:MI:SS'),LOGOUT_MODE,EXCEPTION_CD,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,TOKEN,LOGIN_NAME,TO_CHAR(LAST_REQUEST_TIME, 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(LAST_FAILURE_ATTEMPT_TIME, 'DD-MON-YYYY HH24:MI:SS'),FIRST_LOGIN,SESSION_ID from SME_APP_LOGIN_INFO where LOGIN_ID = ?

#Forget Password
EMAIL_COUNTER=Insert into EMAIL_COUNTER (USERID,SESSIONID,LOGOUT_MODE,EMAIL_COUNT) values (?,?,?,?)
SELECT_EMAIL_COUNTER=SELECT SESSIONID,LOGOUT_MODE,EMAIL_COUNT FROM  EMAIL_COUNTER WHERE USERID = ? and SESSIONID = ?
DELETE_EMAIL_COUNTER=DELETE EMAIL_COUNTER where USERID = ?

#PORTAL SYNC ============ Added By Deepak For CHECKER BlockUnBlockFlow on 26-08-2022 Added Only USER_BLOCKED Field
SELECT_PORTAL_CHECKER_LOGIN=select LOGOUT_MODE,LOGIN_COUNT,PORTAL_PASS,USER_LOCKED,USERNAME,TO_CHAR(LOGOUT_DATE, 'DD MON YYYY HH24:MI:SS'),USER_BLOCKED from SME_APP_LOGIN_INFO where LOGIN_ID = ?
UPDATE_LOGOUT_FLAG=update SME_APP_LOGIN_INFO set LOGOUT_MODE='T'  where LOGIN_ID = ?
SME_PORTAL_LOGIN=select LOGOUT_MODE,PORTAL_PASS from SME_APP_LOGIN_INFO where LOGIN_ID = ?

UPDATE_LOGIN_FLAG=UPDATE SME_APP_LOGIN_INFO SET LAST_REQUEST_TIME = sysdate, LOGIN_DATE = sysdate, LOGIN_COUNT = ?, LOGOUT_MODE = ? WHERE LOGIN_ID = ?
UPDATE_LASTREQ_TIME=UPDATE SME_APP_LOGIN_INFO SET LAST_REQUEST_TIME = sysdate, LOGIN_DATE = sysdate WHERE LOGIN_ID = ?


#CHECK USERTYPE LOGIN 171117
CHECK_USER_LOGIN_PORTAL=SELECT COUNT(*) FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ? AND USER_TYPE='A' AND LOGIN_TYPE_PORTAL='Y'
CHECK_USER_LOGIN_MOBILE=SELECT COUNT(*) FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ? AND USER_TYPE='A' AND LOGIN_TYPE_MOBILE='Y'

SELECT_USER_MST_COUNT=SELECT COUNT(*) FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ?
SELECT_USER_DATA_MST_TMP=SELECT USERNAME,PASSWORD,EXCEPTION_CD,LOGIN_TYPE_MOBILE,DEVICE_NAME,DEVICE_PLATFORM,DEVICE_UUID,DEVICE_VERSION,DEVICE_DATE,DEVICE_IMEI,LOGIN_NAME,LAST_FAILURE_ATTEMPT_TIME,USER_LOCKED,FIRST_LOGIN,MPIN_COUNT,USER_TYPE FROM SME_APP_LOGIN_INFO_TMP WHERE LOGIN_ID = ?
#Added By Deepak For CHECKER BlockUnBlockFlow on 29-08-2022 Added Only USER_BLOCKED Field
UPDATE_LOGIN_MST=UPDATE SME_APP_LOGIN_INFO SET USERNAME=  ?,PASSWORD=  ?,EXCEPTION_CD=  ?,LOGIN_TYPE_MOBILE=  ?,DEVICE_NAME=  ?,DEVICE_PLATFORM=  ?,DEVICE_UUID=  ?,DEVICE_VERSION=  ?,DEVICE_DATE=  ?,DEVICE_IMEI=  ?,LOGIN_NAME=  ?,LAST_FAILURE_ATTEMPT_TIME=  ?,USER_LOCKED=  ?,FIRST_LOGIN=  ?,MPIN_COUNT=  ?,USER_TYPE= ?,USER_BLOCKED='N'  WHERE LOGIN_ID = ?

#CHECK FOR DAILY TRANSACTION GROUP LIMIT 01122017
SELECT_SERVICE_CODE_DAILY_TRANSACTION=SELECT SERVICE_CD from COM_SERVICE_MST WHERE SERVICE_TYPE=(SELECT SERVICE_TYPE FROM COM_SERVICE_MST WHERE SERVICE_CD= ?)
SELECT_TOTAL_DAILY_TRANSCTION_LIMIT=SELECT DAILY_LIMIT FROM COM_APPROVAL_GRP_MST WHERE SERVICE_CD=(SELECT SERVICE_TYPE FROM COM_SERVICE_MST WHERE SERVICE_CD=?) AND ACCOUNT_NO=?

#CHECK FOR MAKER SERVICE GROUP 01122017
SELECT_SERVICE_GROUP=SELECT GROUP_ID,GROUP_NAME FROM COM_SERVICEGROUP WHERE ACTIVE_FLAG = 'Y' order by SERVICEGROUP_SEQUENCE asc
SELECT_SERVICE_FROM_GROUP=select SERVICE_CD,SERVICE_DESC from COM_SERVICE_MST where ACTIVE_FLAG = 'Y' and SERVICE_TYPE = ?



###################################################YES_AMAZON###########################################################
#TO GET STATE LIST
#SELECT_STATE_ADDRESS_MST= SELECT DISTINCT STATE FROM RC_COM_ADDRESS_MST ORDER BY STATE ASC
#below query modified by priya on 7-jun-2016 if user wants to remove state from master through UI change active_flag to N
SELECT_STATE_ADDRESS_MST= SELECT DISTINCT STATE FROM RC_COM_ADDRESS_MST WHERE ACTIVE_FLAG ='Y' ORDER BY STATE ASC

#below query modified by priya on 7-jun-2016 if user wants to remove city from master through UI
#SELECT_CITY_ADDRESS_MST= SELECT DISTINCT UPPER(CITY) AS CITY FROM RC_COM_ADDRESS_MST WHERE STATE=? ORDER BY CITY ASC
SELECT_CITY_ADDRESS_MST= SELECT DISTINCT UPPER(CITY) AS CITY FROM RC_COM_ADDRESS_MST WHERE STATE=? AND ACTIVE_FLAG ='Y' ORDER BY CITY ASC

SELECT_CATEGORY_MST= SELECT DISTINCT UPPER(CATEGORY) AS CATEGORY FROM RC_COM_CATEGORY_MST WHERE ACTIVE_FLAG ='Y' ORDER BY CATEGORY ASC

#oracle
INSERT_VENDOR_DETAILS= INSERT INTO RC_COM_VENDOR_DTL(AMAZON_ID,COMPANY_NAME,COMPANY_TYPE,DATE_OF_INCORPORATION,PARTERNER_DIRECTOR_NO,CONTACT_PERSON,CONTACT_NO,ALTERNATIVE_CONTACT_NO,CATEGORY,ADDRESS,STATE,CITY,PINCODE,VINTAGE,OWN_WAREHOUSE,OWN_OFFICE,DATE_FIRST_SALE,AMAZON_SALE,FILEDATA,ENTRY_DT,STATUS_FLAG,MODIFIED_DT,MODIFIED_BY,COMPANY_EMAIL_ID) VALUES(?,?,?,to_date(?, 'DD-MM-YYYY'),?,?,?,?,?,?,?,?,?,?,?,?,to_date(?, 'DD-MM-YYYY'),?,?,TRUNC(SYSDATE),?,TRUNC(SYSDATE),?,?)

#INSERT_VENDOR_DETAILS= INSERT INTO RC_COM_VENDOR_DTL_TMP(AMAZON_ID,COMPANY_NAME,COMPANY_TYPE,DATE_OF_INCORPORATION,PARTERNER_DIRECTOR_NO,CONTACT_PERSON,CONTACT_NO,ALTERNATIVE_CONTACT_NO,CATEGORY,ADDRESS,STATE,CITY,PINCODE,VINTAGE,OWN_WAREHOUSE,OWN_OFFICE,DATE_FIRST_SALE,AMAZON_SALE,FILE,ENTRY_DT,STATUS_FLAG,MODIFIED_DT) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,sysdate(),?,sysdate())

SELECT_COMPANY_TYPE = SELECT DISTINCT UPPER(COMPANY) AS COMPANY FROM RC_COM_COMPANY_MST WHERE ACTIVE_FLAG ='Y' ORDER BY COMPANY ASC

#INSERT_FILE = INSERT INTO fileDemo(name,filename) VALUES(?,?);

INSERT_VENDOR = INSERT INTO demo(amazon_id) values(?);

GET_AMAZON_ID = Select AMAZON_ID FROM RC_COM_VENDOR_DTL where AMAZON_ID=?

SELECT_ALL_YESAMAZON_FILE_UPLOAD_LOG = SELECT * FROM  YESAMAZON_FILE_UPLOAD_LOG WHERE AMAZON_ID=?

UPDATE_YESAMAZON_FILE_UPLOAD_LOG = UPDATE YESAMAZON_FILE_UPLOAD_LOG SET STATUS=? WHERE AMAZON_ID=? AND STATUS='U'

YESAMAZON_FILE_UPLOAD_LOG_SEQ = SELECT YESAMAZON_FILE_UPLOAD_LOG_SEQ.NEXTVAL FROM DUAL

YESAMAZON_FILE_UPLOAD_LOG_CHANGED_FILE_NAME = SELECT * FROM  YESAMAZON_FILE_UPLOAD_LOG WHERE AMAZON_ID=? AND CHANGED_FILE_NAME =?

UPDATE_YESAMAZON_FILE_UPLOAD_LOG1 = UPDATE YESAMAZON_FILE_UPLOAD_LOG SET STATUS=? WHERE AMAZON_ID=? AND CHANGED_FILE_NAME =?

INSERT_YESAMAZON_FILE_UPLOAD_LOG = INSERT INTO YESAMAZON_FILE_UPLOAD_LOG(UPLOAD_NO, AMAZON_ID, FILE_NAME, CHANGED_FILE_NAME, UPLOAD_DT, SOURCE_PATH,STATUS) VALUES (?, ?, ?, ?, sysdate, ?,?)
SELECT_MOBILE_NO_IS_EXIST=SELECT * FROM RC_COM_CUSTOMER_OTP_DTL WHERE MOBILE_NO=?
INSERT_OTP_MOBILE_NO=INSERT INTO RC_COM_CUSTOMER_OTP_DTL(MOBILE_NO, OTP) VALUES(?, ?)
UPDATE_OTP_IF_EXIST=UPDATE RC_COM_CUSTOMER_OTP_DTL SET OTP=? WHERE MOBILE_NO=?
SELECT_MOBILE_NO_OTP_EXIST=SELECT * FROM RC_COM_CUSTOMER_OTP_DTL WHERE MOBILE_NO=? AND OTP=?
DELETE_MOBILE_NO_OTP_EXIST=DELETE FROM RC_COM_CUSTOMER_OTP_DTL WHERE MOBILE_NO = ? AND OTP=?
INSERT_REQUEST_RESPONCE=INSERT INTO fileDemo(name,filename) VALUES(?,?)
SELECT_PINCODE_LIST=SELECT PINCODE FROM RC_COM_ADDRESS_MST WHERE UPPER(STATE)=? AND UPPER(CITY)=?
INSERTAMAZONID_SESSION_MAPPING=INSERT INTO YES_AMAZON_SESSION_ID_MAPPING(AMAZON_ID,SESSION_ID) VALUES (?,?)
SELECT_COUNT_FOR_AMAZONID=SELECT COUNT(*) FROM YES_AMAZON_SESSION_ID_MAPPING WHERE AMAZON_ID = ? AND SESSION_ID = ?



########## ACTIVITY LOG QUERY ##################
SELECT_FROM_SME_TRANSACTION_DTL_TABLE=SELECT TO_CHAR(TRAN_DATE, 'DD MON YYYY HH24:MI:SS'),CUSTOMER_ID,SOURCE_ACC_NO,TRAN_AMOUNT,AUTH_STATUS,MAKER_CD,TO_CHAR(MAKER_DT, 'DD MON YYYY HH24:MI:SS'),OPERATION_MODE,SERVICE_CD,TRAN_TYPE FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO = ?
SELECT_FROM_SME_TXN_APPROVAL_ACTIVITY_LOG=SELECT AUTH_CD,TO_CHAR(AUTH_DT, 'DD-MON-YYYY HH24:MI:SS'),IP_ADD_INFO,AUTH_ACTION FROM SME_TXN_APPROVAL_ACTIVITY_LOG WHERE TRAN_REF_NO = ? ORDER BY AUTH_DT
SELECT_FROM_SME_BULK_TRANSACTION_DTL=SELECT DISTINCT TRAN_REF_NO FROM SME_BULK_TRANSACTION_DTL WHERE AUTH_REF_NO = ?
SELECT_FROM_SME_SALARY_TRANSACTION_DTL=SELECT DISTINCT TRAN_REF_NO FROM SME_SALARY_TRANSACTION_DTL WHERE AUTH_REF_NO = ?
INSERT_INTO_SME_TXN_AUDIT_ACTIVITY_LOG=Insert into SME_TXN_AUDIT_ACTIVITY_LOG (AUDIT_LOG,SME_TXN_ID,INITIATED_ID,INITIATED_DT,APPROVER_ID_DT_DTL,MOP,LAST_APPROVER_ID,LAST_APPROVER_DT,AUTH_STATUS,TXN_TYPE,SERVICE_CD,SRC_ACCOUNT_NO,COMPANY_ID,CHANGED_ID,CHANGED_DT,TXN_DTL_SRC_TABLE_NAME,TXN_DTL_DST_TABLE_DTL,KEY_TXN_ID) values (TXN_AUDIT_LOG_SEQ.NEXTVAL,?,?,TO_DATE(?,'DD MON YYYY HH24:MI:SS'),?,?,?,TO_DATE(?,'DD MON YYYY HH24:MI:SS'),?,?,?,?,?,?,sysdate,?,?,?)
SELECT_FROM_SME_OPEN_SI_DTL=SELECT REFERENCE_NO FROM SME_OPEN_SI_DTL WHERE RES_REFERENCE_NO = ?
SELECT_FROM_SME_CREATE_FD_DTL=SELECT REFERENCE_NO FROM SME_CREATE_FD_DTL WHERE RES_RESFERENCE_NO = ?
SELECT_FROM_SME_SINGLE_TXN_MAKER_DTL=select REF_NO from SME_SINGLE_TXN_MAKER_DTL where RES_REF_NO = ?

################ For Scheduler ################
SELECT_AND_INSERT_FROM_SME_TXN_AUDIT_ACTIVITY_LOG_RESULTSET=INSERT INTO SME_TXN_AUDIT_ACTIVITY_LOG_HIS select * from SME_TXN_AUDIT_ACTIVITY_LOG where CHANGED_DT < sysdate -10
DELETE_FROM_SME_TXN_AUDIT_ACTIVITY_LOG=DELETE from SME_TXN_AUDIT_ACTIVITY_LOG where CHANGED_DT < sysdate -10

######### To check valid SME Customer or not from XREF Table ####################
#SELECT_COUNT_XREF_EXIST=select count(*) from vw_ch_acct_cust_xref where cod_cust = ? and cod_acct_cust_rel not in ('SOW','GUR','JOF','JOO','JAO','JAF','DEV','GUA','NOM','SOL','THR','VAL','COB','OTH','PAR','PRO')

#### Modified on 24092019 : For live change in SOW(multiple) Added by 2299  For AMC
SELECT_COUNT_XREF_EXIST=select count(*) from vw_ch_acct_cust_xref where cod_cust = ? AND COD_PROD NOT IN (404) AND cod_acct_cust_rel not in ('SOW','GUR','JOF','JOO','JAO','JAF','DEV','GUA','NOM','SOL','THR','VAL','COB','OTH','PAR','PRO')



###### tO CHECK aCCOUNT NUMBER FOR VALID CUSTOMER ADDED ON 15-01-2018 
#SELECT_COUNT_CUST_ACC_INAPPROVAL_MAPPING=SELECT COUNT(*) FROM COM_APPROVALMAPPING_MST WHERE SERVICECDID = ? AND ACCOUNT_NO = ?
#Add new Product code - 237 for version 7.9.0 on 11-04-2023
#Product code - 237 addition in Yes MSME
SELECT_COUNT_CUST_ACC_INAPPROVAL_MAPPING=SELECT DISTINCT(COD_ACCT_NO) AS ACCOUNT_NO FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST=? AND ((cod_prod between 501 and 599)  or (cod_prod between 901 and 999) or (cod_prod between 601 and 899) OR COD_PROD IN (207,208,237,204,210,240,236,249))
SELCT_COUNT_MAPPING_FOR_CUST_ACC_BENE=SELECT BENE_ACCOUNT_NO FROM SME_BENEFICIARY_DTL WHERE BENE_ID = ? AND CUSTOMER_ID = ? AND BENE_ADD_FLAG = 'Y' AND BENE_MODE IN ('A','U')

############ FOR SOW RESTRICTED ISSUE changed by prabhat 05-03-2018####################
SELECT_ACCOUNT_FOR_MAKER=select distinct ACCOUNT_NO from COM_APPROVALMAPPING_MST where SERVICECDID = ? and ACTIVE_FLAG = 'Y'


# -------------------- NewGen Integration --------------------#
#################### FOR GET RMID FOR NEWGEN ##############
SELECT_RM_ID=SELECT DISTINCT ASSET_RM,ASSET_RM_EMAILID FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID = ? AND ASSET_RM <> 0
INSERT_NEWGEN_AUDIT_TABLE=Insert into DOC_NEWGEN_SEND_ACTIVITY_LOG (REQUEST_ID,REQUEST_DT,REQUEST_STATUS,FOLDER_INDEX_NO,SERVICE_TYPE,SUCCESS_DT,ERROR_DTL) values (?,sysdate,?,null,?,null,'')
UPDATE_NEWGEN_AUDIT_TABLE1=UPDATE DOC_NEWGEN_SEND_ACTIVITY_LOG SET REQUEST_STATUS = ?, FOLDER_INDEX_NO = ? , ERROR_DTL = ? ,SUCCESS_DT = sysdate,PROCESS_ID = ? where REQUEST_ID = ?
UPDATE_NEWGEN_AUDIT_TABLE2=UPDATE DOC_NEWGEN_SEND_ACTIVITY_LOG SET REQUEST_STATUS = ? ,SUCCESS_DT = sysdate where REQUEST_ID = ?
UPDATE_NEWGEN_AUDIT_TABLE3=UPDATE DOC_NEWGEN_SEND_ACTIVITY_LOG SET REQUEST_STATUS = ? ,ERROR_DTL = ?,SUCCESS_DT = sysdate where REQUEST_ID = ?

################# Purging Activity #################
INSERT_ACTIVITY_LOG_RECORD_IN_HISTORY=insert into SME_TXN_AUDIT_ACTIVITY_LOG_HIS (select * from SME_TXN_AUDIT_ACTIVITY_LOG where CHANGED_DT < sysdate-?)
DELETE_ACTIVITY_LOG_FROM_MAIN=DELETE SME_TXN_AUDIT_ACTIVITY_LOG where CHANGED_DT < sysdate-?
INSERT_SME_TXN_APPROVAL_ACTIVITY_LOG_IN_HISTORY=insert into SME_TXN_APPRL_ACT_LOG_HIS (select * from SME_TXN_APPROVAL_ACTIVITY_LOG where AUTH_DT < sysdate-?)
DELETE_SME_TXN_APPROVAL_ACTIVITY_FROM_MAIN=DELETE SME_TXN_APPROVAL_ACTIVITY_LOG where AUTH_DT < sysdate-?
INSERT_SME_SERV_APP_ACTIVITY_LOG_HIS_IN_HISTORY=insert into SME_SERV_APP_ACTIVITY_LOG_HIS (select * from SME_SERV_APP_ACTIVITY_LOG where REQUESTED_DT < sysdate-?)
DELETE_SME_SERV_APP_ACTIVITY_LOG_FROM_MAIN=DELETE SME_SERV_APP_ACTIVITY_LOG where REQUESTED_DT < sysdate-? 

################# CUSTOMER-SERVICE_ACCESS MASTER added by prabhat 30-03-2018 ###############
SELECT_SERVICE_CODE_FOR_ACCESS_CUSTOMER=SELECT SERVICE_CD FROM COM_SERVICE_MST WHERE SERVICE_TYPE IN (WITH T AS (SELECT GROUP_SERVICE_CODE STR FROM SME_SERVICE_ACCESS_MST WHERE CUSTOMER_ID = ? AND ACTIVE_FLAG  = 'Y') SELECT REGEXP_SUBSTR (STR, '[^|]+', 1, LEVEL) SPLIT_VALUES  FROM T CONNECT BY LEVEL <= (SELECT LENGTH (REPLACE (STR, '|', NULL)) FROM T)) AND ACTIVE_FLAG = 'Y'

################### IP ADDRESS INSERTION added by prabhat 04-04-2018 ##############
SELECT_IPADDRESS_COUNT=select count(*) from SME_CUSTOMER_IP_ADDRESS_DTL where CUSTOMER_IP = ?
INSERT_CUSTOMER_IPADDRESS=insert into SME_CUSTOMER_IP_ADDRESS_DTL (CUSTOMER_IP,IP_ADDRESS,REQUEST_MODE) values(?,?,?)
UPDATE_CUTOMER_IPADDRESS=update SME_CUSTOMER_IP_ADDRESS_DTL set IP_ADDRESS = ?,REQUEST_MODE = ? where CUSTOMER_IP = ?


###################### ALL INTIATED-APPROVAL ACTIVITY LOG #################
INSERT_INTO_SME_SERV_APP_ACTIVITY_LOG=INSERT INTO SME_SERV_APP_ACTIVITY_LOG (SER_REF_NO,REQUESTED_ID,REQUESTED_DT,REQUEST_ACTION,REQUEST_SER_CD,IP_ADDRESS,ID,SERVICED_TABLE) values(?,?,sysdate,?,?,?,SME_SERV_APP_ACTIVITY_LOG_SEQ.nextval,?)

############ Check Customer deactivate flag ###############
SELECT_DEACTIVATE_CUSTOMER_LIST=SELECT CUSTOMER_ID FROM SME_CUST_DEACTIVATE_MASTER WHERE COMPANY_ID = ? AND ACTIVE_FLAG = 'Y' AND DE_ACTIVATE_FLAG = 'A'

############################# FETCH BENE BULK DATA added by Neha 19-04-2018 ###################
SELECT_BENEFICIARY_BULK_FILE_PLIST=select MAKER_ID,TO_CHAR(MAKER_DT, 'DD MON YYYY HH24:MI:SS'),FILE_NAME,FILE_PATH,REMARK,REF_NO,RECORD_NO from SME_BENEFICIARY_BULK_DTL_TMP where CUSTOMER_ID=? AND FLAG_TYPE=?
SELECT_BULK_BENE_COUNT=SELECT COUNT(*) FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE CUSTOMER_ID = ? AND FLAG_TYPE = ?
CHECK_BENE_BULK_FT_INITIATE_STATUS= SELECT COUNT(*) FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE REF_NO = ? 
ALL_SINGLE_BENE_BULK_FILE_APPROVAL_REJECT= UPDATE SME_BENEFICIARY_BULK_DTL_TMP SET CUSTOMER_ID=?,CUSTOMER_DT=sysdate,FLAG_TYPE=? ,REMARK=? WHERE REF_NO = ?
ALL_SINGLE_BENE_BULK_FILE_APPROVAL=INSERT INTO SME_BENEFICIARY_BULK_DTL (MAKER_ID,MAKER_DT,FILE_NAME,FILE_PATH,REMARK,REF_NO,RECORD_NO,CUSTOMER_ID,CUSTOMER_DT,FLAG_TYPE) VALUES (?,to_date(?,'DD MON YYYY HH24:MI:SS') ,? ,?, ?, ?,?, ?,sysdate,?)
SELECT_BENE_BULK_FT= SELECT MAKER_ID,TO_CHAR(MAKER_DT, 'DD MON YYYY HH24:MI:SS'),CUSTOMER_ID,CUSTOMER_DT,FILE_NAME,FILE_PATH,FLAG_TYPE,REMARK,REF_NO,RECORD_NO FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE REF_NO = ?
SELECT_BENE_BULK_FT_MST= SELECT * FROM SME_BENEFICIARY_BULK_DTL WHERE REF_NO = ?
DELETE_SME_BENEFICIARY_BULK_DTL_SINGLE= DELETE FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE REF_NO = ?
INSERT_BENE_FILE_DTL=Insert into SME_BENEFICIARY_BULK_DTL (MAKER_ID,MAKER_DT,CUSTOMER_ID,CUSTOMER_DT,FILE_NAME,FILE_PATH,FLAG_TYPE,REMARK,REF_NO,RECORD_NO) values (?,sysdate,?,sysdate,?,?,?,?,?,?)
INSERT_BENE_FILE_DTL_TMP=Insert into SME_BENEFICIARY_BULK_DTL_TMP (MAKER_ID,MAKER_DT,CUSTOMER_ID,CUSTOMER_DT,FILE_NAME,FILE_PATH,FLAG_TYPE,REMARK,REF_NO,RECORD_NO) values (?,sysdate,?,null,?,?,?,?,?,?)

############################# FETCH BENE BULK DATA added by Neha 23-04-2018 ###################
INSERT_INTO_SME_UPLOAD_FILE_TRN_RESULT=insert into SME_UPLOAD_FILE_TRN_RESULT (REFERENCE_NO,ACTION_DONE,SRN,BENEID,REF_NO_SME_BENE_DTL) VALUES (?,?,?,?,?)
SELECT_ALL_SINGLE_GST_TXN_COUNT=SELECT COUNT(*) FROM SME_SINGLE_TXN_MAKER_DTL WHERE COMPANY_ID = ? AND APPROVE_STATUS = ? AND SERVICECD = ?
#// Group Payment Verification CR by 2459 on 03-04-2023
SELECT_GST_FOR_PLIST=SELECT REF_NO,FROM_ACC,BENE_NAME,AMOUNT,TO_CHAR( MAKE_DT, 'DD-MON-YYYY HH24:MI:SS'),MAKER_ID,TRANSFER_TYPE,REMARKS,BENE_IFSC,TO_ACC from SME_SINGLE_TXN_MAKER_DTL where APPROVE_STATUS = 'I' and COMPANY_ID = ? AND SERVICECD = ?
ALL_SINGLE_GST_REJECT=UPDATE SME_SINGLE_TXN_MAKER_DTL SET APP_REJ_DT = sysdate , APPROVE_STATUS=? ,REMARKS=? , APPROVER_ID=? WHERE REF_NO = ?
CHECK_GST_DATA= SELECT COUNT(*) FROM SME_SINGLE_TXN_MAKER_DTL WHERE REF_NO = ? and APPROVE_STATUS <> 'R'
SELECT_GST_DATA=SELECT * FROM SME_SINGLE_TXN_MAKER_DTL WHERE REF_NO = ?
ALL_SINGLE_GST_INSERT_APPROVAL = INSERT INTO SME_TRANSACTION_DTL (TRAN_REF_NO,TRAN_DATE,CUSTOMER_ID,SOURCE_ACC_NO,DEST_ACC_NO,TRAN_AMOUNT,REMARKS,AUTH_STATUS,MAKER_CD,MAKER_DT,OPERATION_MODE,REQ_APPROVER_SCORE,BAL_APPROVER_SCORE,BENE_NAME,BENE_NICKNAME,BENE_IFSC_CD,SERVICE_CD,BANK_NAME,TRAN_TYPE,MOBILE_NO) VALUES (? ,sysdate, ? , ? , ? , ?, ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? )

######################### CheckStatus Query ###############################
                 ####### dOCUMENT UPLOAD ##############
SELECT_SERVICE_CODE_FROM_MST=SELECT DISTINCT SERVICE_CD,SERVICE_DESC FROM COM_SERVICE_MST WHERE SERVICE_TYPE = ? AND ACTIVE_FLAG = 'Y'
SELECT_REQ_ID_DOC_DTL=select REQ_ID from CUST_DOC_UPLOAD_DETAILS where SERVER_UPLOAD_TIME BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and CUSTOMER_ID = ? order by REQ_ID desc
#select REQ_ID from CUST_DOC_UPLOAD_DETAILS where  to_char(UPLOAD_DATE,'dd/MM/yyyy') BETWEEN to_char(?,'dd/MM/yyyy') and to_char(?,'dd/MM/yyyy') and CUSTOMER_ID = ? order by REQ_ID desc
SELECT_DOCUMENT_UPLOAD_STATUS=SELECT CUSTOMER_ID,DOC_CAT,DOC_TYPE,DOC_ID,PURPOSE,REMARKS,BROWSE_FILE_NAME,DECODE(UPLOAD_STATUS,'M','Approved','I','Pending','Rejected'),MAKER_ID,DECODE(MAKER_STATUS,'A','Approved','R','Rejected','I','Initiated'),TO_CHAR(UPLOAD_DATE, 'DD MON YYYY HH24:MI:SS'),TO_CHAR(SERVER_UPLOAD_TIME, 'DD MON YYYY HH24:MI:SS'),REQ_ID FROM CUST_DOC_UPLOAD_DETAILS WHERE REQ_ID IN (


SELECT_DOCUMENT_NAME_TYPE_STATUS=SELECT R3.CATEGORY_NAME,R2.TYPE_NAME,R1.DOC_NAME FROM  RC_COM_DOC_NAME R1,  RC_COM_DOC_TYPE R2,  RC_COM_DOC_CATEGORY_MST R3 WHERE R3.CATEGORY_ID  = ? AND R2.TYPE_ID=?  AND R1.DOC_CODE_NAME  = ?

                  ########### OWN ACCOUNT STATUS ##########
SELECT_SERVICE_CODE_FROM_ONSCREEN_MAKER_TABLE=SELECT SME_TXN_ID FROM SME_TXN_AUDIT_ACTIVITY_LOG WHERE INITIATED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND SERVICE_CD = ? AND SRC_ACCOUNT_NO = ? ORDER BY INITIATED_DT DESC
SELECT_SERVICE_CODE_FROM_ONSCREEN_MAKERONLY_TABLE=SELECT SME_TXN_ID FROM SME_TXN_AUDIT_ACTIVITY_LOG WHERE INITIATED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND SERVICE_CD = ? AND SRC_ACCOUNT_NO = ? AND INITIATED_ID = ? ORDER BY INITIATED_DT DESC
#SELECT_ONSCREEN_DTL=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),R7.MAKER_CD,NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),DECODE(R11.MOP,'O','Any One','J','Joint'),R11.LAST_APPROVER_ID,R11.COMPANY_ID,R7.TRAN_AMOUNT, R11.APPROVER_ID_DT_DTL,R11.SRC_ACCOUNT_NO,R7.BENE_NAME,R7.BENE_NICKNAME,R7.BENE_IFSC_CD,R7.DEST_ACC_NO,R11.TXN_TYPE,DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'),R7.BENE_IFSC_CD,R7.MOBILE_NO,R11.SME_TXN_ID,R6.REFERENCE_NO from SME_TRANSACTION_DTL R7,SME_TXN_AUDIT_ACTIVITY_LOG R11, SME_SINGLE_TXN_REF_DTL R6 where R11.SME_TXN_ID=? AND R7.TRAN_REF_NO=? AND R6.REQ_TXN_NO=? ORDER BY R11.LAST_APPROVER_DT DESC
############### Added by prabhat on 12 july 2018 ######################
SELECT_ONSCREEN_DTL=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),R7.MAKER_CD,NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),DECODE(R11.MOP,'O','Any One','J','Joint'),R11.LAST_APPROVER_ID,R11.COMPANY_ID,R7.TRAN_AMOUNT,R11.APPROVER_ID_DT_DTL,R11.SRC_ACCOUNT_NO,R7.BENE_NAME,R7.BENE_NICKNAME,R7.BENE_IFSC_CD,R7.DEST_ACC_NO,R11.TXN_TYPE,DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'),R7.BENE_IFSC_CD,R7.MOBILE_NO,R11.SME_TXN_ID FROM SME_TRANSACTION_DTL R7,SME_TXN_AUDIT_ACTIVITY_LOG R11 WHERE R11.SME_TXN_ID=? AND R7.TRAN_REF_NO  =? ORDER BY R11.LAST_APPROVER_DT DESC
SELECT_REF_NO_ONSCREEN=SELECT REFERENCE_NO,ERROR_DTL FROM SME_SINGLE_TXN_REF_DTL WHERE REQ_TXN_NO = ?       
SELECT_REJECTED_DTL_FROM_ONSCREEN_MAKER=SELECT REF_NO FROM SME_SINGLE_TXN_MAKER_DTL WHERE  MAKE_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND SERVICECD = ? AND APPROVER_ID IN (?) AND APPROVE_STATUS IN ('R') AND FROM_ACC = ? order by MAKE_DT desc
SELECT_REJECT_DTL_ONSCREEN_MAKER=SELECT BENEID,BENE_IFSC,BENE_NAME,MOBILE_NO,AMOUNT,FROM_ACC,TO_ACC,MAKER_ID,NVL(TO_CHAR( MAKE_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),APPROVER_ID,NVL(TO_CHAR( APP_REJ_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),REMARKS,TRANSFER_TYPE,REF_NO FROM SME_SINGLE_TXN_MAKER_DTL WHERE REF_NO IN (

####################Add By 2233 On Non-Financial ##########################
SELECT_SER_REF_NO_FROM_SMEBENEFICIARYDTL_TABLE=select REFERENCE_NO from SME_BENEFICIARY_DTL where BENE_ADD_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  and BENE_MODE = ? and  BENE_TYPE <> 'SAL' AND CUSTOMER_ID = ? order by BENE_ADD_DT desc
SELECT_SER_REF_NO_FROM_SMEBENEFICIARYDTL_EMP_TABLE=select REFERENCE_NO from SME_BENEFICIARY_DTL where BENE_ADD_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  and BENE_MODE = ? and  BENE_TYPE = 'SAL' AND CUSTOMER_ID       =  ? order by BENE_ADD_DT desc
SELECT_REJECT_DTL_NONTRANSACTION_SMEBENEFICIARYDTL_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,    R1.MAKER_ID AS MAKER_ID,    R1.BENE_ID AS BENE_ID,    R1.BENE_TRANSFER_TYPE AS BENE_TRANSFER_TYPE,    R1.BENE_ACCOUNT_NO AS BENE_ACCOUNT_NO,    R2.REQUESTED_ID AS REQUESTED_ID,    R1.BENE_EMAIL_ID AS BENE_EMAIL_ID,    R1.BENE_MOBILE_NO AS BENE_MOBILE_NO,    R1.BENE_IFSC AS BENE_IFSC,    R1.BENE_DESC AS BENE_DESC,    R1.BENE_MODE AS BENE_MODE,    R1.RES_ERROR_CODE AS RES_ERROR_CODE ,R1.RES_ERROR_MSG AS RES_ERROR_MSG , DECODE(R2.REQUEST_ACTION,'R','Rejected','A','Approved','U','Approved','D','Approved') AS REQUEST_ACTION,    NVL(TO_CHAR( R1.BENE_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA') AS BENE_ADD_DT ,R1.REFERENCE_NO AS REFERENCE_NO,R1.BENE_ADDED_AMT AS BENE_ADDED_AMT FROM SME_BENEFICIARY_DTL_TMP R1  FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2  ON R1.REFERENCE_NO = R2.SER_REF_NO  WHERE R2.REQUEST_ACTION = 'R'   AND R1.REFERENCE_NO = ? AND R2.SER_REF_NO= ? AND R2.REQUESTED_ID = ? AND R1.BENE_MODE  = ? AND R1.BENE_TYPE  <> 'SAL' ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECT_DTL_NONTRANSACTION_SMEBENEFICIARYDTL_EMP_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,    R1.MAKER_ID AS MAKER_ID,    R1.BENE_ID AS BENE_ID,    R1.BENE_TRANSFER_TYPE AS BENE_TRANSFER_TYPE,    R1.BENE_ACCOUNT_NO AS BENE_ACCOUNT_NO,    R2.REQUESTED_ID AS REQUESTED_ID,    R1.BENE_EMAIL_ID AS BENE_EMAIL_ID,    R1.BENE_MOBILE_NO AS BENE_MOBILE_NO,    R1.BENE_IFSC AS BENE_IFSC,    R1.BENE_DESC AS BENE_DESC,    R1.BENE_MODE AS BENE_MODE,    R1.RES_ERROR_CODE AS RES_ERROR_CODE ,R1.RES_ERROR_MSG AS RES_ERROR_MSG , DECODE(R2.REQUEST_ACTION,'R','Rejected','A','Approved','U','Approved','D','Approved') AS REQUEST_ACTION,    NVL(TO_CHAR( R1.BENE_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA') AS BENE_ADD_DT ,R1.REFERENCE_NO AS REFERENCE_NO,R1.BENE_ADDED_AMT AS BENE_ADDED_AMT FROM SME_BENEFICIARY_DTL_TMP R1  FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2  ON R1.REFERENCE_NO = R2.SER_REF_NO  WHERE R2.REQUEST_ACTION = 'R'   AND R1.REFERENCE_NO = ? AND R2.SER_REF_NO= ? AND R2.REQUESTED_ID = ? AND R1.BENE_MODE  = ? AND R1.BENE_TYPE  = 'SAL'  ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECTED_DTL_FROM_SMEBENEFICIARYDTL_MAKER=SELECT SER_REF_NO FROM SME_SERV_APP_ACTIVITY_LOG WHERE REQUESTED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND REQUESTED_ID = ? AND REQUEST_ACTION  = 'R' order by REQUESTED_DT desc
SELECT_NONTRANSACTION_SMEBENEFICIARYDTL_DTL=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,   R1.MAKER_ID AS MAKER_ID,   R1.BENE_ID AS BENE_ID,   R1.BENE_TRANSFER_TYPE AS BENE_TRANSFER_TYPE,   R1.BENE_ACCOUNT_NO AS BENE_ACCOUNT_NO,   R2.REQUESTED_ID AS REQUESTED_ID,   R1.BENE_EMAIL_ID AS BENE_EMAIL_ID,   R1.BENE_MOBILE_NO AS BENE_MOBILE_NO,   R1.BENE_IFSC AS BENE_IFSC,   R1.BENE_DESC AS BENE_DESC, R1.RES_REFERENCE_NO AS RES_REFERENCE_NO,  R1.BENE_MODE AS BENE_MODE,   DECODE(R2.REQUEST_ACTION,'R','Rejected','A','Approved','D','Approved','U','Approved') AS REQUEST_ACTION,   NVL(TO_CHAR( R1.BENE_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA') AS BENE_ADD_DT,R1.BENE_ADDED_AMT AS BENE_ADDED_AMT FROM SME_BENEFICIARY_DTL R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REFERENCE_NO = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = ?   AND R1.REFERENCE_NO = ? AND R2.SER_REF_NO= ? ORDER BY R2.REQUESTED_DT DESC
SELECT_SER_REF_NO_FROM_SMEGROUPBENEDTL_TABLE=SELECT DISTINCT REF_NO FROM SME_GROUP_BENE_DTL WHERE GROUP_MOD_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND GROUP_MODE = ? AND CUSTOMER_ID = ? AND BENE_ADD_STATUS_M = 'A' ORDER BY REF_NO DESC
SELECT_REJECTED_DTL_FROM_SMEGROUPBENEDTL_MAKER=SELECT DISTINCT SER_REF_NO FROM SME_SERV_APP_ACTIVITY_LOG WHERE REQUESTED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND REQUESTED_ID       = ? AND REQUEST_ACTION = 'R' ORDER BY SER_REF_NO DESC
SELECT_NONTRANSACTION_SMEGROUPBENEDTL_DTL=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,  R1.MAKER_ID  AS MAKER_ID,  R1.BENE_ID   AS BENE_ID,R1.BENE_DTL AS BENE_DTL, R1.GROUP_ID  AS GROUP_ID,  DECODE(R2.REQUEST_ACTION,'R','Rejected','N','Approved','M','Approved','D','Approved','A','Approved') AS REQUEST_ACTION,  NVL(TO_CHAR( R1.GROUP_MK_DATE, 'DD-MON-YYYY HH24:MI:SS'),'NA')  AS GROUP_MK_DATE, R2.REQUESTED_ID AS REQUESTED_ID FROM SME_GROUP_BENE_DTL R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO  = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = ?  AND R1.REF_NO = ? AND R2.SER_REF_NO = ? ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECT_DTL_NONTRANSACTION_SMEGROUPBENEDTL_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,  R1.MAKER_ID  AS MAKER_ID,R1.CUSTOMER_ID AS CUSTOMER_ID,  R1.BENE_ID   AS BENE_ID, R1.GROUP_ID  AS GROUP_ID,  DECODE(R2.REQUEST_ACTION,'R','Rejected','N','Approved','M','Approved','D','Approved','A','Approved') AS REQUEST_ACTION,  NVL(TO_CHAR( R1.GROUP_MK_DATE, 'DD-MON-YYYY HH24:MI:SS'),'NA')  AS GROUP_MK_DATE, R2.REQUESTED_ID AS REQUESTED_ID FROM SME_GROUP_BENE_DTL_TMP R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO  = R2.SER_REF_NO WHERE R1.REF_NO = ? AND R2.REQUESTED_ID  = ? AND R1.GROUP_MODE     = ? AND R2.REQUEST_SER_CD = ? ORDER BY R2.REQUESTED_DT DESC

####################Add By 04052018 On SAL-Financial ##########################
SELECT_REFNO_FROM_SAL_TXT_TABLE=select SME_TXN_ID from SME_TXN_AUDIT_ACTIVITY_LOG WHERE INITIATED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and SERVICE_CD = ? AND SRC_ACCOUNT_NO = ?  AND ( AUTH_STATUS  = 'A' OR AUTH_STATUS  = 'R' ) order by INITIATED_DT desc
#SELECT_FROM_SAL_TXT_DTL=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),  R7.MAKER_CD, NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), DECODE(R11.MOP,'O','Any One','J','Joint'), R11.LAST_APPROVER_ID, R11.COMPANY_ID, R7.TRAN_AMOUNT, R11.APPROVER_ID_DT_DTL, R11.SRC_ACCOUNT_NO, R6.ADDED_BENE_DTL, R7.BENE_NICKNAME, R7.BENE_IFSC_CD, R7.DEST_ACC_NO, R11.TXN_TYPE, DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'), R7.BENE_IFSC_CD, R7.MOBILE_NO, R6.GROUP_ID, R8.REFERENCE_NO FROM SME_TRANSACTION_DTL R7, SME_TXN_AUDIT_ACTIVITY_LOG R11, SME_BULK_TRANSACTION_DTL R6, SME_BULK_API_TXN_REF_DTL R8 WHERE R11.SME_TXN_ID=? AND R7.TRAN_REF_NO  =? AND R6.AUTH_REF_NO  =? AND R11.SERVICE_CD  =? ORDER BY R11.LAST_APPROVER_DT DESC
###updated by 2299 for limit consumption issue
#SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),R7.MAKER_CD,NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), DECODE(R11.MOP,'O','Any One','J','Joint'),R11.LAST_APPROVER_ID,R11.COMPANY_ID,R7.TRAN_AMOUNT,R11.APPROVER_ID_DT_DTL,R11.SRC_ACCOUNT_NO,R6.ADDED_BENE_DTL,R7.BENE_NICKNAME,R7.BENE_IFSC_CD,R7.DEST_ACC_NO,R11.TXN_TYPE,DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'),R7.BENE_IFSC_CD,R7.MOBILE_NO,R6.GROUP_ID,R8.REFERENCE_NO,R6.TOTAL_PAY_AMT FROM SME_TRANSACTION_DTL R7,SME_TXN_AUDIT_ACTIVITY_LOG R11,SME_BULK_TRANSACTION_DTL R6,SME_BULK_API_TXN_REF_DTL R8 WHERE R11.SME_TXN_ID=? AND R7.TRAN_REF_NO  =? AND R6.AUTH_REF_NO  =? AND R8.BULK_TXN_NO = (select R6.TRAN_REF_NO from SME_BULK_TRANSACTION_DTL R6 where R6.AUTH_REF_NO  =?) AND R11.SERVICE_CD  =? ORDER BY R11.LAST_APPROVER_DT DESC
SELECT_FROM_SAL_TXT_DTL_IN_API=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),R7.MAKER_CD,NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), DECODE(R11.MOP,'O','Any One','J','Joint'),R11.LAST_APPROVER_ID,R11.COMPANY_ID,R7.TRAN_AMOUNT,R11.APPROVER_ID_DT_DTL,R11.SRC_ACCOUNT_NO,R6.ADDED_BENE_DTL,R7.BENE_NICKNAME,R7.BENE_IFSC_CD,R7.DEST_ACC_NO,R11.TXN_TYPE,DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'),R7.BENE_IFSC_CD,R7.MOBILE_NO,R6.GROUP_ID,R8.REFERENCE_NO,R6.TOTAL_PAY_AMT FROM SME_TRANSACTION_DTL R7,SME_TXN_AUDIT_ACTIVITY_LOG R11,SME_BULK_TRANSACTION_DTL R6,SME_BULK_API_TXN_REF_DTL R8 WHERE R11.SME_TXN_ID=? AND R7.TRAN_REF_NO  =? AND R6.AUTH_REF_NO  =? AND R8.BULK_TXN_NO = (select R6.TRAN_REF_NO from SME_BULK_TRANSACTION_DTL R6 where R6.AUTH_REF_NO  =?) AND R11.SERVICE_CD  =? ORDER BY R11.LAST_APPROVER_DT DESC
SELECT_FROM_SAL_TXT_DTL_NOT_IN_API=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),  R7.MAKER_CD, NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), DECODE(R11.MOP,'O','Any One','J','Joint'), R11.LAST_APPROVER_ID, R11.COMPANY_ID, R7.TRAN_AMOUNT, R11.APPROVER_ID_DT_DTL, R11.SRC_ACCOUNT_NO, R6.ADDED_BENE_DTL, R7.BENE_NICKNAME, R7.BENE_IFSC_CD, R7.DEST_ACC_NO, R11.TXN_TYPE, DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'), R7.BENE_IFSC_CD, R7.MOBILE_NO, R6.GROUP_ID, R8.REFERENCE_NO,R6.TOTAL_PAY_AMT FROM SME_TRANSACTION_DTL R7, SME_TXN_AUDIT_ACTIVITY_LOG R11, SME_BULK_TRANSACTION_DTL R6, SME_BULK_API_TXN_REF_DTL R8 WHERE R11.SME_TXN_ID=? AND R7.TRAN_REF_NO  =? AND R6.AUTH_REF_NO  =? AND R11.SERVICE_CD  =? ORDER BY R11.LAST_APPROVER_DT DESC
#SELECT_FROM_SAL_TXT_DTL_SL00=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),    R7.MAKER_CD,  NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),  DECODE(R11.MOP,'O','Any One','J','Joint'),  R11.LAST_APPROVER_ID,  R11.COMPANY_ID,  R7.TRAN_AMOUNT,  R11.APPROVER_ID_DT_DTL,  R11.SRC_ACCOUNT_NO,  R7.BENE_NICKNAME,  R7.BENE_IFSC_CD,  R7.DEST_ACC_NO,  R11.TXN_TYPE,  DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'),  R7.BENE_IFSC_CD,  R7.MOBILE_NO FROM SME_TRANSACTION_DTL R7,  SME_TXN_AUDIT_ACTIVITY_LOG R11,WHERE R11.SME_TXN_ID=?AND R7.TRAN_REF_NO  =?AND R11.SERVICE_CD  = ?ORDER BY R11.LAST_APPROVER_DT DESC
#SELECT_FROM_SAL_TXT_DTL_SL00=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),    R7.MAKER_CD,  NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),  DECODE(R11.MOP,'O','Any One','J','Joint'),  R11.LAST_APPROVER_ID,  R11.COMPANY_ID,  R7.TRAN_AMOUNT,  R11.APPROVER_ID_DT_DTL,  R11.SRC_ACCOUNT_NO,  R7.BENE_NICKNAME,  R7.BENE_IFSC_CD,  R7.DEST_ACC_NO,  R11.TXN_TYPE,  DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'),  R7.BENE_IFSC_CD,  R7.MOBILE_NO FROM SME_TRANSACTION_DTL R7,  SME_TXN_AUDIT_ACTIVITY_LOG R11,WHERE R11.SME_TXN_ID=?AND R7.TRAN_REF_NO  =?AND R11.SERVICE_CD  = ?ORDER BY R11.LAST_APPROVER_DT DESC
SELECT_FROM_SAL_TXT_DTL_SL00=SELECT NVL(TO_CHAR( R11.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), R7.MAKER_CD, NVL(TO_CHAR( R7.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), DECODE(R11.MOP,'O','Any One','J','Joint'), R11.LAST_APPROVER_ID, R11.COMPANY_ID, R7.TRAN_AMOUNT, R11.APPROVER_ID_DT_DTL, R11.SRC_ACCOUNT_NO, R6.BENE_DTL, R7.BENE_NICKNAME, R7.BENE_IFSC_CD, R7.DEST_ACC_NO, R11.TXN_TYPE, DECODE(R11.AUTH_STATUS,'R','Rejected','A','Approved'), R7.BENE_IFSC_CD, R7.MOBILE_NO,R6.TOTAL_EMP AS EMP_NUM,R6.TOTAL_AMT FROM SME_TRANSACTION_DTL R7, SME_TXN_AUDIT_ACTIVITY_LOG R11, SME_SALARY_TRANSACTION_DTL R6 WHERE R11.SME_TXN_ID=? AND R7.TRAN_REF_NO  =? AND R6.AUTH_REF_NO  =? AND R11.SERVICE_CD  = ?  ORDER BY R11.LAST_APPROVER_DT DESC

######################### CheckStatus Query for Maker 12-06-2018 2273###############################
SELECT_REQ_ID_DOC_DTL_FOR_MAKER=select REQ_ID from CUST_DOC_UPLOAD_DETAILS where SERVER_UPLOAD_TIME BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND MAKER_ID = ? AND ( MAKER_STATUS = 'A' OR MAKER_STATUS    = 'R' ) order by REQ_ID desc
SELECT_REJECTED_DTL_FROM_ONSCREEN_MAKER_FOR_MAKER=SELECT REF_NO FROM SME_SINGLE_TXN_MAKER_DTL WHERE  MAKE_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND SERVICECD = ? AND MAKER_ID = ?  AND APPROVE_STATUS IN ('R') AND FROM_ACC = ? order by MAKE_DT desc
SELECT_SER_REF_NO_FROM_SMEBENEFICIARYDTL_TABLE_FOR_MAKER=select REFERENCE_NO from SME_BENEFICIARY_DTL where BENE_ADD_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  and BENE_MODE = ? and  BENE_TYPE <> 'SAL' AND MAKER_ID = ? order by BENE_ADD_DT desc
SELECT_SER_REF_NO_FROM_SME_BENEFICIARY_BULK_DTL_TABLE_FOR_MAKER=select REF_NO from SME_BENEFICIARY_BULK_DTL where CUSTOMER_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND MAKER_ID=? order by CUSTOMER_DT desc
SELECT_SER_REF_NO_FROM_SMEBENEFICIARYDTL_EMP_TABLE_FOR_MAKER=select REFERENCE_NO from SME_BENEFICIARY_DTL where BENE_ADD_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  and BENE_MODE = ? and  BENE_TYPE = 'SAL' AND MAKER_ID =  ? order by BENE_ADD_DT desc
SELECT_SER_REF_NO_FROM_SMEGROUPBENEDTL_TABLE_FOR_MAKER=SELECT DISTINCT REF_NO FROM SME_GROUP_BENE_DTL WHERE BENE_MOD_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND GROUP_MODE = ? AND MAKER_ID = ? AND BENE_ADD_STATUS_M = 'A' ORDER BY REF_NO DESC


##################################CheckStatus Query for Maker 20-06-2018 2273#####################################
SELECT_REFNO_FROM_SAL_TXN_TABLEFOR_MAKER=SELECT SER_REF_NO FROM SME_SERV_APP_ACTIVITY_LOG WHERE REQUESTED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND REQUEST_SER_CD   = ? AND ( REQUEST_ACTION = 'A' OR REQUEST_ACTION    = 'R' ) ORDER BY REQUESTED_DT DESC
#SELECT_FROM_BT_TXN__FOR_MAKER=SELECT NVL(TO_CHAR(R1.INITIATED_DATE_TIME, 'DD-MON-YYYY HH24:MI:SS'),'NA'),NVL(TO_CHAR(R1.TRANSACTION_DATE_TIME, 'DD-MON-YYYY HH24:MI:SS'),'NA'), R1.TOTAL_PAY_AMT, R1.MAKER_ID, R1.SOURCE_ACCOUNT_NO, R1.GRP_TRANS_TYPE, R1.CUSTOMER_ID, R1.ADDED_BENE_DTL, DECODE(R1.MAKER_STATUS,'R','Rejected','A','Approved'), R1.GROUP_ID FROM SME_BULK_TRANSACTION_DTL R1, SME_BULK_API_TXN_REF_DTL R2 WHERE R1.TRAN_REF_NO     =? AND R1.SOURCE_ACCOUNT_NO =? AND R1.MAKER_ID          =? ORDER BY R1.INITIATED_DATE_TIME DESC
#SELECT_FROM_BT_TXN__FOR_MAKER=SELECT NVL(TO_CHAR(R1.INITIATED_DATE_TIME, 'DD-MON-YYYY HH24:MI:SS'),'NA'), NVL(TO_CHAR(R2.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), R1.TOTAL_PAY_AMT, R1.MAKER_ID, R1.SOURCE_ACCOUNT_NO, R1.GRP_TRANS_TYPE, R1.CUSTOMER_ID, R1.ADDED_BENE_DTL, DECODE(R1.MAKER_STATUS,'R','Rejected','A','Approved'), R1.GROUP_ID, R1.GRP_TRANS_TYPE AS TXN_TYPE FROM SME_BULK_TRANSACTION_DTL R1 FULL OUTER JOIN SME_TXN_AUDIT_ACTIVITY_LOG R2 ON R1.TRAN_REF_NO = R2.KEY_TXN_ID WHERE R1.TRAN_REF_NO =? AND R1.SOURCE_ACCOUNT_NO =? AND R1.MAKER_ID =? AND R2.SERVICE_CD =? ORDER BY R1.INITIATED_DATE_TIME DESC
#--Updated by 2299 for limit consumption change-transaction summary
SELECT_FROM_BT_TXN__FOR_MAKER=SELECT NVL(TO_CHAR(R1.INITIATED_DATE_TIME, 'DD-MON-YYYY HH24:MI:SS'),'NA'),NVL(TO_CHAR(R2.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),R1.TOTAL_PAY_AMT,R1.MAKER_ID,R1.SOURCE_ACCOUNT_NO,R1.GRP_TRANS_TYPE,R1.CUSTOMER_ID,R1.ADDED_BENE_DTL,DECODE(R2.AUTH_STATUS,'R','Rejected','A','Approved'),R1.GROUP_ID,R1.GRP_TRANS_TYPE AS TXN_TYPE,R3.TRAN_AMOUNT FROM SME_BULK_TRANSACTION_DTL R1 FULL OUTER JOIN SME_TXN_AUDIT_ACTIVITY_LOG R2 ON R2.KEY_TXN_ID = R1.TRAN_REF_NO FULL OUTER JOIN SME_TRANSACTION_DTL R3 ON R3.TRAN_REF_NO = R1.AUTH_REF_NO WHERE R1.TRAN_REF_NO=? AND R1.SOURCE_ACCOUNT_NO =? AND R1.MAKER_ID=? AND R2.SERVICE_CD=? ORDER BY R1.INITIATED_DATE_TIME DESC

#SELECT_FROM_SAL_TXN_FOR_MAKER=SELECT NVL(TO_CHAR(R1.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), NVL(TO_CHAR(R2.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), R1.TOTAL_AMT, R1.MAKERID, R1.SOURCE_ACCOUNT_NO, R1.TXN_TRANSFER_TYPE, R1.CUSTOMER_ID, R1.BENE_DTL, DECODE(R1.MAKER_STATUS,'R','Rejected','A','Approved'),R1.TOTAL_EMP AS EMP_NUM,R1.TXN_TRANSFER_TYPE AS TXN_TYPE FROM SME_SALARY_TRANSACTION_DTL R1 full outer JOIN SME_TXN_AUDIT_ACTIVITY_LOG R2 on R1.TRAN_REF_NO = R2.KEY_TXN_ID WHERE R1.TRAN_REF_NO     =? AND R1.SOURCE_ACCOUNT_NO =? AND R1.MAKERID =?  AND R2.SERVICE_CD = ? ORDER BY R1.INITIATED_DATE_TIME DESC
#SELECT_FROM_SAL_TXN_FOR_MAKER=SELECT NVL(TO_CHAR(R1.INITIATED_DATE_TIME, 'DD-MON-YYYY HH24:MI:SS'),'NA'), NVL(TO_CHAR(R1.TRANSACTION_DATE_TIME, 'DD-MON-YYYY HH24:MI:SS'),'NA'), R1.TOTAL_AMT, R1.MAKERID, R1.SOURCE_ACCOUNT_NO, R1.TXN_TRANSFER_TYPE, R1.CUSTOMER_ID, R1.BENE_DTL, DECODE(R1.MAKER_STATUS,'R','Rejected','A','Approved'),R1.TOTAL_EMP AS EMP_NUM FROM SME_SALARY_TRANSACTION_DTL R1, SME_SINGLE_TXN_REF_DTL R2 WHERE R1.TRAN_REF_NO     =? AND R1.SOURCE_ACCOUNT_NO =? AND R1.MAKERID           =?  ORDER BY R1.INITIATED_DATE_TIME DESC
###### updated by 2299 for limit consumption change- transaction summary
SELECT_FROM_SAL_TXN_FOR_MAKER=SELECT NVL(TO_CHAR(R1.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),NVL(TO_CHAR(R2.LAST_APPROVER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),R1.TOTAL_AMT,R1.MAKERID,R1.SOURCE_ACCOUNT_NO,R1.TXN_TRANSFER_TYPE,R1.CUSTOMER_ID,R1.BENE_DTL,DECODE(R2.AUTH_STATUS,'R','Rejected','A','Approved'),R1.TOTAL_EMP AS EMP_NUM,R1.TXN_TRANSFER_TYPE AS TXN_TYPE,R3.TRAN_AMOUNT FROM SME_SALARY_TRANSACTION_DTL R1, SME_TXN_AUDIT_ACTIVITY_LOG R2, SME_TRANSACTION_DTL R3 WHERE R1.TRAN_REF_NO = R2.KEY_TXN_ID AND R3.TRAN_REF_NO = R1.AUTH_REF_NO AND R1.TRAN_REF_NO =? AND R1.SOURCE_ACCOUNT_NO =? AND R1.MAKERID =? AND R2.SERVICE_CD = ? ORDER BY R1.INITIATED_DATE_TIME DESC
SELECT_REJECTED_DTL_FOR_SI_FOR_MAKER=SELECT REFERENCE_NO FROM SME_OPEN_SI_DTL WHERE SI_ADD_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND MAKER_ID        = ? AND SI_ADD_STATUS IN ('R') AND SOURCE_ACCOUNT_NO        = ? ORDER BY SI_ADD_DT DESC
SELECT_SI00_DTL=SELECT S1.CUSTOMER_ID,S1.CREDIT_AMT, NVL(TO_CHAR(S1.SI_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),S1.SI_ADD_STATUS,S1.RES_ERROR_MSG,S1.SOURCE_ACCOUNT_NO,S1.BENE_ACCOUNT_NO,S1.MAKER_ID, NVL(TO_CHAR(S2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA') FROM SME_OPEN_SI_DTL S1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG S2 ON S2.SER_REF_NO = S1.REFERENCE_NO WHERE S2.REQUEST_SER_CD  = 'SI00' AND S2.SER_REF_NO = ? AND S2.REQUEST_ACTION   IN ('R') AND S1.SOURCE_ACCOUNT_NO = ? ORDER BY S1.SI_ADD_DT DESC
SELECT_REJECTED_BENE_BULK_MAKER=SELECT REF_NO FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE MAKER_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND MAKER_ID   = ? AND FLAG_TYPE = 'R' ORDER BY MAKER_DT DESC

########### Added by 2157 for rejected record from checker on 19 july 2018 ###########
SELECT_REJECTED_BENE_BULK_CHECKER=SELECT REF_NO FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE CUSTOMER_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND CUSTOMER_ID   = ? AND FLAG_TYPE = 'R' ORDER BY CUSTOMER_DT DESC
SELECT_DTL_BENE_BULK_MAKER=SELECT TO_CHAR(R1.CUSTOMER_DT, 'DD-MON-YYYY HH24:MI:SS'), R1.MAKER_ID, R1.FILE_NAME, R1.REMARK, R1.RECORD_NO, DECODE(R1.FLAG_TYPE,'R','Rejected','N','Approved','M','Approved','D','Approved'), NVL(TO_CHAR( R1.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'), R2.REQUESTED_ID,R1.CUSTOMER_ID FROM SME_BENEFICIARY_BULK_DTL_TMP R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO            = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = 'I' AND R1.REF_NO = ? AND R2.SER_REF_NO = ? AND R1.MAKER_ID = ? AND R1.FLAG_TYPE = 'R' AND R2.REQUEST_SER_CD = 'SB03' ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECTED_DTL_FOR_GROUP_MAKER=SELECT DISTINCT R1.SER_REF_NO FROM SME_SERV_APP_ACTIVITY_LOG R1,SME_GROUP_BENE_DTL_TMP R2 WHERE REQUESTED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND R1.REQUESTED_ID   = ? AND R1.REQUEST_ACTION = 'I' AND R2.BENE_ADD_STATUS_M = 'R' AND R1.REQUEST_SER_CD=? AND R2.REF_NO=R1.SER_REF_NO ORDER BY SER_REF_NO DESC
SELECT_NONTRANSACTION_SMEGROUPBENEDTL_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT, R1.MAKER_ID AS MAKER_ID, R1.BENE_ID AS BENE_ID, R1.BENE_DTL AS BENE_DTL, R1.GROUP_ID AS GROUP_ID, DECODE(R1.GROUP_MODE,'R','Rejected','N','Approved','M','Approved','D','Approved') AS REQUEST_ACTION, NVL(TO_CHAR( R1.GROUP_MK_DATE, 'DD-MON-YYYY HH24:MI:SS'),'NA') AS GROUP_MK_DATE, R2.REQUESTED_ID AS REQUESTED_ID ,R1.CUSTOMER_ID AS CUSTOMER_ID FROM SME_GROUP_BENE_DTL R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO  = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = 'I' AND R2.REQUESTED_ID =? AND R1.REF_NO =? AND R2.SER_REF_NO =? ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECT_DTL_NONTRANSACTION_SMEGROUPBENEDTL_MAKER_DELETE=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,  R1.MAKER_ID  AS MAKER_ID,  R1.BENE_ID   AS BENE_ID, R1.GROUP_ID  AS GROUP_ID,  DECODE(R2.REQUEST_ACTION,'R','Rejected','N','Approved','M','Approved','D','Approved') AS REQUEST_ACTION,  NVL(TO_CHAR( R1.GROUP_MK_DATE, 'DD-MON-YYYY HH24:MI:SS'),'NA')  AS GROUP_MK_DATE, R2.REQUESTED_ID AS REQUESTED_ID,R1.CUSTOMER_ID AS CUSTOMER_ID FROM SME_GROUP_BENE_DTL_TMP R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO  = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = 'R'  AND R1.REF_NO = ? AND R2.SER_REF_NO = ? AND R1.MAKER_ID     = ? AND R1.GROUP_MODE     = ? ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECTED_DTL_FOR_BENE_MAKER=SELECT SER_REF_NO FROM SME_SERV_APP_ACTIVITY_LOG WHERE REQUESTED_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND REQUESTED_ID   = ? AND REQUEST_ACTION = 'I' AND REQUEST_SER_CD = ? ORDER BY REQUESTED_DT DESC
SELECT_REJECTED_BENE_DTL_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT, R1.MAKER_ID AS MAKER_ID, R1.BENE_ID AS BENE_ID, R1.BENE_TRANSFER_TYPE AS BENE_TRANSFER_TYPE, R1.BENE_ACCOUNT_NO AS BENE_ACCOUNT_NO, R2.REQUESTED_ID AS REQUESTED_ID, R1.BENE_EMAIL_ID AS BENE_EMAIL_ID, R1.BENE_MOBILE_NO AS BENE_MOBILE_NO, R1.BENE_IFSC AS BENE_IFSC, R1.BENE_DESC AS BENE_DESC, R1.BENE_MODE AS BENE_MODE, R1.RES_ERROR_CODE AS RES_ERROR_CODE, R1.RES_ERROR_MSG AS RES_ERROR_MSG ,DECODE(R2.REQUEST_ACTION,'R','Rejected','A','Approved','U','Approved','D','Approved') AS REQUEST_ACTION, NVL(TO_CHAR( R1.BENE_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA') AS BENE_ADD_DT ,R1.REFERENCE_NO AS REFERENCE_NO,R1.BENE_ADDED_AMT AS BENE_ADDED_AMT FROM SME_BENEFICIARY_DTL_TMP R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REFERENCE_NO  = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = 'R' AND R1.REFERENCE_NO = ? AND R2.SER_REF_NO = ? AND R1.MAKER_ID = ? AND R1.BENE_MODE = ? AND R1.BENE_TYPE  <> 'SAL' ORDER BY R2.REQUESTED_DT DESC
SELECT_REJECTED_EMP_DTL_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT, R1.MAKER_ID AS MAKER_ID, R1.BENE_ID AS BENE_ID, R1.BENE_TRANSFER_TYPE AS BENE_TRANSFER_TYPE, R1.BENE_ACCOUNT_NO AS BENE_ACCOUNT_NO, R2.REQUESTED_ID AS REQUESTED_ID, R1.BENE_EMAIL_ID AS BENE_EMAIL_ID, R1.BENE_MOBILE_NO AS BENE_MOBILE_NO, R1.BENE_IFSC AS BENE_IFSC, R1.BENE_DESC AS BENE_DESC, R1.BENE_MODE AS BENE_MODE, R1.RES_ERROR_CODE AS RES_ERROR_CODE ,R1.RES_ERROR_MSG AS RES_ERROR_MSG ,DECODE(R2.REQUEST_ACTION,'R','Rejected','A','Approved','U','Approved','D','Approved') AS REQUEST_ACTION, NVL(TO_CHAR( R1.BENE_ADD_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA') AS BENE_ADD_DT ,R1.REFERENCE_NO AS REFERENCE_NO,R1.BENE_ADDED_AMT AS BENE_ADDED_AMT FROM SME_BENEFICIARY_DTL_TMP R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2  ON R1.REFERENCE_NO = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = 'R' AND R1.REFERENCE_NO = ? AND R2.SER_REF_NO = ? AND R1.MAKER_ID = ? AND R1.BENE_MODE = ? AND R1.BENE_TYPE  = 'SAL'  ORDER BY R2.REQUESTED_DT DESC
FIND_DATE=SELECT TO_CHAR( REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT FROM SME_SERV_APP_ACTIVITY_LOG WHERE REQUESTED_ID=? AND SER_REF_NO=? 

##################### Added by 2157 0n 13-07-2018 for SI rejected case from Checker #########################
SELECT_REJECTED_DTL_FOR_SI_FOR_CHECKER=SELECT REFERENCE_NO FROM SME_OPEN_SI_DTL WHERE SI_ADD_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND CUSTOMER_ID = ? AND SI_ADD_STATUS IN ('R') AND SOURCE_ACCOUNT_NO        = ? ORDER BY SI_ADD_DT DESC

################### Added by 2157 on 14-05-2018 for bulk bene upload ##############
SELECT_SER_REF_NO_FROM_SME_BENEFICIARY_BULK_DTL_TABLE=select REF_NO from SME_BENEFICIARY_BULK_DTL where CUSTOMER_DT BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') and TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND CUSTOMER_ID=? order by CUSTOMER_DT desc
SELECT_REJECT_DTL_NONTRANSACTION_SMEBULKBENEDTL_MAKER=SELECT TO_CHAR(R2.REQUESTED_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,  R1.MAKER_ID  AS MAKER_ID,  R1.FILE_NAME   AS FILE_NAME, R1.REMARK  AS REMARK, R1.RECORD_NO  AS RECORD_NO, DECODE(R2.REQUEST_ACTION,'R','Rejected','N','Approved','M','Approved','D','Approved') AS REQUEST_ACTION,  NVL(TO_CHAR( R1.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA')  AS MAKER_DT, R2.REQUESTED_ID AS REQUESTED_ID,R1.CUSTOMER_ID AS CUSTOMER_ID FROM SME_BENEFICIARY_BULK_DTL_TMP R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO  = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = 'R'  AND R1.REF_NO = ? AND R2.SER_REF_NO = ? AND R2.REQUESTED_ID  = ? AND R1.FLAG_TYPE = 'R' ORDER BY R2.REQUESTED_DT DESC
SELECT_NONTRANSACTION_SMEBULKBENEDTL_DTL=SELECT TO_CHAR(R1.CUSTOMER_DT, 'DD-MON-YYYY HH24:MI:SS') AS REQUESTED_DT,  R1.MAKER_ID  AS MAKER_ID,  R1.FILE_NAME   AS FILE_NAME, R1.REMARK  AS REMARK, R1.RECORD_NO  AS RECORD_NO, DECODE(R2.REQUEST_ACTION,'R','Rejected','A','Approved','M','Approved','D','Approved') AS REQUEST_ACTION,  NVL(TO_CHAR( R1.MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA')  AS MAKER_DT, R2.REQUESTED_ID AS REQUESTED_ID FROM SME_BENEFICIARY_BULK_DTL R1 FULL OUTER JOIN SME_SERV_APP_ACTIVITY_LOG R2 ON R1.REF_NO  = R2.SER_REF_NO WHERE R2.REQUEST_ACTION = ?  AND R1.REF_NO = ? AND R2.SER_REF_NO = ? ORDER BY R1.CUSTOMER_DT DESC
         
####################### aDDED BY 2157 FOR SINGLE FILE UPLOAD PDF ON 22 JULY 2018 ###################
SELECT_BULK_TRANSACTION_DTL_FOR_SINGLE_REQ=SELECT TRAN_REF_NO,ADDED_BENE_DTL,GROUP_ID,GRP_TRANS_TYPE FROM SME_BULK_TRANSACTION_DTL WHERE AUTH_REF_NO = ? 
#SELECT_REF_DTL_FROM_SME_BULK_API_TXN_REF_DTL=SELECT BENE_ID,REFERENCE_NO FROM SME_BULK_API_TXN_REF_DTL WHERE BULK_TXN_NO = ?       
##### Updated by 2299 for Limit consumption change (API rejection) #######
##Added 2418 for bulk upload issue on 25-11-22
SELECT_REF_DTL_FROM_SME_BULK_API_TXN_REF_DTL=SELECT REFERENCE_NO,ERROR_DTL,TXN_SR_NO FROM SME_BULK_API_TXN_REF_DTL WHERE BULK_TXN_NO =? ORDER BY TO_NUMBER(TXN_SR_NO)   
####
SELECT_REF_DTL_FROM_SME_BULK_API_TXN_REF_DTL_DESC=SELECT REFERENCE_NO,ERROR_DTL FROM SME_BULK_API_TXN_REF_DTL WHERE BULK_TXN_NO =?     
SELECT_SAL_TRANSACTION_DTL_FOR_SINGLE_REQ=SELECT TRAN_REF_NO,BENE_DTL,SALARY_TRANSFER_TYPE,TXN_TRANSFER_TYPE FROM SME_SALARY_TRANSACTION_DTL WHERE AUTH_REF_NO = ?         
#SELECT_REF_DTL_FROM_SME_SALARY_API_TXN_REF_DTL=SELECT EMPLOYEE_ID,REFERENCE_NO FROM SME_SALARY_API_TXN_REF_DTL WHERE SALARY_TXN_NO = ?
##### Updated by 2299 for Limit consumption change (API rejection) #######
##Added 2440 for salary upload issue on 06-12-22
SELECT_REF_DTL_FROM_SME_SALARY_API_TXN_REF_DTL=SELECT REFERENCE_NO,ERROR_DTL,TXN_SR_NO FROM SME_SALARY_API_TXN_REF_DTL WHERE SALARY_TXN_NO =? ORDER BY TO_NUMBER(TXN_SR_NO)
##
SELECT_FILE_PATH_FROM_REFERENCE=SELECT FILE_PATH FROM SME_BENEFICIARY_BULK_DTL WHERE REF_NO = ?   
SELECT_REF_DTL_FROM_SME_UPLOAD_FILE_TRN_RESULT=SELECT SRN,ACTION_DONE,BENEID FROM SME_UPLOAD_FILE_TRN_RESULT WHERE REFERENCE_NO = ?    
SELECT_FILE_PATH_FROM_REFERENCE_FOR_REJECT=SELECT FILE_PATH FROM SME_BENEFICIARY_BULK_DTL_TMP WHERE REF_NO = ?
         
####################### aDDED BY 2157 FOR SINGLE FILE UPLOAD PDF ON 12 JULY 2018 ###################
SELECT_BULK_TRANSACTION_DTL_FOR_SINGLE_REQ_FOR_MAKER=SELECT TRAN_REF_NO,ADDED_BENE_DTL,GROUP_ID,GRP_TRANS_TYPE FROM SME_BULK_TRANSACTION_DTL WHERE TRAN_REF_NO = ? 
SELECT_SAL_TRANSACTION_DTL_FOR_SINGLE_REQ_FOR_MAKER=SELECT TRAN_REF_NO,BENE_DTL,SALARY_TRANSFER_TYPE,TXN_TRANSFER_TYPE FROM SME_SALARY_TRANSACTION_DTL WHERE TRAN_REF_NO = ?

################### Added by 2273 on 17-05-2018 for forgot password ##############
UPDATE_FORGOT_PASS_FLAG=UPDATE COM_MAKER_MST SET TOKEN=?, INTIATED_TIME=sysdate, FORGO_PASS_FLAG='F' WHERE MAKER_ALIAS_NAME = ? AND ACTIVE_FLAG = 'Y'
SELECT_TOKEN_FORGOT_PASS=SELECT COUNT(*),MAKER_ALIAS_NAME,TO_CHAR(INTIATED_TIME, 'yyyy-MM-dd HH24:MI:SS') AS INTIATED_TIME,CNT_MAKER_HIT FROM COM_MAKER_MST WHERE TOKEN=? AND FORGO_PASS_FLAG=? AND ACTIVE_FLAG = 'Y' GROUP BY MAKER_ALIAS_NAME,INTIATED_TIME,CNT_MAKER_HIT

################### Added by 2273 on 17-05-2018 for forgot password ##############
UPDATE_FORGOTTED_PASSWORD=UPDATE COM_MAKER_MST  SET PASSWORD=? , FORGO_PASS_FLAG='N' WHERE TOKEN=? AND MAKER_ALIAS_NAME=? AND ACTIVE_FLAG = 'Y'
UPDATE_FORGOTTED_PASSWORD_LOGIN_INFO=UPDATE SME_APP_LOGIN_INFO  SET PASSWORD=? , LOGIN_COUNT='0' ,USER_LOCKED='N' ,FIRST_LOGIN='N' WHERE LOGIN_ID=?
CHECK_FIRST_TIME_LOGIN =SELECT FIRST_LOGIN FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID=?
DELETE_GROUP_BENE_DTL_TMP= DELETE FROM SME_GROUP_BENE_DTL_TMP where GROUP_ID=? AND REF_NO=?

################### Added by 2273 on 06-06-2018 for forgot password ##############
LINK_HIT_FORGOT_PASS_FLAG=SELECT CNT_MAKER_HIT,TO_CHAR(INTIATED_TIME, 'dd/MM/yyyy') AS INTIATED_TIME FROM COM_MAKER_MST WHERE MAKER_ALIAS_NAME = ? AND ACTIVE_FLAG = 'Y'
RESET_PASS_REQ=UPDATE COM_MAKER_MST SET CNT_MAKER_HIT=? WHERE MAKER_ALIAS_NAME=? AND ACTIVE_FLAG = 'Y'
CHECK_CHANGE_PASSWORD=SELECT COUNT(*) FROM COM_MAKER_MST WHERE PASSWORD=? AND TOKEN=? AND MAKER_ALIAS_NAME=? AND ACTIVE_FLAG = 'Y' AND FORGO_PASS_FLAG='C' 
CHECK_BEFORE_FORGO_PASS=SELECT c.MAKER_ALIAS_NAME,c.CNT_MAKER_HIT,s.FIRST_LOGIN FROM COM_MAKER_MST c , SME_APP_LOGIN_INFO s WHERE c.MAKER_ALIAS_NAME=? AND c.FORGO_PASS_FLAG='F' AND c.ACTIVE_FLAG = 'Y' AND c.MAKER_ALIAS_NAME=s.LOGIN_ID GROUP BY c.MAKER_ALIAS_NAME,c.CNT_MAKER_HIT,s.FIRST_LOGIN
UPDATE_FORGOTTED_PASSWORD_LOGIN_INFO_CHANGE=UPDATE SME_APP_LOGIN_INFO  SET PASSWORD=? , LOGIN_COUNT='0' ,USER_LOCKED='N' ,FIRST_LOGIN='N' WHERE LOGIN_ID=?         
UPDATE_FORGOT_PASS_FLAG_CNT=UPDATE COM_MAKER_MST SET INTIATED_TIME=sysdate ,CNT_MAKER_HIT='5' WHERE MAKER_ALIAS_NAME = ? AND ACTIVE_FLAG = 'Y'
CHECK_FORGO_PASSWORD=SELECT INTIATED_TIME FROM COM_MAKER_MST WHERE TOKEN=? AND MAKER_ALIAS_NAME=? AND ACTIVE_FLAG = 'Y' AND FORGO_PASS_FLAG='F'

############### // Added by Prabhat for Live issue raised by YBL on Subject - RE: Issues on Production. 08-08-2018
CHECK_SERVICE_EXIST_IN_APPROVAL_TABLE=SELECT COUNT(*) FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO =? AND SERVICE_CD = ? AND APPROVER_LIST LIKE ? AND ACTIVE_FLAG = 'Y'

#################### // Added by Prabhat for Third Registration on 31-08-2018 ######################
#CHECK_MOBILE_EMAIL_VALIADTE=SELECT COUNT(*) FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID = ? AND REF_CUST_TELEX = ? AND LOWER(REF_CUST_EMAIL) = ?
CHECK_MOBILE_EMAIL_VALIADTE=SELECT COUNT(*) FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID = ? AND REF_CUST_TELEX = ? AND UPPER(REF_CUST_EMAIL) = UPPER(?)
CHECK_PAN_DOB_VALIDATE=select COUNT(*) from COM_RNB_USER_MST where RNBID = ? and RNB_USER_STATUS = 'A' AND PAN_NO = ? AND DOB = ?
INSERT_INTO_SME_CUST_INFO_MAIL_OTP_TABLE=Insert into SME_CUST_INFO_MAIL_OTP (CUSTOMER_ID,EMAIL_OTP_KEY,EMAIL_OTP_VALUE,EMAIL_TRIGGERED_DT) values (?,?,?,sysdate)
UPDATE_INTO_SME_CUST_INFO_MAIL_OTP_TABLE=update SME_CUST_INFO_MAIL_OTP set EMAIL_OTP_KEY = ?, EMAIL_OTP_VALUE = ?, EMAIL_TRIGGERED_DT = sysdate where CUSTOMER_ID = ?
SELECT_CUSTOMER_EXIST_TABLE_SME_CUST_INFO_MAIL_OTP=select count(*) from SME_CUST_INFO_MAIL_OTP where CUSTOMER_ID = ?
SLECET_EMAIL_OTP_VERITY_SME_CUST_INFO_MAIL_OTP=SELECT EMAIL_OTP_VALUE FROM SME_CUST_INFO_MAIL_OTP WHERE EMAIL_OTP_KEY= ? AND CUSTOMER_ID= ? 



############### // Added by Prabhat for Audit for CUstomer navigation for 23-10-2018
ADD_LOGIN_ADDED_SEQUENCE=UPDATE SME_APP_LOGIN_INFO SET LOGIN_ADDED_ID = LOGIN_ADDED_SEQ.NEXTVAL WHERE LOGIN_ID = ?
SELECT_LOGIN_DTL_DATA=select LOGIN_ADDED_ID,USER_TYPE from SME_APP_LOGIN_INFO where LOGIN_ID = ?
SELECT_LOGIN_IP_DTL_DATA=select IP_ADDRESS,REQUEST_MODE from SME_CUSTOMER_IP_ADDRESS_DTL where CUSTOMER_IP = ? 
SELECT_LAST_UPDATED_SEQ=select max(NEXT_CHANGED_SEQ) from SME_USER_INTERFACE_SERVICE_DTL where LOGIN_ACTIVE_ID = ?
INSERT_USER_AUDIT_DTL=Insert into SME_USER_INTERFACE_SERVICE_DTL (NEXT_CHANGED_SEQ,SERVICE_NAME,LOGIN_TYPE,LOGIN_VIA_FLAG,ERROR_EXIST_FLAG,IP_ADDRESS,LOGIN_ACTIVE_ID,NAVIGATE_DT,CUSTOMER_ID) values (?,?,?,?,?,?,?,sysdate,?)   
    
############### // Added by Prabhat for Online OD for 08-11-2018    
SELECT_ACTIVE_OFFER_ID=select ID,TEMPLATE_NAME,FORMAT_NAME,TO_CHAR(OFFER_START_DT, 'DD-MON-YYYY'),TO_CHAR(OFFER_END_DT, 'DD-MON-YYYY'),MCLR_APP_PER from SME_ONLINE_OD_OFFER_MST where OFFER_START_DT <= sysdate and OFFER_END_DT >= sysdate and ACTIVE_FLAG = 'Y'   
SELECT_CUSTOMER_DETAILS_FROM_OFFER=select CUSTOMER_ID,BORROWER_NAME,CONSTITUTION,INDUSTRY,ACCOUNT_NUMBER,BRN_CODE,LOAN_AMOUNT,RATE,PF,PS from SME_ONLINE_OD_OFFER_CUST_DTL where OFFER_MST_ID = ? and ACTIVE_FLAG = 'Y' and CUSTOMER_ID = ?
SELECT_EMAIL_TEMP_DTL=select TEMPLATE_ID,SUBJECT_PART,PURPOSE_CODE,VARIABLE_DETAILES,EMAIL_BODY_START,EMAIL_BODY_MAIN,EMAIL_BODY_END,VARIABLE_SIZE from SME_EMAILTEMPLATE_MST where PURPOSE_CODE = ? and ACTIVE_FLAG = 'Y'
SELECT_TEMPLATE_DTL=select TEMPLATE_VARIABLE_NO,UPLOAD_FILE_NAME from SME_TEMPLATE_MTN_MST where TEMPLATE_NAME = ? and ACTIVE_FLAG = 'Y'
SELECT_FORMAT_TEMP_DTL=select VARIABLE_COUNT,SUBJECT_PART,PURPOSE_CODE,VARIABLE_DETAILES,EMAIL_BODY_START,EMAIL_BODY_MAIN,EMAIL_BODY_END from SME_FORMAT_MTN_MST where PURPOSE_CODE=? and ACTIVE_FLAG = 'Y'
SELECT_CUSTOMER_DETAILS=SELECT COD_CUST_ID,   NVL(NAM_CUST_FULL,'NA')      AS NAM_CUST_FULL,   NVL(REF_CUST_TELEX,'NA')     AS REF_CUST_TELEX,   NVL(REF_CUST_EMAIL,'NA')     AS REF_CUST_EMAIL,   NVL(SERVICE_RM,'NA')         AS SERVICE_RM,   NVL(ASSET_RM,0)              AS ASSET_RM,   NVL(SERVICE_RM_EMAILID,'NA') AS SERVICE_RM_EMAILID,   NVL(SERVICE_RM_MOB,'NA')     AS SERVICE_RM_MOB,   NVL(ASSET_RM_MOB,'NA')       AS ASSET_RM_MOB,   NVL(ASSET_RM_EMAILID,'NA')   AS ASSET_RM_EMAILID,       NVL(txt_custadr_add1,'NA')   AS ADD1,    NVL(txt_custadr_add2,'NA')   AS ADD2,    NVL(txt_custadr_add3,'NA')   AS ADD3,    NVL(nam_custadr_city,'NA')   AS CITY,    NVL(nam_custadr_state,'NA')   AS STATE,    NVL(nam_custadr_cntry,'NA')   AS COUNTRY,    NVL(txt_custadr_zip,'NA')   AS ZIPCODE        FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID IN (?,?)
INSERT_SET_LEVEL_NAVIGATE_CUST_FOR_OD=Insert into SME_ONLINE_OD_CUST_NAV_DTL (CUST_NAV_ID,CUSTOMER_ID,OFFER_MST_ID,OD_LEVEL_0_FLAG,OD_LEVEL_0_DT,COMPANY_ID) values (?,?,?,?,sysdate,?)
SELECT_NAV_SEQ_NEXTVAL=SELECT SME_ONLINE_OD_CUST_NAV_DTL_SEQ.NEXTVAL FROM DUAL
UPDATE_CUSTOMER_DETAILS_FROM_OFFER=UPDATE SME_ONLINE_OD_OFFER_CUST_DTL SET ACTIVE_FLAG=? WHERE CUSTOMER_ID=? AND OFFER_MST_ID = ?
SELECT_ACCOUNT_FROM_OFFER_TABLE=select ACCOUNT_NUMBER from SME_ONLINE_OD_OFFER_CUST_DTL where CUSTOMER_ID=? AND OFFER_MST_ID = ?
UPDATE_LEVEL_NAVIGATE_CUST_FOR_OD=update SME_ONLINE_OD_CUST_NAV_DTL set OD_LEVEL_2_FLAG = ?, OD_LEVEL2_DT = sysdate where CUST_NAV_ID = ?
UPDATE_LEVEL_NAVIGATE_CUST_FOR_OD_DOWN1=update SME_ONLINE_OD_CUST_NAV_DTL set DOWNLOAD_MITC_FLAG = ?, DOWNLOAD_MITC_DT = sysdate where CUST_NAV_ID = ?
UPDATE_LEVEL_NAVIGATE_CUST_FOR_OD_DOWN2=update SME_ONLINE_OD_CUST_NAV_DTL set DOWNLOAD_WELCOME_LETTER_FLAG = ?, DOWNLOAD_WEL_LETTER_DT = sysdate where CUST_NAV_ID = ?
SELECT_INTERESTCODE_FROM_MCLR=select INTEREST_INDEX_CODE from SME_MCLR_DTL where RESET_RATES in (?,?) and APPLICABILITY_PERIOD=?
INSERT_INTO_SME_ONLINE_OD_GEFU_DTL=Insert into SME_ONLINE_OD_GEFU_DTL (OD_TRACK_ID,GEFU_JSON_DATA,GEFU_DTL_ENTRY_INITIATED_DT) values (?,?,sysdate)
UPDATE_SME_ONLINE_OD_GEFU_DTL_EXPIRY=update SME_ONLINE_OD_OFFER_CUST_DTL set LIMIT_EXPIRY_DT=to_date(?, 'YYYYMMDD') where OFFER_MST_ID = ? and CUSTOMER_ID = ?
DELETE_NOTIFICATION_ENTRY_FOR_OD=delete NOTIFICATION where CUSTOMER_ID in (SELECT COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO =?) and MODULE_NAME='ONLINEOD'
DELETE_OFFER_ENTRY_FOR_OD=delete OFFER where CUSTOMER_ID in (SELECT COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO =?) and MODULE_NAME='ONLINEOD'
SELECT_LIST_OF_CUSTOMER_XREF=SELECT COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO =?
SELECT_TRACKER_ID_FOR_GEFU_CREATION=select OD_TRACK_ID,GEFU_JSON_DATA,GEFU_DTL_ENTRY_INITIATED_DT from SME_ONLINE_OD_GEFU_DTL where IS_LIMIT_GEFU_EXIT = ?
UPDATE_LIMIT_GEFU_DTL=update SME_ONLINE_OD_GEFU_DTL set LIMIT_SETUP_GEFU = ? ,LIMIT_SETUP_DT = sysdate ,LIMIT_SETUP_GEFU_FILENAME = ?, IS_LIMIT_GEFU_EXIT = ? where OD_TRACK_ID = ? 
SELECT_BA_BANK_MAST_DATE=select to_char(DAT_PROCESS,'YYYYMMDD') from VW_FCR_DT
SELECT_CUSTOMER_ID_FOR_PS_GEFU=select CUST_NAV_ID,CUSTOMER_ID from SME_ONLINE_OD_CUST_NAV_DTL where CUST_NAV_ID in (select OD_TRACK_ID from SME_ONLINE_OD_GEFU_DTL where IS_LIMIT_GEFU_EXIT = 'Y' and IS_PF_GEFU_EXIT = 'N' and IS_PS_GEFU_EXIT = 'N')
UPDATE_PS_GEFU_DTL=update SME_ONLINE_OD_GEFU_DTL set LIMIT_PS_INITIATED_DT  = sysdate , LIMIT_PS_FILENAME  = ?, IS_PS_GEFU_EXIT = ? where OD_TRACK_ID = ?
UPDATE_MITC_WELETTER_FILEPATH_DTL=update SME_ONLINE_OD_CUST_NAV_DTL set MITC_DOC_FILE_NAME = ?, WELCOME_LETTER_FILE_NAME = ? where CUST_NAV_ID = ?
CHECK_OD_LIMIT_EXIST_ON_VIEW=SELECT count(*) FROM vw_ch_od_limit WHERE cod_acct_no IN (select COD_ACCT_NO from VW_CH_ACCT_CUST_XREF where COD_CUST = ?) AND dat_limit_end >= (select DAT_PROCESS from VW_FCR_DT)

#Added by Prabhat for simulteneously checking of customer login for offer 31-01-2019
SELECT_COUNT_FOR_ACTIVE_COMPANY=SELECT COUNT(*),TO_char(REQUESTED_DT,'DD-MON-YYYY HH24:MI:SS'),CUSTOMER_ID FROM SME_ONLINE_SESSION_DTL WHERE COMPANY_ID = ? AND IS_HOLD_FLAG = ? group by REQUESTED_DT,CUSTOMER_ID
DELETE_ENTRY_OF_CUSTOMER=DELETE SME_ONLINE_SESSION_DTL WHERE COMPANY_ID = ? AND CUSTOMER_ID = ?
INSERT_INTO_SME_ONLINE_SESSION_DTL=Insert into SME_ONLINE_SESSION_DTL (COMPANY_ID,IS_HOLD_FLAG,REQUESTED_DT,CUSTOMER_ID) values (?,'A',sysdate,?)
UPDATE_SME_ONLINE_SESSION_DTL=UPDATE SME_ONLINE_SESSION_DTL SET IS_HOLD_FLAG = 'A',REQUESTED_DT = sysdate where COMPANY_ID = ? AND CUSTOMER_ID = ?
SELECT_CUSTOMER_EXIST_ON_NVL_DTL=select CUST_NAV_ID from SME_ONLINE_OD_CUST_NAV_DTL where CUSTOMER_ID = ? AND OFFER_MST_ID = ?
UPDATE_CUSTOMER_NAV_DTL1=UPDATE SME_ONLINE_OD_CUST_NAV_DTL SET OD_LEVEL_1_FLAG=?, OD_LEVEL_1_DT = SYSDATE, OD_LEVEL_1_NAV_DTL = ? WHERE CUST_NAV_ID = ? AND CUSTOMER_ID = ?
UPDATE_SME_ONLINE_OD_CUST_NAV_DTL_L0=UPDATE SME_ONLINE_OD_CUST_NAV_DTL SET OD_LEVEL_0_FLAG = ? ,OD_LEVEL_0_DT = sysdate,OD_LEVEL_1_FLAG = 'N',OD_LEVEL_1_DT = null,OD_LEVEL_1_NAV_DTL = null,OD_LEVEL_2_FLAG='D',OD_LEVEL2_DT=null WHERE OFFER_MST_ID = ? AND CUSTOMER_ID = ?
UPDATE_SME_ONLINE_OD_CUST_NAV_DTL_L1=UPDATE SME_ONLINE_OD_CUST_NAV_DTL SET OD_LEVEL_1_FLAG = ? ,OD_LEVEL_1_DT = sysdate WHERE CUST_NAV_ID = ?
CHECK_OFFER_ACTIVE_STATUS=select count(*) from SME_ONLINE_OD_OFFER_CUST_DTL where CUSTOMER_ID = ? and ACTIVE_FLAG = 'N' and OFFER_MST_ID = ?


################ Added by Prabhat for Alias issue at time of expiry password (Portal) on 03122018
SELECT_ALIAS_ID_FOR_CUST_ID=select nvl(ALIAS_ID,'NA') from RNBID_ALIASID_MAPPING where CUSTOMER_ID = ?

####################Added by 2157 on 14062019 (MCLR and spread value changes)
SELECT_MCLR_RATE_FROM_VIEW=select RAT_INDX,DAT_EFF_INT_INDX from VW_MCLR_RATE_DTL where COD_INT_INDX = (select INTEREST_INDEX_CODE from SME_MCLR_DTL where UPPER(RESET_RATES) = UPPER(?) and UPPER(APPLICABILITY_PERIOD)=UPPER(?) and rownum = 1) and FLG_MNT_STATUS = 'A' order by DAT_EFF_INT_INDX desc
SELECT_FCR_DATE_FORMATED=select to_char(DAT_PROCESS,'dd/mm/yyyy') from VW_FCR_DT
################### Checker (version issues) ################
UPDATE_PUBKEY_REGISTRAION_ISSUE=UPDATE SME_IMEI_PUBKEY_ENTRY SET PUB_KEY = ? WHERE IMEI_NO = ?


################ Added by 2273 FOR TXN_REPEAT_CHECK (22/01/2019) ###############################################
#INSERT_TXN_FOR_CHECK=INSERT INTO SME_MAINTAIN_TXN_CNT (SRN,CUSTOMER_ID,REQUEST_FOR_API,REQUEST_API_SSL,TXN_INITIATE_DATETIME,TXN_FLAG,TXN_COUNT,EXTUNIQUEREFID,SERVICE_CD) VALUES (?,?,?,?,sysdate,?,?,?,?)
INSERT_TXN_FOR_CHECK=INSERT INTO SME_MAINTAIN_TXN_CNT (SRN,CUSTOMER_ID,REQUEST_FOR_API,REQUEST_API_SSL,TXN_INITIATE_DATETIME,TXN_FLAG,TXN_COUNT,EXTUNIQUEREFID,SERVICE_CD,PAYMENT_MODE,COMPANY_ID,TXN_STATUS_FLAG,IP_ADDRESS,PLATFORM_TYPE,HEADER,PLATFORM) VALUES (?,?,?,?,sysdate,?,?,?,?,?,?,?,?,?,?,?)
SELECT_TXN_FOR_CHECK=SELECT SME_MAINTAIN_TXN_CNT_SEQ.NEXTVAL FROM DUAL
CHECK_REQ_SHA=SELECT SRN,TXN_COUNT,TO_CHAR(TXN_FINISH_DATETIME, 'yyyy-MM-dd HH24:MI:SS') FROM SME_MAINTAIN_TXN_CNT WHERE REQUEST_API_SSL=? AND TXN_STATUS_FLAG='P' ORDER BY TXN_FINISH_DATETIME DESC
UPDATE_TXN_CHECK=UPDATE SME_MAINTAIN_TXN_CNT SET TXN_INITIATE_DATETIME = SYSDATE , TXN_FLAG = ? , TXN_COUNT = 1 , REPEAT_SRN = ? WHERE SRN= ?
UPDATE_RESPONSE=UPDATE SME_MAINTAIN_TXN_CNT SET TXN_FINISH_DATETIME = SYSDATE , RESPONSE_FROM_API = ? , TXN_STATUS_FLAG = ? WHERE SRN= ?
DELETE_ISERT_FROM_TXN= DELETE FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO = ?
################ Added by 2273 FOR LIMIT SETUP FROM PORTAL (12/02/2019) ###############################################
#Add new Product code - 237 for version 7.9.0 on 11-04-2023
#Product code - 237 addition in Yes MSME
FETCH_ACC_DTL_XREF=SELECT  COD_ACCT_NO FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST=? AND ((COD_PROD BETWEEN 501 AND 599)  OR (COD_PROD BETWEEN 901 AND 999) OR (COD_PROD BETWEEN 601 AND 899) OR COD_PROD IN (207,208,237,204,210,240,236,249))
FETCH_CHECKERS_NEW=SELECT M.COD_CUST_ID,M.NAM_CUST_FULL,V.COD_ACCT_CUST_REL FROM MV_CI_CUSTMAST_ALL M, VW_CH_ACCT_CUST_XREF V WHERE M.COD_CUST_ID IN (SELECT TO_CHAR(COD_CUST) FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) )) AND M.COD_CUST_ID = TO_CHAR(V.COD_CUST) AND V.COD_ACCT_NO = CAST(? AS CHAR(48))
FETCH_GROUP_SERVICE=SELECT G.GROUP_NAME,S.SERVICE_DESC,G.GROUP_ID FROM COM_SERVICEGROUP G,COM_SERVICE_MST S WHERE S.SERVICE_TYPE=G.GROUP_ID AND S.ACTIVE_FLAG='Y' AND G.ACTIVE_FLAG='Y' AND G.LIMIT_REQUIRED='Y' ORDER BY G.GROUP_NAME
FIND_LIMIT=SELECT CUSTOMER_ID FROM COM_APPROVE_MST WHERE APPROVER_CD = ? AND CUSTOMER_ID = ? AND (APPROVER_NAME LIKE ?  OR APPROVER_NAME LIKE 'AUS') UNION ALL SELECT CUSTOMER_ID FROM COM_APPROVE_MST_TMP WHERE APPROVER_CD = ? AND CUSTOMER_ID = ? AND (APPROVER_NAME LIKE ?  OR APPROVER_NAME LIKE 'AUS')
COM_APPROVE_MST_INSERT_NEW= INSERT INTO COM_APPROVE_MST (CUSTOMER_ID,APPROVER_CD,APPROVER_NAME,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,ACTIVE_FLAG,LAST_CHANGE_ID,BANK_ID,APPROVER_ID,DATA_SOURCE) VALUES(?, ?, ?, ?, ?, ?,sysdate, ?, ? , ? , ? , ?  )
COM_APPROVE_MST_SEQ_NEXTVAL=SELECT COM_APPROVE_MST_SEQ.NEXTVAL FROM DUAL
#Add new Product code - 237 for version 7.9.0 on 11-04-2023
#Product code - 237 addition in Yes MSME
SELECT_VW_CH_ACCT_CUST_XREF_CUST_REL_ACCT_NO=SELECT COD_ACCT_CUST_REL,COD_ACCT_NO FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST= ? AND ((COD_PROD BETWEEN 501 AND 599)  OR (COD_PROD BETWEEN 901 AND 999) OR (COD_PROD BETWEEN 601 AND 899) OR COD_PROD IN (207,208,237,204,210,240,236,249))
FIND_APPROVER_SCORE=SELECT APPROVER_CD,APPROVER_ID FROM COM_APPROVE_MST_TMP WHERE CUSTOMER_ID = ? AND APPROVER_NAME  LIKE ?
SME_LIMIT_PORTAL_REQ_SEQ_NEXTVAL=SELECT COM_APPROVE_MST_SEQ.NEXTVAL FROM DUAL
INSERT_SME_LIMIT_PORTAL_REQ=INSERT INTO SME_LIMIT_PORTAL_REQ(REF_NO, TRAN_DATE, CUSTOMER_ID, COMPANY_ID , SOURCE_ACC_NO, AUTH_STATUS, MAKER_CD, MAKER_DT, REQ_APPROVER_SCORE, BAL_APPROVER_SCORE ,LIMIT_DATA,OPERATION_MODE) VALUES ( ?, SYSDATE, ? , ? , ? , ? , ? , SYSDATE, ? , ? , ? , ?)
FETCH_DAILY_LIMIT_MST=SELECT DAILY_LIMIT,APPROVER_LIST FROM COM_APPROVAL_GRP_MST WHERE SERVICECDID = ? AND ACCOUNT_NO = ? AND SERVICE_CD = ?
FETCH_CHECKERS_UPDATE=SELECT DISTINCT M.COD_CUST_ID,M.NAM_CUST_FULL,V.COD_ACCT_CUST_REL FROM MV_CI_CUSTMAST_ALL M, VW_CH_ACCT_CUST_XREF V , COM_APPROVAL_GRP_MST C WHERE M.COD_CUST_ID IN (SELECT TO_CHAR(COD_CUST) FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) )) AND M.COD_CUST_ID = TO_CHAR(V.COD_CUST) AND V.COD_ACCT_NO = CAST(? AS CHAR(48)) AND C.ACCOUNT_NO = ? AND C.SERVICECDID = ?
CHECK_LIMIT_REQ=SELECT LIMIT_DATA,MAKER_CD,CUSTOMER_ID FROM SME_LIMIT_PORTAL_REQ WHERE COMPANY_ID = ? AND SOURCE_ACC_NO = ? AND (AUTH_STATUS = ? OR AUTH_STATUS = ?) AND BAL_APPROVER_SCORE != '0' 
#SELECT_ALL_LIMIT_RECORDS= SELECT COUNT(*) FROM SME_LIMIT_PORTAL_REQ WHERE COMPANY_ID = ? AND AUTH_STATUS = 'P' 
SELECT_LIMIT_BE4_AUTH=SELECT CUSTOMER_ID,BAL_APPROVER_SCORE FROM SME_LIMIT_PORTAL_REQ WHERE SOURCE_ACC_NO = ? AND COMPANY_ID = ?
SELECT_BAL_SCORE=SELECT APPROVER_ID FROM COM_APPROVE_MST_TMP WHERE APPROVER_CD = ? AND CUSTOMER_ID = ?
UPDATE_LIMIT_AUTH=UPDATE SME_LIMIT_PORTAL_REQ SET CUSTOMER_ID = ?,BAL_APPROVER_SCORE = ? ,AUTH_STATUS = ?,REMARKS = ? WHERE SOURCE_ACC_NO = ?
FETCH_COMPANY=SELECT COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) ) AND COD_ACCT_CUST_REL = 'SOW' 
FETCH_APPROVED_DATA=SELECT MAKER_CD, TO_CHAR(MAKER_DT, 'dd-MM-yy') AS MAKER_DT, CUSTOMER_ID, LIMIT_DATA, OPERATION_MODE, REQ_APPROVER_SCORE FROM SME_LIMIT_PORTAL_REQ WHERE COMPANY_ID = ? AND SOURCE_ACC_NO = ? 
COM_APPROVAL_GRP_MST_SEQ_NEXTVAL=SELECT COM_APPROVALMAPPING_GRP_SEQ.NEXTVAL FROM DUAL
COM_APPROVAL_GRP_MST_INSERT_NEW=INSERT INTO COM_APPROVAL_GRP_MST_TMP (SERVICECDID, ACCOUNT_NO, SERVICE_CD, ID, AUTH_STATUS, MAKER_CD, MAKER_DT, MAKER_CAL_DT , AUTHOR_CD , AUTHOR_DT,AUTHOR_CAL_DT, ACTIVE_FLAG, APPROVER_LIST, OPERATION_MODE, TOTAL_SCORE,BANK_ID,DAILY_LIMIT,LAST_CHANGE_ID) VALUES(?, ?, ?, ?, ?, ?, SYSDATE ,SYSDATE, ? ,SYSDATE, SYSDATE,?, ?, ?, ? , ? ,? ,?)
CHECK_LIMIT_IN_COM_APPROVE_MST=SELECT * FROM COM_APPROVE_MST WHERE CUSTOMER_ID = ? AND APPROVER_NAME LIKE ? AND AUTH_STATUS = 'A'
FETCH_FROM_COM_APPROVE_MST_TMP=SELECT CUSTOMER_ID,APPROVER_CD,APPROVER_NAME,ID,AUTH_STATUS,MAKER_CD,TO_CHAR(MAKER_DT, 'dd-MM-yy') AS MAKER_DT,TO_CHAR(MAKER_CAL_DT, 'dd-MM-yy') AS MAKER_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,BANK_ID,APPROVER_ID FROM COM_APPROVE_MST_TMP WHERE CUSTOMER_ID = ? AND APPROVER_NAME LIKE ? 
INSERT_INTO_COM_APPROVE_MST=INSERT INTO COM_APPROVE_MST(CUSTOMER_ID,APPROVER_CD,APPROVER_NAME,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,BANK_ID,APPROVER_ID,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT) VALUES( ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? , SYSDATE , SYSDATE )
COM_APPROVALMAPPING_MST_SEQ_NEXTVAL=SELECT COM_APPROVALMAPPING_MST_SEQ.NEXTVAL FROM DUAL
FETCH_SERVICE_SERVICE_TYPE=SELECT SERVICE_CD from COM_SERVICE_MST WHERE SERVICE_TYPE = ? AND ACTIVE_FLAG='Y'
INSERT_INTO_COM_APPROVALMAPPING_MST=INSERT INTO COM_APPROVALMAPPING_MST(SERVICECDID, ACCOUNT_NO, SERVICE_CD, ID, AUTH_STATUS, MAKER_CD, MAKER_DT, MAKER_CAL_DT, AUTHOR_CD, AUTHOR_DT, AUTHOR_CAL_DT, ACTIVE_FLAG, LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, sysdate, sysdate, ?, ?, ?, ?, ?,?)
COM_APPROVER_TMP=SELECT COUNT(*) FROM COM_APPROVE_MST WHERE CUSTOMER_ID = ? AND APPROVER_NAME LIKE ?
FETCH_DAILY_LIMIT_MST_TMP=SELECT DAILY_LIMIT FROM SME_LIMIT_REQUEST_FROM_PORTAL WHERE SERVICECDID = ? AND ACCOUNT_NO = ? AND SERVICE_CD = ?
FETCH_CHECKERS_UPDATE_TMP=SELECT DISTINCT M.COD_CUST_ID,M.NAM_CUST_FULL,V.COD_ACCT_CUST_REL FROM MV_CI_CUSTMAST_ALL M, VW_CH_ACCT_CUST_XREF V , SME_LIMIT_REQUEST_FROM_PORTAL C WHERE M.COD_CUST_ID IN (SELECT TO_CHAR(COD_CUST) FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) )) AND M.COD_CUST_ID = TO_CHAR(V.COD_CUST) AND V.COD_ACCT_NO = CAST(? AS CHAR(48)) AND C.ACCOUNT_NO = ? AND C.SERVICECDID = ?
FIND_APPROVER_COUNT=SELECT COUNT(*) AS COUNT FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) )
SME_LIMIT_REQ_PORTAL_SEQ_NEXTVAL=SELECT SME_LIMIT_PORTAL_REQ_SEQ.NEXTVAL FROM DUAL
MAINTAIN_STATUS_LIMIT_REQ= INSERT INTO SME_LIMIT_REQUEST_STATUS(SERVICECDID,CUSTOMER_ID,ACCOUNT_NO,REQUEST_FLAG,REQUEST_DATE,ID) VALUES (?,?,?,?,SYSDATE,?)
INSERT_LIMIT_BR_DOC_UPLOAD_DETAIL=INSERT INTO CUST_LIMIT_BR_DOC_UPLOAD_DTS (CUSTOMER_ID,DOC_TYPE,REQ_ID,FILE_TOTAL_NO,UPLOAD_DATE,FILE_TYPE) VALUES (?,?,?,?,SYSDATE,?)
BR_REF_UPDATE=UPDATE SME_LIMIT_REQUEST_FROM_PORTAL SET UPLOADED_BR_REF_NO = ? WHERE SERVICECDID = ? AND ACCOUNT_NO = ? 
SELECT_LIMIT_DOC_DTL=SELECT DOC_TYPE,FILE_TOTAL_NO,FILE_NO,CUSTOMER_ID,UPLOADED_FILE_NAME FROM CUST_LIMIT_BR_DOC_UPLOAD_DTS WHERE REQ_ID = ?
UPDATE_LIMIT_BR=UPDATE CUST_LIMIT_BR_DOC_UPLOAD_DTS set UPLOAD_STATUS = 'P',FILE_NO = ?,UPLOADED_FILE_NAME = ? WHERE REQ_ID = ?
UPDATE_LIMIT_BR1=UPDATE CUST_LIMIT_BR_DOC_UPLOAD_DTS set UPLOAD_STATUS = 'C',SERVER_UPLOAD_TIME = sysdate,FILE_NO = ?,UPLOADED_FILE_NAME = ?,BR_DIR_NAME=? WHERE REQ_ID = ?
CHECK_REQUEST_INITIATED=SELECT COUNT(*), UPLOADED_BR_STATUS,UPLOADED_BR_REF_NO FROM SME_LIMIT_REQUEST_FROM_PORTAL WHERE SERVICECDID = ? AND ACCOUNT_NO = ? group by UPLOADED_BR_STATUS,UPLOADED_BR_REF_NO
DELETE_FILE_DATA=DELETE FROM CUST_LIMIT_BR_DOC_UPLOAD_DTS WHERE REQ_ID = ?
UPDATE_BR_STATUS=UPDATE SME_LIMIT_REQUEST_FROM_PORTAL SET UPLOADED_BR_STATUS = ? , UPLOADED_BR_PATH = ?  WHERE UPLOADED_BR_REF_NO = ?
FETCH_BR_STATUS=SELECT UPLOADED_BR_STATUS FROM SME_LIMIT_REQUEST_FROM_PORTAL WHERE SERVICECDID = ? AND ACCOUNT_NO = ?
FETCH_STAGES_OF_LIMIT_REQ=SELECT INITIATED_FLAG,TO_CHAR(INITIATED_DATE,'DD-MON-YYYY HH24:MI:SS') AS INITIATED_DATE,NVL(BR_APPLIED_FLAG,'U'),NVL(TO_CHAR(BR_APPLIED_DATE,'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(INITIATED_DATE,'DD-MON-YYYY HH24:MI:SS')) AS BR_APPLIED_DATE, NVL(BR_APPROVED_REJ_FLAG,'NA') AS BR_APPROVED_REJ_FLAG, NVL(TO_CHAR(BR_APPROVED_REJ_DATE,'DD-MON-YYYY HH24:MI:SS'),'NA') AS BR_APPROVED_REJ_DATE,NVL(BR_REJ_REASON,'NA') AS BR_REJ_REASON, NVL(LIMIT_APPROVED_REJ_FLAG, 'NA') AS LIMIT_APPROVED_REJ_FLAG, NVL(TO_CHAR(LIMIT_APPROVED_REJ_DATE,'DD-MON-YYYY HH24:MI:SS'),'NA') AS LIMIT_APPROVED_REJ_DATE,NVL(MAIL_SENT_FLAG,'NA') AS MAIL_SENT_FLAG ,NVL(TO_CHAR(MAIL_SENTT_DATE,'DD-MON-YYYY HH24:MI:SS'),'NA') AS MAIL_SENTT_DATE FROM SME_LIMIT_REQUEST_STATUS WHERE SERVICECDID = ? AND ACCOUNT_NO = ?

###################################### Added by 2273 FOR WL7 TO WL8 (14/02/2018) ####################################################
SELECT_LAST_LOGIN = SELECT TO_char(LAST_REQUEST_TIME,'yyyy-MM-dd HH24:MI:SS'),LOGIN_ID FROM SME_APP_LOGIN_INFO WHERE DEVICE_UUID=?  AND EXCEPTION_CD = ?
SELECT_DETAILS_WL8 = SELECT NAM_CUST_FULL, REF_CUST_TELEX, REF_CUST_EMAIL,SERVICE_RM,ASSET_RM,SERVICE_RM_EMAILID,SERVICE_RM_MOB,ASSET_RM_MOB,ASSET_RM_EMAILID,ASSET_RM_NAME,SERVICE_RM_NAME, TOKEN, ALIAS_ID FROM MV_CI_CUSTMAST_ALL , SME_APP_LOGIN_INFO , RNBID_ALIASID_MAPPING WHERE COD_CUST_ID = ? AND TO_CHAR(COD_CUST_ID) = LOGIN_ID AND TO_CHAR(COD_CUST_ID) = CUSTOMER_ID
UPDATE_FOR_WL8= UPDATE SME_APP_LOGIN_INFO SET EXCEPTION_CD = ? WHERE DEVICE_UUID = ?
UPDATE_SME_APP_LOGIN_INFO= UPDATE SME_APP_LOGIN_INFO SET EXCEPTION_CD = ? WHERE DEVICE_UUID = ?

###################################### Added by 2273 FOR MAINTAIN LOGIN DETAILS  (17/04/2019) ####################################################
MAINTAIN_DATA_BEFORE_LOGIN=INSERT INTO SME_APP_LOGIN_INFO_BKUP SELECT * FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ?
UPDATE_SME_TRANSACTIONAL_DTL_FOR_DOUBLE_TXN= UPDATE SME_TRANSACTION_DTL SET AUTH_STATUS = ? , BAL_APPROVER_SCORE = ? WHERE TRAN_REF_NO = ?
#FETCH_ACC_COM_APPROVER = SELECT DISTINCT ACCOUNT_NO from COM_APPROVALMAPPING_MST WHERE APPROVER_LIST LIKE ? AND ACTIVE_FLAG = 'Y'
FOR_CA_ACC=select COD_ACCT_NO as ACCOUNT_NO, AMT_OD_LIMIT as LIMIT_AMT,BAL_AVAILABLE as BAL_AVAILABLE from VW_CH_ACCT_MAST where AMT_OD_LIMIT = 0 and COD_LINE_NO is null and COD_ACCT_NO IN (?)
FOR_CA_ACC_CNT=select COUNT(*) AS COUNT from VW_CH_ACCT_MAST where AMT_OD_LIMIT = 0 and COD_LINE_NO is null and COD_ACCT_NO IN ?


#################################### SQL Query for Help Section by 2157 on 15-05-2019
SELECT_HELP_GROUP_NAME=select HELP_GROUP_NAME,MAPPED_MODULE_IDS from SME_HELP_GROUP_MST where ACTIVE_FLAG = 'Y'
SELECT_HELP_MODULE_NAME=select HELP_SUB_MODULE_NAME,HELP_SUB_MODULE_ID from SME_HELP_MODULE_MST where ACTIVE_FLAG = 'Y' and ID in (
SELECT_HELP_MODULE_DETAIL=select FILE_TYPE,HELP_SUB_MODULE_ID,MODULE_DESCRIPTION,UPLOADED_FILE_NAME from SME_HELP_MODULE_MST where HELP_SUB_MODULE_ID = ?
SELECT_HELP_MODULE_DETAIL_PRELOGIN=select FILE_TYPE,HELP_SUB_MODULE_ID,MODULE_DESCRIPTION,UPLOADED_FILE_NAME from SME_HELP_MODULE_MST where HELP_SUB_MODULE_NAME like ?

################################## SQL Query for ADD TAX group entry for existing limit setup by 2157 on 27-05-2019 ##############################
SELECT_COUNT_IN_GROUP_MAPPING_TABLE=SELECT COUNT(*) FROM COM_APPROVAL_GRP_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD = (SELECT SERVICE_TYPE from COM_SERVICE_MST where SERVICE_CD = 'GT01' and ACTIVE_FLAG = 'Y') and ACTIVE_FLAG = 'Y'
INSERT_EXISTING_ENTRY_FOR_TAX_GRP=INSERT INTO COM_APPROVAL_GRP_MST   (SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID, APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DAILY_LIMIT,DATA_SOURCE) select SERVICECDID,ACCOUNT_NO,(select SERVICE_TYPE from COM_SERVICE_MST where SERVICE_CD = 'GT01' and ACTIVE_FLAG = 'Y'),COM_APPROVALMAPPING_GRP_SEQ.nextval,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG, LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE, BANK_ID, DAILY_LIMIT, DATA_SOURCE  from COM_APPROVAL_GRP_MST where ACCOUNT_NO = ? and SERVICE_CD = (select SERVICE_TYPE from COM_SERVICE_MST where SERVICE_CD = 'FT02' and ACTIVE_FLAG = 'Y') and ACTIVE_FLAG = 'Y'
SELECT_COUNT_IN_APPROVALMAPPING_GST=SELECT COUNT(*) FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD = (SELECT SERVICE_CD from COM_SERVICE_MST where SERVICE_TYPE = '7' and ACTIVE_FLAG = 'Y') and ACTIVE_FLAG = 'Y'
INSERT_EXISTING_ENTRY_APPROVALMAPPING_FOR_TAX_GRP=INSERT INTO COM_APPROVALMAPPING_MST (SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DATA_SOURCE) SELECT SERVICECDID,ACCOUNT_NO,(SELECT SERVICE_CD FROM COM_SERVICE_MST WHERE SERVICE_TYPE = '7' AND ACTIVE_FLAG  = 'Y'),COM_APPROVALMAPPING_MST_SEQ.NEXTVAL,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DATA_SOURCE FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD=(SELECT SERVICE_CD FROM COM_SERVICE_MST WHERE SERVICE_CD = 'FT02' AND ACTIVE_FLAG  = 'Y') AND ACTIVE_FLAG = 'Y'

################################## SQL Query for Pos request by 2273 on 01-07-2019 ##############################
POS_ROLL_REQ=INSERT INTO POS_REQUESTED_DATA(COMPANYID_ID,INITIATED_ID,MAKER_CHECKER_FLAG,REQUEST_TYPE,REQUEST_DATE,POS_ROLL_COUNT,ID,POS_MID)VALUES(?,?,?,?,SYSDATE,?,?,?)
POS_EV_REQ=INSERT INTO POS_REQUESTED_DATA(COMPANYID_ID,INITIATED_ID,MAKER_CHECKER_FLAG,REQUEST_TYPE,REQUEST_DATE,POS_MID,POS_PROB_DESC,ID)VALUES(?,?,?,?,SYSDATE,?,?,?)
POS_STATEMENT_REQ=INSERT INTO POS_REQUESTED_DATA(COMPANYID_ID,INITIATED_ID,MAKER_CHECKER_FLAG,REQUEST_TYPE,REQUEST_DATE,POS_MID,ID)VALUES(?,?,?,?,SYSDATE,?,?)
POS_EMAIL_MOB_REQ=INSERT INTO POS_REQUESTED_DATA(COMPANYID_ID,INITIATED_ID,MAKER_CHECKER_FLAG,REQUEST_TYPE,REQUEST_DATE,POS_MID,POS_EMAIL_ID,POS_MOB_NO,POS_CONTACT_NO,ID)VALUES(?,?,?,?,SYSDATE,?,?,?,?,?)
POS_UPDATE_MAIL_SENT=UPDATE POS_REQUESTED_DATA SET MAIL_SENT_FLAG = 'Y',MAIL_SENT_DATE = SYSDATE WHERE ID = ?
FETCH_MAKER_OWNER_ID=SELECT MAKER_CD FROM COM_MAKER_MST WHERE MAKER_ALIAS_NAME=? AND ACTIVE_FLAG='Y'
FETCH_OLD_NUM_EMAIL=SELECT REF_CUST_TELEX,REF_CUST_EMAIL FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID=?


################################## SQL Query for E-collect by 2273 on 31-07-2019 ##############################
ECOLLECT_NEFT=SELECT REMIT_CUSTNAME_6091, REMIT_ACCOUNTNO_6021, REMIT_IFSCCODE_5756, NUMAMOUNT_4038, TO_CHAR(DATINITIATION,'DD-MON-YYYY HH24:MI:SS') AS DATINITIATION, (SELECT ECODE FROM SME_REMI_ECODE_DTL WHERE ACCOUNT_NO=REMIT_ACCOUNTNO_6021 AND REMIT_IFSCCODE_5756=ECODE_IFSC AND REQUEST_STATUS ='C' AND COMPANY_ID=?) AS ECODE FROM VW_NEFT WHERE DATINITIATION >= SYSDATE-30 AND BENE_ACCOUNTNO_6061 IN (?) AND DIRECTION = 'IN' AND (REMIT_ACCOUNTNO_6021 IN (SELECT ACCOUNT_NO FROM SME_REMI_ECODE_DTL) OR REMIT_ACCOUNTNO_6021 NOT IN (SELECT ACCOUNT_NO FROM SME_REMI_ECODE_DTL)) 
ADID_LOGIN=SELECT COUNT(*),USER_PASSWORD FROM USER_MST WHERE USER_CD = ? AND DISABLED_USER = 'N' AND AD_AUTH_FLAG = 'Y' GROUP BY USER_PASSWORD
ECOLLECT_RTGS=SELECT ORDERING_CUST_5500_2, ACCOUNTNO, IFSCCODE, NUMAMOUNT,TO_CHAR(DATINITIATION,'DD-MON-YYYY HH24:MI:SS') AS DATINITIATION,(SELECT ECODE FROM SME_REMI_ECODE_DTL WHERE ACCOUNT_NO=ACCOUNTNO AND ECODE_IFSC=IFSCCODE AND REQUEST_STATUS ='C'  AND COMPANY_ID=?) AS ECODE FROM VW_RTGS WHERE DATINITIATION >= SYSDATE-30 AND DIRECTION='IN' AND BENE_CUST_ACCT_NO_5561 IN (?) AND (ACCOUNTNO IN (SELECT ACCOUNT_NO FROM SME_REMI_ECODE_DTL) OR ACCOUNTNO NOT IN (SELECT ACCOUNT_NO FROM SME_REMI_ECODE_DTL))
SME_REMI_ECODE_DTL_SEQ=SELECT SME_REMI_ECODE_DTL_SEQ.NEXTVAL FROM DUAL
FIND_ECODE=SELECT COUNT(*),REQUEST_STATUS FROM SME_REMI_ECODE_DTL WHERE COMPANY_ID=? AND ECODE=? GROUP BY REQUEST_STATUS
FIND_ECODE_ACCOUNT=SELECT COUNT(*),REQUEST_STATUS FROM SME_REMI_ECODE_DTL WHERE COMPANY_ID=? AND ECODE_IFSC =? AND ACCOUNT_NO=? GROUP BY REQUEST_STATUS
INSERT_ECODE=INSERT INTO SME_REMI_ECODE_DTL(ID,ECODE_IFSC,ACCOUNT_NO,CUST_NAME,MOBILE_NO,EMAIL_ID,CREATER_CD,CREATER_DT,LAST_CHANGE_ID,COMPANY_ID,AUTH_STATUS,REQUEST_STATUS,ECODE) VALUES(?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?)
SEND_DATA_IN_HIS=INSERT INTO SME_REMI_ECODE_DTL_HIS (SELECT * FROM SME_REMI_ECODE_DTL WHERE COMPANY_ID=? AND ECODE_IFSC=? AND ACCOUNT_NO=?)
UPDATE_ECODE=UPDATE SME_REMI_ECODE_DTL SET ECODE_IFSC = ?,ACCOUNT_NO=?,CUST_NAME=?,CREATER_CD=?,CREATER_DT=SYSDATE,LAST_CHANGE_ID=1,COMPANY_ID=?,AUTH_STATUS=?,REQUEST_STATUS=?,ECODE=? WHERE COMPANY_ID=? AND ECODE_IFSC=? AND ACCOUNT_NO=?
DELETE_ECODE=UPDATE SME_REMI_ECODE_DTL SET REQUEST_STATUS ='D' WHERE ECODE=? AND COMPANY_ID=?
SELECT_COUNT_IN_GROUP_MAPPING_TABLE_FOR_ECODE=SELECT COUNT(*) FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD = 'EC02' AND ACTIVE_FLAG = 'Y'
INSERT_EXISTING_ENTRY_FOR_ECODE=INSERT INTO COM_APPROVAL_GRP_MST   (SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID, APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DAILY_LIMIT,DATA_SOURCE)   select SERVICECDID,ACCOUNT_NO,(select SERVICE_TYPE from COM_SERVICE_MST where SERVICE_CD = 'EC02' and ACTIVE_FLAG = 'Y'),COM_APPROVALMAPPING_GRP_SEQ.nextval,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG, LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE, BANK_ID, DAILY_LIMIT, DATA_SOURCE  from COM_APPROVAL_GRP_MST where ACCOUNT_NO = ? and SERVICE_CD = (select SERVICE_TYPE from COM_SERVICE_MST where SERVICE_CD = 'FT02' and ACTIVE_FLAG = 'Y') and ACTIVE_FLAG = 'Y'
INSERT_EXISTING_ENTRY_FOR_ECODE_COM_APPROVALMAPPING_MST=INSERT INTO COM_APPROVALMAPPING_MST (SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID, APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DATA_SOURCE) SELECT SERVICECDID,ACCOUNT_NO,'EC02',COM_APPROVALMAPPING_MST_SEQ.nextval,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG, LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE, BANK_ID,DATA_SOURCE  FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD ='FT02' AND ACTIVE_FLAG = 'Y'
SELECT_EC02_DTL=SELECT REF_NO,SERVICECD,BENE_IFSC,AMOUNT,FROM_ACC,TO_ACC,REMARKS,TO_CHAR(MAKE_DT, 'DD-MON-YYYY HH24:MI:SS'),MAKER_ID,APPROVER_ID,MOBILE_NO,BENE_NAME,TRANSFER_TYPE FROM SME_SINGLE_TXN_MAKER_DTL WHERE MAKER_ID = ? AND APPROVE_STATUS = ? AND SERVICECD = 'EC02'
ECOLLECT_NEFT_VW_TXN=SELECT REMIT_CUSTNAME_6091, REMIT_ACCOUNTNO_6021, REMIT_IFSCCODE_5756, NUMAMOUNT_4038, TO_CHAR(DATINITIATION,'DD-MON-YYYY HH24:MI:SS') AS DATINITIATION, (SELECT ECODE FROM SME_REMI_ECODE_DTL WHERE (TO_CHAR(ACCOUNT_NO)=TO_CHAR(?) OR TO_CHAR(ACCOUNT_NO)=(?)) AND TO_CHAR(REMIT_IFSCCODE_5756)=TO_CHAR(ECODE_IFSC) AND REQUEST_STATUS='C' AND TO_CHAR(COMPANY_ID)=TO_CHAR(?)) AS ECODE,DECODE(DIRECTION,'IN','C','OUT','D') FROM VW_NEFT WHERE TRIM(TO_DATE(DATINITIATION,'dd/mm/yyyy')) >= TRIM(TO_DATE(SYSDATE-30,'dd/mm/yyyy')) AND (TO_CHAR(REMIT_ACCOUNTNO_6021)=TO_CHAR(?) OR TO_CHAR(REMIT_ACCOUNTNO_6021)=TO_CHAR(?)) OR (TO_CHAR(BENE_ACCOUNTNO_6061) =TO_CHAR(?) OR TO_CHAR(BENE_ACCOUNTNO_6061)=TO_CHAR(?)) 
ECOLLECT_RTGS_VW_TXN=SELECT ORDERING_CUST_5500_2, ORDERING_CUST_5500_1, ORDERING_INST_5517, NUMAMOUNT,TO_CHAR(DATINITIATION,'DD-MON-YYYY HH24:MI:SS') AS DATINITIATION,(SELECT ECODE FROM SME_REMI_ECODE_DTL WHERE (TO_CHAR(ACCOUNT_NO)=TO_CHAR(?) OR TO_CHAR(ACCOUNT_NO)=TO_CHAR(?)) AND TO_CHAR(ECODE_IFSC)=TO_CHAR(ORDERING_INST_5517) AND REQUEST_STATUS='C' AND TO_CHAR(COMPANY_ID)=TO_CHAR(?)) AS ECODE,DECODE(DIRECTION,'IN','C','OUT','D') FROM VW_RTGS WHERE TRIM(TO_DATE(DATINITIATION,'dd/mm/yyyy')) >= TRIM(TO_DATE(SYSDATE-30,'dd/mm/yyyy')) AND (TO_CHAR(ORDERING_CUST_5500_1) = (?) OR TO_CHAR(ORDERING_CUST_5500_1) = TO_CHAR(?)) OR (TO_CHAR(BENE_CUST_ACCT_NO_5561) = TO_CHAR(?) OR TO_CHAR(BENE_CUST_ACCT_NO_5561) = TO_CHAR(?))
FETCH_COMPANY_NAME=SELECT NAM_CUST_FULL FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID = ?
FIND_ECODE_OF_COMPANY=SELECT ECODE FROM SME_REMI_ECODE_DTL WHERE COMPANY_ID=? AND ACCOUNT_NO=? 
FETCH_ALL_ECODE=SELECT CUST_NAME,ACCOUNT_NO,ECODE_IFSC,ECODE FROM SME_REMI_ECODE_DTL WHERE TO_CHAR(COMPANY_ID)=TO_CHAR(?) AND REQUEST_STATUS='C'


################################## SQL Query for SEND MSG by 2273 on 04-11-2019 ##############################
INSERT_MSG_FOR_BENE=INSERT INTO MIDE_PUSH_MESSAGE_LOG(MESSAGEID,PHONENUMBER,MESSAGETEXT,SUBMITTEDTIME) VALUES(MESSAGEID.nextval,?,?,TO_CHAR(SYSDATE,'DD-MON-YYYY HH:MI:SS AM'))
INSERT_MSG_FOR_BENE_LOCAL=INSERT INTO MIDE_PUSH_MESSAGE_LOG(PHONENUMBER,MESSAGETEXT,SUBMITTEDTIME) VALUES(?,?,TO_CHAR(SYSDATE,'DD-MON-YYYY HH:MI:SS AM'))
INSERT_SME_APP_LOGIN_INFO_LOG_INFO=INSERT INTO SME_APP_LOGIN_INFO_LOG_INFO SELECT * FROM SME_APP_LOGIN_INFO WHERE LOGIN_ID = ?


################################## SQL Query for DashBoard by 2273 on 02-07-2019 ##############################
ASSET_OD_LIMIT=SELECT COUNT(*),AMT_OD_LIMIT,BAL_AVAILABLE,TRIM(COD_LINE_NO) AS COD_LINE_NO FROM VW_CH_ACCT_MAST WHERE AMT_OD_LIMIT > 0 AND BAL_AVAILABLE >= 0 AND FLG_MNT_STATUS='A' AND COD_CCY = 1 AND COD_ACCT_NO = cast(? as char(48)) GROUP BY AMT_OD_LIMIT,BAL_AVAILABLE,COD_LINE_NO
LIABILITY_OD_LIMIT=SELECT COUNT(*),AMT_OD_LIMIT,BAL_AVAILABLE,TRIM(COD_LINE_NO) AS COD_LINE_NO FROM VW_CH_ACCT_MAST WHERE AMT_OD_LIMIT > 0 AND BAL_AVAILABLE < 0 AND FLG_MNT_STATUS='A' AND COD_CCY = 1 AND COD_ACCT_NO = cast(? as char(48)) GROUP BY AMT_OD_LIMIT,BAL_AVAILABLE,COD_LINE_NO
EEFC_ACCOUNT=SELECT COUNT(*) FROM VW_CH_ACCT_MAST WHERE  FLG_MNT_STATUS='A' AND COD_CCY != 1 AND COD_ACCT_NO = cast(? as char(48))
COUNT_NOTIFICATION_UNREAD_MSG=SELECT COUNT(*) FROM NOTIFICATION WHERE SEND_STATUS = 'N' AND CREATED_ON >= sysdate -7 AND CUSTOMER_ID = ?
#GET_BALANCE=SELECT DESCRIPTION,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT FROM VW_LIMITS WHERE TRIM(LINE_ID) = TRIM((SELECT MAIN_LINE FROM VW_LIMITS WHERE TRIM(LINE_ID) = TRIM(?) AND CUSTOMER_NO = ? AND MAIN_LINE IS NOT NULL)) and CUSTOMER_NO = ?
GET_BALANCE=SELECT DESCRIPTION,LIMIT_AMOUNT,NVL(UTILISATION,0) AS UTILISATION,AVAILABLE_AMOUNT,NVL(MAIN_LINE,'NA') AS MAIN_LINE,AVAILABILITY_FLAG FROM VW_LIMITS WHERE TRIM(LINE_ID) = TRIM(?) and CUSTOMER_NO = ? AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')
GET_CHILD=SELECT DISTINCT LIMIT_AMOUNT as LIMIT_AMT, NVL(UTILISATION,0) AS UTILISATION ,DESCRIPTION,AVAILABLE_AMOUNT,LINE_ID FROM VW_LIMITS WHERE CUSTOMER_NO =? AND TRIM(MAIN_LINE) =TRIM(?) AND AVAILABILITY_FLAG='Y' AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')
CALCULATION_LINE_ID=SELECT LIMIT_AMOUNT, NVL(UTILISATION,0) AS UTILISATION,TRIM(MAIN_LINE) AS MAIN_LINE  FROM VW_LIMITS WHERE CUSTOMER_NO = ? AND TRIM(LINE_ID) = TRIM(?) AND AVAILABILITY_FLAG='Y' AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')
PARENT_LINE_DATA=SELECT LIMIT_AMOUNT as LIMIT_AMT, NVL(UTILISATION,0) AS UTILISATION, DESCRIPTION FROM VW_LIMITS WHERE TRIM(LINE_ID) =TRIM(?) AND CUSTOMER_NO =? AND MAIN_LINE IS NULL AND AVAILABILITY_FLAG='Y' AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')
STAND_ALONE_FCR=SELECT DESCRIPTION,LIMIT_AMOUNT,NVL(UTILISATION,0) AS UTILISATION FROM VW_LIMITS WHERE MAIN_LINE IS NULL AND CUSTOMER_NO = ? AND TRIM(LINE_ID) = TRIM(?) AND AVAILABILITY_FLAG='Y'
COM_APPROVAL_GRP_MST_SEQ_NEXTVAL=SELECT COM_APPROVALMAPPING_GRP_SEQ.NEXTVAL FROM DUAL
ACCOUNT_EXPIRY=SELECT COUNT(*) FROM VW_CH_OD_LIMIT WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) ) AND DAT_LIMIT_END >=TO_DATE(SYSDATE, 'DD-MM-YY')


LIMIT_PARENT_DATA=SELECT ORD,LIAB_ID,CUSTOMER_NO,TRIM(LINE_ID) AS LINE_ID, TRIM(DESCRIPTION) AS DESCRIPTION,TRIM(MAIN_LINE) MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE MAIN_LINE IS NULL AND TRIM(LINE_ID) LIKE TRIM('%MAIN_LINE%') AND AVAILABILITY_FLAG='Y' AND CUSTOMER_NO=? AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')
CHILD_LIMIT_DATA=SELECT ORD,LIAB_ID,CUSTOMER_NO,TRIM(LINE_ID) AS LINE_ID, TRIM(DESCRIPTION) AS DESCRIPTION,TRIM(MAIN_LINE) MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE TRIM(MAIN_LINE) =TRIM(?) AND AVAILABILITY_FLAG='Y' AND CUSTOMER_NO=? AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')


#LIMIT_PARENT_DATA= select a.SERVICECDID,a.ACCOUNT_NO,a.SERVICE_CD,b.GROUP_NAME,a.ACTIVE_FLAG,a.approver_list,a.operation_mode,a.daily_limit from COM_APPROVAL_GRP_MST a,com_servicegroup b where a.service_cd = b.group_id  and a.ACCOUNT_NO =?;
#CHILD_LIMIT_DATA= select a.SERVICECDID,a.ACCOUNT_NO,a.SERVICE_CD,b.GROUP_NAME,a.ACTIVE_FLAG,a.approver_list,a.operation_mode,a.daily_limit from COM_APPROVAL_GRP_MST a,com_servicegroup b where a.service_cd = b.group_id  and a.ACCOUNT_NO =?;



LIMIT_FCC_DATA=SELECT ORD,LIAB_ID,CUSTOMER_NO,TRIM(LINE_ID) AS LINE_ID, TRIM(DESCRIPTION) AS DESCRIPTION,TRIM(MAIN_LINE) MAIN_LINE,LIMIT_AMOUNT,UTILISATION,AVAILABLE_AMOUNT,REVOLVING_LINE,LINE_START_DATE,LINE_EXPIRY_DATE,AVAILABILITY_FLAG,LIMIT_CCY,NVL(MAIN_LINE,DESCRIPTION) FROM VW_LIMITS WHERE MAIN_LINE IS NULL AND TRIM(LINE_ID) NOT LIKE TRIM('%MAIN_LINE%') AND AVAILABILITY_FLAG='Y' AND CUSTOMER_NO=? AND LINE_EXPIRY_DATE >=TO_DATE(SYSDATE, 'DD-MM-YY')
FETCH_ACCOUNT_DTL_VW_CH_ACCT_MAST=SELECT AMT_OD_LIMIT,BAL_AVAILABLE,TRIM(NVL(COD_LINE_NO,'NA')) AS COD_LINE_NO,COD_CCY FROM VW_CH_ACCT_MAST WHERE FLG_MNT_STATUS='A' AND COD_ACCT_NO = cast(? as char(48)) GROUP BY AMT_OD_LIMIT,BAL_AVAILABLE,COD_LINE_NO,COD_CCY
FETCH_ACC_OD_VW_CH_ACCT_MAST=SELECT AMT_OD_LIMIT,BAL_AVAILABLE,TRIM(NVL(COD_LINE_NO,'NA')) AS COD_LINE_NO FROM VW_CH_ACCT_MAST WHERE FLG_MNT_STATUS='A' AND COD_CUST=? AND COD_LINE_NO= ? AND COD_CCY ='1' GROUP BY AMT_OD_LIMIT,BAL_AVAILABLE,COD_LINE_NO
FETCH_BAL_BY_LINEID_COMPANYID=SELECT BAL_AVAILABLE FROM VW_CH_ACCT_MAST WHERE FLG_MNT_STATUS='A' AND COD_LINE_NO = ? AND COD_CUST = ? 

########################################QUERIES FOR POSITIVE PAY MODULE 10-07-2019 ######################################################
#SELECT_PENDING_POSITIVE_PAY_REQUEST_COUNT = SELECT COUNT(1) FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID=? AND REQUEST_STATUS='INITIATED' AND TO_DATE(CHQ_DATE, 'DD/MM/YY') >= TO_DATE(SYSDATE,'DD/MM/YY') AND FILE_ID is null
SELECT_PENDING_POSITIVE_PAY_REQUEST_COUNT = SELECT COUNT(1) FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID=? AND REQUEST_STATUS='INITIATED' AND CHQ_DATE >= SYSDATE AND FILE_ID is null


#SELECT_PENDING_POSITIVE_PAY_REQUEST_COUNT = SELECT COUNT(1) FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID=? AND REQUEST_STATUS='INITIATED' AND TO_DATE(CHQ_DATE, 'DD/MM/YY') >= TO_DATE(SYSDATE,'DD/MM/YY') AND FILE_ID is null
SELECT_PENDING_POSITIVE_PAY_REQUEST_COUNT =  SELECT COUNT(1) FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID=? AND REQUEST_STATUS='INITIATED' AND CHQ_DATE >= SYSDATE AND FILE_ID is null


SELECT_PENDING_POSITIVE_PAY_REQUEST_COUNT_FILE  = Select count(1) from(SELECT DISTINCT(FILE_ID) FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE  CUSTOMER_ID=? AND FILE_ID is not null)
INSERT_POSITIVE_PAY = INSERT INTO SME_POSITIVE_PAY_REQUEST (ID, ACCOUNT_NUMBER,CHQ_NUMBER,CHQ_AMOUNT,CHQ_DATE,REQUEST_STATUS,FRONT_IMAGE_FOLDER_PATH,BACK_IMAGE_FOLDER_PATH,DATA_SOURCE,BROWSE_FILE_NAME,AUTH_STATUS,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,AUTHOR_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_ID,CHQ_BENEFICIARY_NAME,Initiation_DATE,MAKER_CD,MAKER_DT,MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK,CHEQUE_REMARKS) VALUES (?,?,?,?,TO_DATE(?,'DD-MM-YYYY'),?,?,?,?,?,?,?,systimestamp,systimestamp,?,?, ?,?,SYSDATE,?,SYSDATE,?,?,?,?,?)
#INSERT_POSITIVE_PAY_TMP = INSERT INTO SME_POSITIVE_PAY_REQUEST_TMP (ID, ACCOUNT_NUMBER,CHQ_NUMBER,CHQ_AMOUNT,CHQ_DATE,REQUEST_STATUS,FRONT_IMAGE_FOLDER_PATH,BACK_IMAGE_FOLDER_PATH,DATA_SOURCE,BROWSE_FILE_NAME,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,MAKER_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_ID,CHQ_BENEFICIARY_NAME,Initiation_DATE) VALUES (?,?,?,?,TO_DATE(?,'DD-MM-YYYY'),?,?,?,?,?,?,?,systimestamp,systimestamp,?,?, ?,?,SYSDATE)
INSERT_POSITIVE_PAY_TMP = INSERT INTO SME_POSITIVE_PAY_REQUEST_TMP (ID, ACCOUNT_NUMBER,CHQ_NUMBER,CHQ_AMOUNT,CHQ_DATE,REQUEST_STATUS,FRONT_IMAGE_FOLDER_PATH,BACK_IMAGE_FOLDER_PATH,DATA_SOURCE,BROWSE_FILE_NAME,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,MAKER_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_ID,CHQ_BENEFICIARY_NAME,Initiation_DATE,MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK,CHEQUE_REMARKS) VALUES (?,?,?,?,TO_DATE(?,'DD-MM-YYYY'),?,?,?,?,?,?,?,systimestamp,systimestamp,?,?, ?,?,SYSDATE,?,?,?,?,?)
INSERT_POSITIVE_PAY_TMP_BULK = INSERT INTO SME_POSITIVE_PAY_REQUEST_TMP (ID, ACCOUNT_NUMBER,CHQ_NUMBER,CHQ_AMOUNT,CHQ_DATE,REQUEST_STATUS,FRONT_IMAGE_FOLDER_PATH,BACK_IMAGE_FOLDER_PATH,DATA_SOURCE,BROWSE_FILE_NAME,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,MAKER_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_ID,CHQ_BENEFICIARY_NAME,Initiation_DATE,RECORD_SERIAL_NUMBER,FILE_ID,MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK,CHEQUE_REMARKS) VALUES (?,?,?,?,TO_DATE(?,'DD-MM-YYYY'),?,?,?,?,?,?,?,systimestamp,systimestamp,?,?, ?,?,SYSDATE,?,?,?,?,?,?,?)
INSERT_POSITIVE_PAY_BULK = INSERT INTO SME_POSITIVE_PAY_REQUEST(ID, ACCOUNT_NUMBER,CHQ_NUMBER,CHQ_AMOUNT,CHQ_DATE,REQUEST_STATUS,FRONT_IMAGE_FOLDER_PATH,BACK_IMAGE_FOLDER_PATH,DATA_SOURCE,BROWSE_FILE_NAME,AUTH_STATUS,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,MAKER_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_ID,CHQ_BENEFICIARY_NAME,Initiation_DATE,RECORD_SERIAL_NUMBER,FILE_ID,MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK,CHEQUE_REMARKS,MAKER_CD,AUTHOR_REMARKS) VALUES (?,?,?,?,TO_DATE(?,'DD-MM-YYYY'),?,?,?,?,?,?,?,systimestamp,systimestamp,?,?, ?,?,SYSDATE,?,?,?,?,?,?,?,?,?)

#SELECT_POSITIVE_PAY_LIST_MAKER= SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,TO_char(Initiation_DATE,'DD-MON-YYYY HH24:MM:SS') as Initiation_DATE,ID,MAKER_CD FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE MAKER_CD = ? AND REQUEST_STATUS='INITIATED' AND TO_DATE(CHQ_DATE, 'DD/MM/YY') >= TO_DATE(SYSDATE,'DD/MM/YY')  AND FILE_ID   is null
SELECT_POSITIVE_PAY_LIST_MAKER= SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,TO_CHAR(CHQ_DATE,'DD/MM/YYYY'),MAKER_REMARKS ,CHEQUE_REMARKS,TO_char(Initiation_DATE,'DD-MON-YYYY HH24:MM:SS') as Initiation_DATE,ID,MAKER_CD FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE MAKER_CD = ? AND REQUEST_STATUS='INITIATED'  AND CHQ_DATE >= SYSDATE AND FILE_ID   is null
### added on 06 Jan 2021
VERIFY_ACCOUNT_NUMBER =  SELECT count(1) FROM VW_CH_ACCT_CUST_XREF WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) ) 

CHECK_PP_INITIATE_STATUS=SELECT COUNT(*) FROM SME_POSITIVE_PAY_REQUEST_TMP where REQUEST_STATUS <> 'INITIATED' AND ID = ?
CHECK_PP_FILE_UPLOAD_INITIATE_STATUS=SELECT COUNT(*) FROM SME_POSITIVE_PAY_REQUEST_TMP where REQUEST_STATUS <> 'INITIATED' AND FILE_ID = ?

POSITIVE_PAY_SINGLE_MAKER=SELECT ROWNUM,CUSTOMER_ID,CHQ_AMOUNT,AUTH_STATUS,NVL(TO_CHAR(INITIATION_DATE,'DD-MON-YYYY HH24:MI:SS'),'NA'),ACCOUNT_NUMBER,AUTHOR_CD,NVL(MAKER_CD,'NA'),REQUEST_STATUS,NVL(TO_CHAR( AUTHOR_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),NVL(TO_CHAR( MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),ID,CHQ_NUMBER,CHQ_BENEFICIARY_NAME,TO_CHAR(CHQ_DATE,'DD/MM/YYYY'),ADMIN_REMARKS,NVL(TO_CHAR( ADMIN_AUTHORIZED_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND ACCOUNT_NUMBER = ?  AND UPPER(DATA_SOURCE)='ONE' AND MAKER_CD = ? UNION ALL SELECT ROWNUM,CUSTOMER_ID,CHQ_AMOUNT,AUTH_STATUS,NVL(TO_CHAR(INITIATION_DATE,'DD-MON-YYYY HH24:MI:SS'),'NA'),ACCOUNT_NUMBER,AUTHOR_CD,NVL(MAKER_CD,'NA'),REQUEST_STATUS,NVL(TO_CHAR( AUTHOR_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),NVL(TO_CHAR( MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),ID,CHQ_NUMBER,CHQ_BENEFICIARY_NAME,TO_CHAR(CHQ_DATE,'DD/MM/YYYY'),ADMIN_REMARKS,NVL(TO_CHAR( ADMIN_AUTHORIZED_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK FROM SME_POSITIVE_PAY_REQUEST WHERE INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND ACCOUNT_NUMBER = ?  AND UPPER(DATA_SOURCE)='ONE' AND MAKER_CD = ? 
POSITIVE_PAY_SINGLE_CHECKER=SELECT ROWNUM,CUSTOMER_ID,CHQ_AMOUNT,AUTH_STATUS,NVL(TO_CHAR(INITIATION_DATE,'DD-MON-YYYY HH24:MI:SS'),'NA'),ACCOUNT_NUMBER,AUTHOR_CD,NVL(MAKER_CD,'NA'),REQUEST_STATUS,NVL(TO_CHAR( AUTHOR_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),NVL(TO_CHAR( MAKER_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),ID,CHQ_NUMBER,CHQ_BENEFICIARY_NAME,TO_CHAR(CHQ_DATE,'DD/MM/YYYY'),ADMIN_REMARKS, NVL(TO_CHAR( ADMIN_AUTHORIZED_DT, 'DD-MON-YYYY HH24:MI:SS'),'NA'),MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK  FROM SME_POSITIVE_PAY_REQUEST WHERE INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND ACCOUNT_NUMBER =  ?  AND UPPER(DATA_SOURCE)='ONE'   ORDER BY INITIATION_DATE DESC
POSITIVE_PAY_BULK_MAKER=SELECT DISTINCT FILE_ID,NUMBER_OF_RECORDS_IN_FILE,BROWSE_FILE_NAME,MAKER_CD,NVL(AUTHOR_CD,'NA'),( SELECT nvl(TO_CHAR(initiation_date,'DD-MON-YYYY HH24:MI:SS'),'NA') FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE file_id = p1.file_id AND ROWNUM<2),AUTH_STATUS, (Select SUM(CHQ_AMOUNT) FROM SME_POSITIVE_PAY_REQUEST_TMP  WHERE FILE_ID  = p1.file_id),CUSTOMER_ID,ACCOUNT_NUMBER,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY HH24:MI:SS'),'NA') FROM SME_POSITIVE_PAY_REQUEST_TMP p1 WHERE  INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND ACCOUNT_NUMBER = ? AND UPPER(DATA_SOURCE)='FILE' AND MAKER_CD = ? UNION ALL SELECT  DISTINCT FILE_ID,NUMBER_OF_RECORDS_IN_FILE,BROWSE_FILE_NAME,MAKER_CD,NVL(AUTHOR_CD,'NA'),( SELECT nvl(TO_CHAR(initiation_date,'DD-MON-YYYY HH24:MI:SS'),'NA') FROM SME_POSITIVE_PAY_REQUEST WHERE file_id = p1.file_id AND ROWNUM<2),AUTH_STATUS, (Select SUM(CHQ_AMOUNT) FROM SME_POSITIVE_PAY_REQUEST  WHERE FILE_ID  = p1.file_id),CUSTOMER_ID,ACCOUNT_NUMBER,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY HH24:MI:SS'),'NA') FROM SME_POSITIVE_PAY_REQUEST p1 WHERE  INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND ACCOUNT_NUMBER = ? AND UPPER(DATA_SOURCE)='FILE' AND MAKER_CD = ? 
POSITIVE_PAY_BULK_CHECKER=SELECT  DISTINCT FILE_ID,NUMBER_OF_RECORDS_IN_FILE,BROWSE_FILE_NAME,NVL(MAKER_CD,'NA'),NVL(AUTHOR_CD,'NA'),( SELECT nvl(TO_CHAR(initiation_date,'DD-MON-YYYY HH24:MI:SS'),'NA') FROM SME_POSITIVE_PAY_REQUEST WHERE file_id = p1.file_id AND ROWNUM<2),AUTH_STATUS,(Select SUM(CHQ_AMOUNT) FROM SME_POSITIVE_PAY_REQUEST  WHERE FILE_ID  = p1.file_id),CUSTOMER_ID,ACCOUNT_NUMBER,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY HH24:MI:SS'),'NA') from SME_POSITIVE_PAY_REQUEST p1 WHERE  INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND ACCOUNT_NUMBER = ? AND UPPER(DATA_SOURCE)='FILE'  
POSITIVE_PAY_FILEID_DTL=SELECT REQUEST_STATUS FROM SME_POSITIVE_PAY_REQUEST WHERE FILE_ID=? UNION ALL SELECT REQUEST_STATUS FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE FILE_ID=?
#POSITIVE_PAY_DATE_CHECK=SELECT COUNT(*) FROM DUAL WHERE ? >= SYSDATE - 30
POSITIVE_PAY_DATE_CHECK=select abs(?-TO_DATE(?,'DD/MM/YYYY')) from dual

#validate cooling period CR----29-03-2023---2459
SELECT_AUTHOR_TIME_OF_BENE=select BENE_ID,(extract( day from DATE_DIFF )*24*60 +   extract( hour from DATE_DIFF )*60 +    extract( minute from DATE_DIFF )) minuteDiff  from (select BENE_ID, systimestamp - AUTHOR_TIME as DATE_DIFF from SME_BENEFICIARY_DTL where AUTHOR_TIME is not null and BENE_ADD_FLAG = 'Y' and BENE_MODE in ('A','U') AND <1> AND <2>  


#POSITIVE_PAY_TRANSACTIONS_CHECKER =  SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD/MM/YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD/MM/YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS FROM SME_POSITIVE_PAY_REQUEST WHERE CUSTOMER_ID = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual) UNION ALL SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD/MM/YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD/MM/YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual)
POSITIVE_PAY_TRANSACTIONS_CHECKER =  SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,TO_CHAR(CHQ_DATE,'DD/MM/YYYY') AS CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD-MON-YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS FROM SME_POSITIVE_PAY_REQUEST WHERE CUSTOMER_ID = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual) UNION ALL SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,TO_CHAR(CHQ_DATE,'DD/MM/YYYY') AS CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD-MON-YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual)
#POSITIVE_PAY_TRANSACTIONS_MAKER = SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD/MM/YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS FROM SME_POSITIVE_PAY_REQUEST WHERE CUSTOMER_ID = ? AND MAKER_CD = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual) UNION ALL SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD/MM/YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID = ? AND MAKER_CD = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual)
#POSITIVE_PAY_TRANSACTIONS_MAKER =SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD/MM/YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD/MM/YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS FROM SME_POSITIVE_PAY_REQUEST WHERE CUSTOMER_ID = ? AND MAKER_CD = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual) UNION ALL SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD/MM/YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD/MM/YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS  FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID = ? AND MAKER_CD = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual)
POSITIVE_PAY_TRANSACTIONS_MAKER =SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,TO_CHAR(CHQ_DATE,'DD/MM/YYYY') AS CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD-MON-YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS FROM SME_POSITIVE_PAY_REQUEST WHERE CUSTOMER_ID = ? AND MAKER_CD = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual) UNION ALL SELECT CHQ_AMOUNT,ACCOUNT_NUMBER,CHQ_NUMBER,BROWSE_FILE_NAME, CHQ_BENEFICIARY_NAME  ,TO_CHAR(CHQ_DATE,'DD/MM/YYYY') AS CHQ_DATE,MAKER_REMARKS ,NVL(TO_CHAR(Initiation_DATE,'DD-MON-YYYY'),'NA'),ID,MAKER_CD,REQUEST_STATUS,AUTH_STATUS,NVL(TO_CHAR(AUTHOR_DT,'DD-MON-YYYY'),'NA'),AUTHOR_REMARKS,ADMIN_REMARKS  FROM SME_POSITIVE_PAY_REQUEST_TMP WHERE CUSTOMER_ID = ? AND MAKER_CD = ? AND INITIATION_DATE  > (Select sysdate - 7 from dual)
POSITIVE_PAY_FILE_TRANSACTION_INSERT_FROM_MAIN = INSERT INTO SME_POSITIVE_PAY_REQUEST (ID ,REQUEST_STATUS, FRONT_IMAGE_FOLDER_PATH, BACK_IMAGE_FOLDER_PATH, DATA_SOURCE, BROWSE_FILE_NAME , AUTH_STATUS , MAKER_CD , MAKER_DT , MAKER_CAL_DT , MAKER_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_id,CHQ_BENEFICIARY_NAME,FILE_ID ,CHQ_NUMBER,CHQ_AMOUNT,ACCOUNT_NUMBER,RECORD_SERIAL_NUMBER,INITIATION_DATE,CHQ_DATE,MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK,CHEQUE_REMARKS) SELECT  ID ,UPPER(REQUEST_STATUS), FRONT_IMAGE_FOLDER_PATH, BACK_IMAGE_FOLDER_PATH, DATA_SOURCE, BROWSE_FILE_NAME , AUTH_STATUS , MAKER_CD , MAKER_DT , MAKER_CAL_DT , MAKER_REMARKS,NUMBER_OF_RECORDS_IN_FILE,CUSTOMER_id,CHQ_BENEFICIARY_NAME, FILE_ID,CHQ_NUMBER,CHQ_AMOUNT,ACCOUNT_NUMBER,RECORD_SERIAL_NUMBER,INITIATION_DATE,CHQ_DATE,MICR_CODE,SHORT_ACCOUNT_NUMBER,TRANSACTION_CODE,DRAWEE_BANK,CHEQUE_REMARKS FROM  SME_POSITIVE_PAY_REQUEST_TMP WHERE FILE_ID =? 
UPDATE_POSITIVE_PAY_WITH_TRAN_NO = UPDATE SME_POSITIVE_PAY_REQUEST SET SME_TRANSACTION_DTL_TRAN_NO = ?,INITIATION_DATE = sysdate WHERE ID = ?
UPDATE_POSITIVE_PAY_WITH_FILE_TRAN_NO = UPDATE SME_POSITIVE_PAY_REQUEST SET SME_TRANSACTION_DTL_TRAN_NO = ?,INITIATION_DATE = sysdate WHERE FILE_ID = ? AND ACCOUNT_NUMBER = ?
#SELECT_TXN_IDS_FOR_PP00_FOR_MAKER=SELECT SME_TRANSACTION_DTL_TRAN_NO FROM SME_POSITIVE_PAY_REQUEST WHERE INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND MAKER_CD  = ? AND REQUEST_STATUS IN ('REJECTED',) AND ACCOUNT_NUMBER = ? ORDER BY INITIATION_DATE DESC
SELECT_TXN_IDS_FOR_PP00_FOR_MAKER=SELECT SME_TRANSACTION_DTL_TRAN_NO FROM SME_POSITIVE_PAY_REQUEST WHERE INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND MAKER_CD  = ?  AND ACCOUNT_NUMBER = ? ORDER BY INITIATION_DATE DESC
SELECT_TXN_IDS_FOR_PP00_FOR_CHECKER=SELECT SME_TRANSACTION_DTL_TRAN_NO FROM SME_POSITIVE_PAY_REQUEST WHERE INITIATION_DATE BETWEEN TO_DATE(?,'dd/MM/yyyy hh24:mi:ss') AND TO_DATE(?,'dd/MM/yyyy hh24:mi:ss')  AND REQUEST_STATUS IN ('REJECTED') AND ACCOUNT_NUMBER = ? ORDER BY INITIATION_DATE DESC
INSERT_POSITIVE_PAY_REQUEST_SME_TXN_COUNT=INSERT INTO SME_MAINTAIN_TXN_CNT (SRN,CUSTOMER_ID,REQUEST_FOR_API,REQUEST_API_SSL,TXN_INITIATE_DATETIME,TXN_FLAG,TXN_COUNT,EXTUNIQUEREFID,SERVICE_CD,PAYMENT_MODE,COMPANY_ID,TXN_STATUS_FLAG,IP_ADDRESS,PLATFORM_TYPE,HEADER,PLATFORM,TXN_FINISH_DATETIME,RESPONSE_FROM_API) VALUES (SME_MAINTAIN_TXN_CNT_SEQ.NEXTVAL,?,?,?,systimestamp,?,?,?,?,?,?,?,?,?,?,?,systimestamp,'NA')

############## Added by 2157 for update industry for others type
UPDATE_CUSTOMER_NAV_DTL1_WITH_INDUSTRY=UPDATE SME_ONLINE_OD_CUST_NAV_DTL SET OD_LEVEL_1_FLAG=?, OD_LEVEL_1_DT = SYSDATE, OD_LEVEL_1_NAV_DTL = ?,INDUSTRY_TYPE = ?,INDUSTRY_FLAG = ? WHERE CUST_NAV_ID = ? AND CUSTOMER_ID = ?
INDUSTRY_DATA=SELECT INDUSTRY_TYPE,INDUSTRY_AS FROM SME_INDUSTRY_TYPE_MST WHERE ACTIVE_FLAG = 'Y'
#QUERY TO INSERT ACTUAL REMARKS in SME_TRANSACTION_REMARKS
#added by 2330 on 07-october-2019
SME_TRANSACTION_REMARKS_INSERT = INSERT INTO SME_TRANSACTION_REMARKS (SERVICE_CODE,INITIATED_USER_ID,COMPANY_ID,TRANSACTION_NO,TRANSACTION_DATE_TIME,TRANSACTION_TYPE,REMARKS,RECORD_INSERT_DATE,TRANSACTION_CHANNEL) VALUES(?,?,?,?,systimestamp,?,?,systimestamp,?)


############################################ Added By 2273 for Upload and Renewal Functionality with MOP #################################################
UPDATE_NON_TRANSACTION_DTL = UPDATE SME_NON_TRANSACTION_DTL SET BAL_APPROVER_SCORE = ? WHERE REF_NO = ? 
UPDATE_NON_TXN_STATUS=UPDATE SME_NON_TRANSACTION_DTL SET AUTH_STATUS=? WHERE REF_NO=?
SELECT_COUNT_IN_GROUP_MAPPING_TABLE_FOR_RLS=SELECT COUNT(*) FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD = 'RLS01' AND ACTIVE_FLAG = 'Y'
INSERT_EXISTING_ENTRY_FOR_RLS_COM_APPROVALMAPPING_MST=INSERT INTO COM_APPROVALMAPPING_MST (SERVICECDID,ACCOUNT_NO,SERVICE_CD,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG,LAST_CHANGE_ID, APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE,BANK_ID,DATA_SOURCE) SELECT SERVICECDID,ACCOUNT_NO,'RLS01',COM_APPROVALMAPPING_MST_SEQ.nextval,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG, LAST_CHANGE_ID,APPROVER_LIST,OPERATION_MODE,TOTAL_SCORE, BANK_ID,DATA_SOURCE  FROM COM_APPROVALMAPPING_MST WHERE ACCOUNT_NO = ? AND SERVICE_CD ='FT02' AND ACTIVE_FLAG = 'Y'
CHECK_RLS_INITIATE_STATUS=SELECT COUNT(*),ACCOUNT_NO,RENEW_ACTION,SERVICE_DTL FROM SME_REQUEST_LETTER_SUB WHERE APPROVE_STATUS = 'I' AND REF_NO = ? GROUP BY SOURCE_ACC_NO,RENEW_ACTION,SERVICE_DTL
ALL_NON_TRANS_APPROVAL=UPDATE SME_REQUEST_LETTER_SUB SET APPROVER_ID = ?,APPROVE_STATUS = ?,APP_REJ_DT = sysdate,REMARKS = ? WHERE REF_NO = ?
INSERT_RSL_TXN_REF_NO=SELECT SME_REQUEST_LETTER_SUB_SEQ.NEXTVAL FROM DUAL
INSERT_RLS_SUB_TBL= INSERT INTO SME_REQUEST_LETTER_SUB (REF_NO,TRAN_REF_NO,SERVICECD,ACCOUNT_NO,REMARKS,MAKER_DT,MAKER_ID,APPROVER_ID,COMPANY_ID,RENEW_ACTION,SERVICE_DTL,APPROVE_STATUS) values (?,?,?,?,?,sysdate,?,?,?,?,?,?)
INSERT_NON_TXN_REF_NO=SELECT SME_NON_TRANSACTION_SEQ.NEXTVAL FROM DUAL
INSERT_NON_TXN_TABLE_CHK=INSERT INTO SME_NON_TRANSACTION_DTL(TRAN_DATE, CUSTOMER_ID, SOURCE_ACC_NO, AUTH_STATUS, MAKER_CD, MAKER_DT, OPERATION_MODE, REQ_APPROVER_SCORE, BAL_APPROVER_SCORE,SERVICE_CD,BANK_NAME,REF_NO,SERVICE_DTL) VALUES(SYSDATE, ?, ?, ?, ? , SYSDATE, ?, ?, ?, ?,'YESBANK', ?, ?)
SELECT_NON_TRANSACTION_DTL=SELECT BAL_APPROVER_SCORE,OPERATION_MODE FROM SME_NON_TRANSACTION_DTL WHERE REF_NO=?
SELECT_PENDING_NON_TXN= SELECT DISTINCT(A.REF_NO), A.BAL_APPROVER_SCORE, C.APPROVER_ID FROM SME_NON_TRANSACTION_DTL A, COM_APPROVALMAPPING_MST B, COM_APPROVE_MST C where A.CUSTOMER_ID=B.SERVICECDID AND A.SOURCE_ACC_NO=B.ACCOUNT_NO AND A.CUSTOMER_ID=C.CUSTOMER_ID AND C.APPROVER_CD = ? AND B.APPROVER_LIST LIKE ? AND (A.AUTH_STATUS = ? OR A.AUTH_STATUS = ?) order by A.REF_NO desc
SELECT_NON_TRANSACTIONS_DTL=SELECT REF_NO,TO_CHAR(TRAN_DATE, 'DD-MON-YYYY HH24:MI:SS'),SOURCE_ACC_NO,NVL(BANK_NAME,'NA'),CUSTOMER_ID,SERVICE_DTL,SERVICE_CD,MAKER_CD FROM SME_NON_TRANSACTION_DTL WHERE REF_NO=?

############################################ Added By 2273 for ODCPV Process #################################################
FETCH_ACTIVE_OFFER=SELECT ID,OFFER_NAME FROM SME_ONLINE_OD_OFFER_MST WHERE ACTIVE_FLAG='Y'
FETCH_ACTIVE_OFFER_FOR_COMPANY=SELECT COUNT(*) FROM SME_ONLINE_OD_OFFER_CUST_DTL WHERE ACTIVE_FLAG=? AND OFFER_MST_ID=? AND CUSTOMER_ID=? AND ACCOUNT_NUMBER=?
CANCEL_ACTIVE_OFFER_FOR_COMPANY=UPDATE SME_ONLINE_OD_OFFER_CUST_DTL SET ACTIVE_FLAG=? WHERE OFFER_MST_ID=? AND CUSTOMER_ID=? AND ACCOUNT_NUMBER=?
FETCH_REQUESTSHA_ODCPV= SELECT COUNT(*) FROM SME_ODCPV_FILE_DATA WHERE FILE_DATA_SHA = ?
FETCH_SEQ_ODCPV=SELECT SME_ODCPV_FILE_DATA_SEQ.NEXTVAL FROM DUAL
INSERT_IN_ODCPV=INSERT INTO SME_ODCPV_FILE_DATA(SRN,CUSTOMER_ID,FILE_DATA_SHA,TXN_INITIATE_DATETIME) VALUES(?,?,?,SYSDATE)
FETCH_ACTIVE_OFFER_FOR_OFFERID=SELECT CUSTOMER_ID,ACCOUNT_NUMBER,ACTIVE_FLAG FROM SME_ONLINE_OD_OFFER_CUST_DTL WHERE OFFER_MST_ID=?


############################################ Added By 2273 for TRANSFER_CUTOFF Process #################################################
FETCH_CUTOFF_LIST=SELECT COUNT(*),FROM_TIME,TO_TIME,AMOUNT FROM SME_BANK_LIMIT WHERE SERVICE_ID=(SELECT SERVICE_TYPE FROM COM_SERVICE_MST WHERE SERVICE_CD=?) AND ACTIVE_FLAG='Y' AND TRANSACTION_TYPE=? GROUP BY TRANSACTION_TYPE,CUTOFF_TYPE,FROM_TIME,TO_TIME,AMOUNT 


##############################CR UPI Jan2023###################################

SELECT_COMPLETE_ONBORDING=SELECT PAYEE_VPA,QR_STRING,SELLER_IDENTIFIER FROM SME_UPI_ONBOARDING_DTL WHERE COMPANY_ID=? and ACCT_NO=? AND ADD_RES_CODE='00' AND ACTIVE_FLAG='Y' AND AUTH_STATUS='A' AND FETCH_RES_CODE='00' and SELLER_STATUS='ACTIVE'
#Replace NAM_HOLDADR_CITY with NAM_CUSTADR_CITY by 2440 on 08-02-2024
#Replace TXT_HOLDADR_ZIP with TXT_CUSTADR_ZIP by 2440 on 08-02-2024
#Replace NAM_HOLDADR_STATE with NAM_CUSTADR_STATE by 2440 on 08-02-2024
UPI_GET_COMPANY_DETAIL=select NAM_CUST_FULL,NAM_CUSTADR_CITY,  TXT_CUSTADR_ZIP,IFSC_CODE,REF_CUST_IT_NUM ,NAM_CUSTADR_STATE,FLG_CUST_TYP ,COD_CUST,DAT_BIRTH_CUST,DAT_CUST_OPEN,TXT_CUSTADR_ADD1,TXT_CUSTADR_ADD2 from  CH_ACCT_CUST_XREF    , CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_CUST_REL='SOW' and CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48)) and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST  and CH_ACCT_CUST_XREF.COD_ACCT_NO in(select COD_ACCT_NO from  CH_ACCT_CUST_XREF   ch_xref where ch_xref.COD_CUST =?)
UPI_GET_COMPANY_DETAIL_UAT=select NAM_CUST_FULL,NAM_CUSTADR_CITY,  TXT_CUSTADR_ZIP,IFSC_CODE,REF_CUST_IT_NUM ,NAM_CUSTADR_STATE,FLG_CUST_TYP,COD_CUST,DAT_BIRTH_CUST,DAT_CUST_OPEN,TXT_CUSTADR_ADD1,TXT_CUSTADR_ADD2 from  fcrlive_1.ch_acct_cust_xref@CBS_UAT CH_ACCT_CUST_XREF, fcrlive_1.ci_custmast@CBS_UAT CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_CUST_REL='SOW' and CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))  and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_ACCT_NO in(select COD_ACCT_NO from fcrlive_1.ch_acct_cust_xref@CBS_UAT ch_xref where ch_xref.COD_CUST =?)
UPI_GET_COMPANY_DETAIL_LIVE=select NAM_CUST_FULL,NAM_CUSTADR_CITY,  TXT_CUSTADR_ZIP,IFSC_CODE,REF_CUST_IT_NUM ,NAM_CUSTADR_STATE,FLG_CUST_TYP,COD_CUST,DAT_BIRTH_CUST,DAT_CUST_OPEN,TXT_CUSTADR_ADD1,TXT_CUSTADR_ADD2 from  fcrlive_1.ch_acct_cust_xref@CBS_RD_LINK CH_ACCT_CUST_XREF, fcrlive_1.ci_custmast@CBS_RD_LINK CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_CUST_REL='SOW' and CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))  and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_ACCT_NO in(select COD_ACCT_NO from fcrlive_1.ch_acct_cust_xref@CBS_RD_LINK ch_xref where ch_xref.COD_CUST =?)

UPI_GET_CUSTOMER_DETAIL=select  REF_CUST_EMAIL,REF_PHONE_MOBILE,COD_CUST from  CH_ACCT_CUST_XREF    , CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_CUST_REL in('SOW') and CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))  and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_ACCT_NO in(select COD_ACCT_NO from  CH_ACCT_CUST_XREF   ch_xref where ch_xref.COD_CUST =?)
UPI_GET_CUSTOMER_DETAIL_UAT=select REF_CUST_EMAIL,REF_PHONE_MOBILE,COD_CUST   from  fcrlive_1.ch_acct_cust_xref@CBS_UAT CH_ACCT_CUST_XREF, fcrlive_1.ci_custmast@CBS_UAT CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_CUST_REL in('SOW') and CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))   and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_ACCT_NO in(select COD_ACCT_NO from fcrlive_1.ch_acct_cust_xref@CBS_UAT ch_xref where ch_xref.COD_CUST =?)
UPI_GET_CUSTOMER_DETAIL_LIVE=select REF_CUST_EMAIL,REF_PHONE_MOBILE,COD_CUST   from  fcrlive_1.ch_acct_cust_xref@CBS_RD_LINK CH_ACCT_CUST_XREF, fcrlive_1.ci_custmast@CBS_RD_LINK CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_CUST_REL in('SOW') and CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))   and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_ACCT_NO in(select COD_ACCT_NO from fcrlive_1.ch_acct_cust_xref@CBS_RD_LINK ch_xref where ch_xref.COD_CUST =?)
##------------------ TO GET Email Id of customer strictly-------------------------------------
UPI_GET_CUSTOMER_EAMAIL=SELECT REF_CUST_EMAIL,COD_CUST   FROM CH_ACCT_CUST_XREF, CI_CUSTMAST CI_CUSTMAST  WHERE    CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))    AND CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST  AND CH_ACCT_CUST_XREF.COD_CUST  =?
UPI_GET_CUSTOMER_EAMAIL_UAT =select REF_CUST_EMAIL,COD_CUST   from  fcrlive_1.ch_acct_cust_xref@CBS_UAT CH_ACCT_CUST_XREF, fcrlive_1.ci_custmast@CBS_UAT CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))   and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_CUST  =?
UPI_GET_CUSTOMER_EAMAIL_LIVE = select REF_CUST_EMAIL,COD_CUST   from  fcrlive_1.ch_acct_cust_xref@CBS_RD_LINK CH_ACCT_CUST_XREF, fcrlive_1.ci_custmast@CBS_RD_LINK CI_CUSTMAST where  CH_ACCT_CUST_XREF.COD_ACCT_NO =CAST(?  AS CHAR(48))   and CI_CUSTMAST.COD_CUST_ID = CH_ACCT_CUST_XREF.COD_CUST and CH_ACCT_CUST_XREF.COD_CUST  =?
##------------------ TO GET PINCODE AND IFSC--------------------------------------
BRANCH_DTL_BY_ACCOUNT=SELECT TXT_CC_ZIP,COD_FIN_INST_ID FROM CH_ACCT_MAST CHACCMST,BA_CC_BRN_MAST CHBRNMST WHERE CHACCMST.COD_CC_BRN =CHBRNMST.COD_CC_BRN AND COD_ACCT_NO =CAST( ?  AS CHAR(48) )  
BRANCH_DTL_BY_ACCOUNT_UAT=SELECT TXT_CC_ZIP,COD_FIN_INST_ID FROM FCRLIVE_1.CH_ACCT_MAST@CBS_UAT CHACCMST, FCRLIVE_1.BA_CC_BRN_MAST@CBS_UAT CHBRNMST WHERE CHACCMST.COD_CC_BRN =CHBRNMST.COD_CC_BRN AND COD_ACCT_NO =CAST(?  AS CHAR(48) )  
BRANCH_DTL_BY_ACCOUNT_LIVE=SELECT TXT_CC_ZIP,COD_FIN_INST_ID FROM FCRLIVE_1.CH_ACCT_MAST@CBS_RD_LINK CHACCMST, FCRLIVE_1.BA_CC_BRN_MAST@CBS_RD_LINK CHBRNMST WHERE CHACCMST.COD_CC_BRN =CHBRNMST.COD_CC_BRN AND COD_ACCT_NO =CAST(?  AS CHAR(48) )  

SELECT_ONLY_ONBOARDED_ACC = SELECT ACCT_NO,ACC_IFSC,SELLER_IDENTIFIER,PAYEE_VPA,ID FROM SME_UPI_ONBOARDING_DTL where COMPANY_ID=? AND ADD_RES_CODE='00' AND ACTIVE_FLAG='Y' AND AUTH_STATUS='A'
SELECT_ONLY_ONBOARDED_BY_ACCNO = SELECT ACCT_NO,ACC_IFSC,SELLER_IDENTIFIER,PAYEE_VPA,ID FROM SME_UPI_ONBOARDING_DTL where COMPANY_ID=?  and ACCT_NO=?  AND ADD_RES_CODE='00' AND ACTIVE_FLAG='Y' AND AUTH_STATUS='A'
SELECT_PARTIALLY_ONBOARDED = SELECT  COUNT(*)  FROM SME_UPI_ONBOARDING_DTL where COMPANY_ID=? AND ACTIVE_FLAG='Y' AND AUTH_STATUS='P'
SELECT_PARTIALLY_ONBOARDED_DTL = SELECT  ACCT_NO, MCC_CODE ,CUSTOMER_ID,TO_CHAR(CREATE_DATETIME,'dd-MM-yyyy HH24:MI:SS'),ID FROM SME_UPI_ONBOARDING_DTL where COMPANY_ID=? AND ACTIVE_FLAG='Y' AND AUTH_STATUS='P'
SELECT_PARTIALLY_ONBOARDED_BY_ACCNO = SELECT  ACCT_NO, MCC_CODE ,CUSTOMER_ID,TO_CHAR(CREATE_DATETIME,'dd-MM-yyyy HH24:MI:SS'),ID FROM SME_UPI_ONBOARDING_DTL where COMPANY_ID=? and ACCT_NO=?  AND ACTIVE_FLAG='Y' AND AUTH_STATUS='P'


SME_UPI_ONBOARDING_DTL_SEQ = SELECT SME_UPI_ONBOARDING_DTL_SEQ.NEXTVAL FROM DUAL

INSERT_ONBORDING = INSERT INTO SME_UPI_ONBOARDING_DTL(ID,CUSTOMER_ID,COMPANY_ID,ACCT_NO,ACC_IFSC,SELLER_IDENTIFIER,PARTNER_REF_NO,CREATE_DATETIME,PLATFORM,ACTIVE_FLAG,AUTH_STATUS,MCC_CODE)VALUES(?,?,?,?,?,?,?,CURRENT_TIMESTAMP,?,'Y',?,?)

UPDATE_ONBORDING_AUTH = UPDATE  SME_UPI_ONBOARDING_DTL SET  AUTH_STATUS=?,AUTHER_ID=?, REMARKS=?,UPDATE_DATETIME=CURRENT_TIMESTAMP WHERE ID = ?

UPDATE_ONBORDING_RES = UPDATE  SME_UPI_ONBOARDING_DTL SET   ADD_RES_CODE=?,  YP_HUB_USERNAME=? ,  UPDATE_DATETIME=CURRENT_TIMESTAMP, ONBOARDING_DT=CURRENT_TIMESTAMP, ACTIVE_FLAG='Y' WHERE ID = ? and SELLER_IDENTIFIER=?

UPDATE_ONBORDING_FETCHQR_RES = UPDATE SME_UPI_ONBOARDING_DTL SET  PAYEE_VPA=?,QR_STRING=?,  FETCH_RES_CODE=?, UPDATE_DATETIME=CURRENT_TIMESTAMP, SELLER_STATUS=? WHERE ID = ?

INSERT_SME_UPI_TXN_DTL_RSREQ = INSERT INTO SME_UPI_TXN_DTL(ID,CUSTOMER_ID,COMPANY_ID,ACCT_NO,SELLER_IDENTIFIER,PAYEE_VPA,QR_STRING,TXN_TYPE,PAYER_VPA,PAYER_VPA_STATUS,PAYER_NAME,AMOUNT,EXPIRY_MIN,CREATE_DATETIME,PLATFORM,REMARKS,SME_RRN) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,CURRENT_TIMESTAMP,?,?,?)
    ###NPCI_TXN_ID,RRN,
SME_UPI_TXN_DTL_SEQ = SELECT SME_UPI_TXN_DTL_SEQ.NEXTVAL FROM DUAL

INSERT_SME_UPI_TXN_DTL_DNQR = INSERT INTO SME_UPI_TXN_DTL(ID,CUSTOMER_ID,COMPANY_ID,ACCT_NO,SELLER_IDENTIFIER,PAYEE_VPA,QR_STRING,TXN_TYPE,AMOUNT,TXN_DATE,TRANSACTION_STATUS,CREATE_DATETIME,PLATFORM)VALUES(?,?,?,?,?,?,?,?,?,CURRENT_TIMESTAMP,?,CURRENT_TIMESTAMP,?)

#INSERT INTO SME_UPI_TXN_DTL(AMOUNT,TRANSACTION_STATUS,NPCI_TXN_ID)VALUES(?,?,?)

UPDATE_SME_UPI_TXN_DTL_RSRES = UPDATE SME_UPI_TXN_DTL SET TRANSACTION_STATUS=?,TXN_DATE=?,GATEWAY_RESP_CD=?, GATEWAY_RESP_STATUS =?,NPCI_TXN_ID=?,RRN=?,UPDATE_DATETIME=CURRENT_TIMESTAMP WHERE ID = ?

UPDATE_SME_UPI_TXN_DTL_CHKSTS = UPDATE SME_UPI_TXN_DTL SET TRANSACTION_STATUS=?, UPDATE_DATETIME=CURRENT_TIMESTAMP WHERE ID = ?
#to_date(CAST(CREATE_DATETIME AS DATE), 'dd-MM-yy') between '27-01-23' and '30-01-23';
SELECT_FETCH_RAISE_TRANSACTIONS_DTL = SELECT PAYER_NAME,PAYER_VPA,TO_CHAR(TXN_DATE,'yyyy-MM-dd HH24:MI:SS') as TXN_DATE,TXN_TYPE,RRN,TRANSACTION_STATUS,AMOUNT,SME_RRN,TO_CHAR(TXN_DATE,'dd/MM/yyyy HH24:MI:SS') as DSP_DATE,MOBILE_NO,EMAIL_ID FROM SME_UPI_TXN_DTL  where COMPANY_ID=? and ACCT_NO=? and (TRUNC(CAST(CREATE_DATETIME AS DATE)) between TO_DATE( ?, 'DD-MM-YY' )  and TO_DATE( ?, 'DD-MM-YY' )) and TXN_TYPE =? and TRANSACTION_STATUS is not null ORDER BY CREATE_DATETIME desc

SELECT_RAISE_TRAN_DTL_BYSMERRN = SELECT ID,PAYER_NAME,PAYER_VPA,TXN_TYPE,RRN,TRANSACTION_STATUS,AMOUNT,SME_RRN FROM SME_UPI_TXN_DTL  where COMPANY_ID=? and SME_RRN=?

INSERT_SME_UPI_TXN_DTL_INTBASE = INSERT INTO SME_UPI_TXN_DTL(ID,CUSTOMER_ID,COMPANY_ID,ACCT_NO,SELLER_IDENTIFIER,PAYEE_VPA,QR_STRING,TXN_TYPE,AMOUNT,EXPIRY_MIN,CREATE_DATETIME,PLATFORM,SME_RRN,MOBILE_NO,EMAIL_ID,INTENT_URL,SHORT_URL) VALUES(?,?,?,?,?,?,?,?,?,?,SYSDATE,?,?,?,?,?,?)

UPDATE_SME_UPI_TXN_DTL_INTBASE = UPDATE SME_UPI_TXN_DTL SET TRANSACTION_STATUS=?,TXN_DATE=SYSDATE,GATEWAY_RESP_CD=?, GATEWAY_RESP_STATUS =?,UPDATE_DATETIME=CURRENT_TIMESTAMP WHERE ID = ?

SAVE_UPI_CALLBACK_STATUS=INSERT INTO SME_UPI_CALLBACK_TXN_DTL(ID,GATEWAY_RESPONSE_STATUS,AMOUNT,GATEWAY_REFERENCE_ID,GATEWAY_TRANSACTION_ID,PAYEE_VPA,PAYER_NAME,PAYER_VPA,TXNTYPE,MERCHANT_REQUEST_ID,TRANSACTION_TIMESTAMP,TRANSACTION_DATETIME,INSERT_DATETIME,REJECT_REASON,GATEWAY_RESPONSE_CODE,GATEWAY_RESPONSE_MESSAGE) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,CURRENT_TIMESTAMP,?,?,?)

SELECT_INTENT_LONG_URL=select INTENT_URL,AMOUNT from SME_UPI_TXN_DTL where  SHORT_URL=?


SME_CALLBACK_SEQ = SELECT SME_UPI_CALLBACK_TXN_DTL_SEQ.NEXTVAL FROM DUAL


#CALLBACK_FROM_DB= SELECT GATEWAY_RESPONSE_STATUS,AMOUNT,GATEWAY_REFERENCE_ID,GATEWAY_TRANSACTION_ID,PAYEE_VPA,PAYER_NAME,PAYER_VPA,TXNTYPE,MERCHANT_REQUEST_ID,TRANSACTION_TIMESTAMP,INSERT_DATETIME FROM SME_UPI_CALLBACK_TXN_DTL WHERE PAYEE_VPA=? and TO_DATE(TO_CHAR(TRANSACTION_DATETIME,'dd-MM-yyyy'),'dd-MM-yy') >= ? and TO_DATE(TO_CHAR(TRANSACTION_DATETIME,'dd-MM-yyyy'),'dd-MM-yy') <=? 
##WHERE PAYEE_VPA=?

CALLBACK_FROM_DB=SELECT GATEWAY_RESPONSE_STATUS,AMOUNT,GATEWAY_REFERENCE_ID,GATEWAY_TRANSACTION_ID,PAYEE_VPA,PAYER_NAME,PAYER_VPA,TXNTYPE,MERCHANT_REQUEST_ID,TRANSACTION_TIMESTAMP,INSERT_DATETIME,REJECT_REASON,GATEWAY_RESPONSE_CODE,GATEWAY_RESPONSE_MESSAGE FROM SME_UPI_CALLBACK_TXN_DTL WHERE PAYEE_VPA=? and (TRUNC(CAST(TRANSACTION_DATETIME AS DATE)) between TO_DATE( ?, 'DD-MM-YY' )  and TO_DATE( ?, 'DD-MM-YY' )) ORDER BY TRANSACTION_TIMESTAMP DESC


##WHERE PAYEE_VPA=? and TO_DATE(TO_CHAR(CREATE_DATETIME,'dd-MM-yyyy'),'dd-MM-yy') >= ? and TO_DATE(TO_CHAR(CREATE_DATETIME,'dd-MM-yyyy'),'dd-MM-yy') <=? 


	

###################################SOBO UPI ###################################################################

INSERT_SOBO_CUST = INSERT INTO SME_SOBO_CUST_MAPPING (SOBO_ACC_TRACK_ID,LOGIN_ID,SOBO_CUST_ID,ACCOUNT_TYPE,ACCOUNT_REL_CD,NAM_CUST_FULL,ACTIVE_FLAG,INSERTED_DT) VALUES (?,?,?,?,?,?,'Y',CURRENT_TIMESTAMP)
INSERT_SOBO_NON_ELIGIBLE_CUST = INSERT INTO SME_SOBO_CUST_MAPPING (SOBO_ACC_TRACK_ID,LOGIN_ID,SOBO_CUST_ID,ACCOUNT_TYPE,ACCOUNT_REL_CD,NAM_CUST_FULL,ACTIVE_FLAG,INSERTED_DT) VALUES (?,?,?,?,?,?,'N',CURRENT_TIMESTAMP)

UPDATE_SOBO_CUST_RES=UPDATE SME_SOBO_CUST_MAPPING SET ACTIVE_FLAG=?, LAST_UPDATED_DT=CURRENT_TIMESTAMP WHERE SOBO_ACC_TRACK_ID = ?

SOBO_SEQ = SELECT SME_SOBO_CUST_MAPPING_SEQ.NEXTVAL FROM DUAL

SELECT_SOBO_CUST=SELECT LOGIN_ID,SOBO_CUST_ID,ACCOUNT_TYPE,ACCOUNT_REL_CD,ACTIVE_FLAG,INSERTED_DT,NAM_CUST_FULL FROM SME_SOBO_CUST_MAPPING WHERE LOGIN_ID=? and ACTIVE_FLAG ='Y'
SELECT_SOBO_NON_ELIGIBLE_CUST=SELECT LOGIN_ID,SOBO_CUST_ID,ACCOUNT_TYPE,ACCOUNT_REL_CD,ACTIVE_FLAG,INSERTED_DT,NAM_CUST_FULL FROM SME_SOBO_CUST_MAPPING WHERE LOGIN_ID=? and LOGIN_ID = SOBO_CUST_ID  and ACTIVE_FLAG ='N'


SELECT_ELIGIBLE_SOBO_ACCNO=SELECT COD_ACCT_NO FROM  CH_ACCT_CUST_XREF CH_XREF, CI_CUSTMAST WHERE CH_XREF.COD_ACCT_NO IN(SELECT COD_ACCT_NO FROM  CH_ACCT_CUST_XREF CH_XREF1 WHERE CH_XREF1.COD_CUST =?) AND CH_XREF.COD_ACCT_CUST_REL='SOW' AND CI_CUSTMAST.COD_CUST_ID = ch_xref.COD_CUST  AND FLG_CUST_TYP='S'
SELECT_SOBO_CUST_DTL=SELECT CI_CUSTMAST.REF_CUST_IT_NUM, CI_CUSTMAST.REF_PHONE_MOBILE, CI_CUST_CBR_CODES.COD_15 FROM CI_CUSTMAST,CI_CUST_CBR_CODES WHERE CI_CUSTMAST.COD_CUST_ID =? AND CI_CUSTMAST.COD_CUST_ID = CI_CUST_CBR_CODES.COD_CUST_ID
SELECT_SOBO_CUST_IDS=SELECT CH_XREF.COD_CUST, CI_CUSTMAST.NAM_CUST_FULL,FLG_CUST_TYP, COD_ACCT_CUST_REL FROM CI_CUSTMAST,CI_CUST_CBR_CODES ,CH_ACCT_CUST_XREF CH_XREF WHERE CI_CUSTMAST.COD_CUST_ID = ci_cust_cbr_codes.COD_CUST_ID and CI_CUSTMAST.COD_CUST_ID = ch_xref.COD_CUST  AND CI_CUSTMAST.REF_CUST_IT_NUM=? AND CI_CUSTMAST.REF_PHONE_MOBILE=? AND CI_CUST_CBR_CODES.COD_15=? AND CI_CUSTMAST.FLG_CUST_TYP NOT IN('C','P') AND CH_XREF.COD_ACCT_CUST_REL IN('SOW','JOF','JOO','AUS','TRU')

SELECT_ELIGIBLE_SOBO_ACCNO_UAT=SELECT COD_ACCT_NO FROM  fcrlive_1.CH_ACCT_CUST_XREF@CBS_UAT CH_XREF, fcrlive_1.ci_custmast@CBS_UAT CI_CUSTMAST WHERE CH_XREF.COD_ACCT_NO IN(SELECT COD_ACCT_NO FROM  fcrlive_1.CH_ACCT_CUST_XREF@CBS_UAT CH_XREF1 WHERE CH_XREF1.COD_CUST =?) AND CH_XREF.COD_ACCT_CUST_REL='SOW' AND CI_CUSTMAST.COD_CUST_ID = ch_xref.COD_CUST  AND FLG_CUST_TYP='S'
SELECT_SOBO_CUST_DTL_UAT=SELECT CI_CUSTMAST.REF_CUST_IT_NUM, CI_CUSTMAST.REF_PHONE_MOBILE, CI_CUST_CBR_CODES.COD_15 FROM fcrlive_1.ci_custmast@CBS_UAT CI_CUSTMAST,fcrlive_1.CI_CUST_CBR_CODES@CBS_UAT CI_CUST_CBR_CODES WHERE CI_CUSTMAST.COD_CUST_ID =? AND CI_CUSTMAST.COD_CUST_ID = CI_CUST_CBR_CODES.COD_CUST_ID
SELECT_SOBO_CUST_IDS_UAT=SELECT CH_XREF.COD_CUST, CI_CUSTMAST.NAM_CUST_FULL,FLG_CUST_TYP, COD_ACCT_CUST_REL FROM fcrlive_1.ci_custmast@CBS_UAT CI_CUSTMAST,fcrlive_1.CI_CUST_CBR_CODES@CBS_UAT CI_CUST_CBR_CODES ,fcrlive_1.CH_ACCT_CUST_XREF@CBS_UAT CH_XREF WHERE CI_CUSTMAST.COD_CUST_ID = ci_cust_cbr_codes.COD_CUST_ID and CI_CUSTMAST.COD_CUST_ID = ch_xref.COD_CUST  AND CI_CUSTMAST.REF_CUST_IT_NUM=? AND CI_CUSTMAST.REF_PHONE_MOBILE=? AND CI_CUST_CBR_CODES.COD_15=? AND CI_CUSTMAST.FLG_CUST_TYP NOT IN('C','P') AND CH_XREF.COD_ACCT_CUST_REL IN('SOW','JOF','JOO','AUS','TRU')

SELECT_ELIGIBLE_SOBO_ACCNO_LIVE=SELECT COD_ACCT_NO FROM  fcrlive_1.CH_ACCT_CUST_XREF@CBS_RD_LINK CH_XREF, fcrlive_1.ci_custmast@CBS_RD_LINK CI_CUSTMAST WHERE CH_XREF.COD_ACCT_NO IN(SELECT COD_ACCT_NO FROM  fcrlive_1.CH_ACCT_CUST_XREF@CBS_RD_LINK CH_XREF1 WHERE CH_XREF1.COD_CUST =?) AND CH_XREF.COD_ACCT_CUST_REL='SOW' AND CI_CUSTMAST.COD_CUST_ID = ch_xref.COD_CUST  AND FLG_CUST_TYP='S'
SELECT_SOBO_CUST_DTL_LIVE=SELECT CI_CUSTMAST.REF_CUST_IT_NUM, CI_CUSTMAST.REF_PHONE_MOBILE, CI_CUST_CBR_CODES.COD_15 FROM fcrlive_1.ci_custmast@CBS_RD_LINK CI_CUSTMAST,fcrlive_1.CI_CUST_CBR_CODES@CBS_RD_LINK CI_CUST_CBR_CODES WHERE CI_CUSTMAST.COD_CUST_ID =? AND CI_CUSTMAST.COD_CUST_ID = CI_CUST_CBR_CODES.COD_CUST_ID
SELECT_SOBO_CUST_IDS_LIVE=SELECT CH_XREF.COD_CUST, CI_CUSTMAST.NAM_CUST_FULL,FLG_CUST_TYP, COD_ACCT_CUST_REL FROM fcrlive_1.ci_custmast@CBS_RD_LINK CI_CUSTMAST,fcrlive_1.CI_CUST_CBR_CODES@CBS_RD_LINK CI_CUST_CBR_CODES ,fcrlive_1.CH_ACCT_CUST_XREF@CBS_RD_LINK CH_XREF WHERE CI_CUSTMAST.COD_CUST_ID = ci_cust_cbr_codes.COD_CUST_ID and CI_CUSTMAST.COD_CUST_ID = ch_xref.COD_CUST  AND CI_CUSTMAST.REF_CUST_IT_NUM=? AND CI_CUSTMAST.REF_PHONE_MOBILE=? AND CI_CUST_CBR_CODES.COD_15=? AND CI_CUSTMAST.FLG_CUST_TYP NOT IN('C','P') AND CH_XREF.COD_ACCT_CUST_REL IN('SOW','JOF','JOO','AUS','TRU')

############################################Live Change : Limit Consumtpion(REJECTED BY API)  (Added by 2299)  ############################################
SELECT_TXNAMT_FROM_SME_TRANSACTIONAL_DTL = SELECT TRAN_AMOUNT FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO = ? 
UPDATE_TXNAMT_IN_SME_TRANSACTIONAL_DTL = UPDATE SME_TRANSACTION_DTL SET TRAN_AMOUNT = ? WHERE TRAN_REF_NO = ?
ALL_SINGLE_FUND_TRANS_APPROVAL_APIERROR=UPDATE SME_SINGLE_TXN_MAKER_DTL SET APPROVER_ID = ?,APPROVE_STATUS = ?,APP_REJ_DT = sysdate,REMARKS = ?,RES_REF_NO = ?,AMOUNT = '0' WHERE REF_NO = ?

####### INSERT FINAL API DETAILS RESPONSE  (Added by 2299) #############
INSERT_SME_ALL_TXN_BOOK_DTL=INSERT INTO SME_ALL_TXN_BOOK_DTL(REF_NO,COMPANY_ID,SOURCE_ACC_NO,DEST_ACC_NO,DEST_ACC_IFSC,TRAN_AMOUNT,TXN_TYPE,SERVICE_CD,CUSTOMER_ID,RES_TIME_STAMP,UTR_NO,ERROR_LOG,SME_TRAN_DTL_REFNO)VALUES(SME_ALL_TXN_BOOK_DTL_SEQ.NEXTVAL,?,?,?,?,?,?,?,?,SYSDATE,?,?,?)

############ DOUBLE TXN LIVE ISSUE (Added by 2299) ######################
DELETE_INSERT_FROM_TXN= DELETE FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO = ?
INSERT_TXN_BAK_TABLE= INSERT INTO SME_TRANSACTION_DTL_BAK SELECT * FROM SME_TRANSACTION_DTL WHERE TRAN_REF_NO = ?

############ FETCH IFSC CODE (Added by 2273) ######################
FETCH_IFSCCODE=SELECT COD_FIN_INST_ID FROM VW_IFSC WHERE COD_ACCT_NO = CAST( ? AS CHAR(48) )

############ RENEWAL OFFER OPT_OUT (Added by 2273) ######################
#RENEWAL_OFFER=SELECT COMPANY_ID, BORROWER_NAME, CONSTITUTION, INDUSTRY, ACCOUNT_NO, BRN_CODE, OD_AMOUNT, INTEREST_SPREAD, b.PF, PS, TEMPLATE_ID, FORMAT_ID, MCLR_DESC, RENEWAL_FILE_ID,TO_CHAR(TO_DATE(b.LIMIT_EXPIRY_DT,'dd/mm/yyyy'),'DD-MON-YYYY'),TO_CHAR(TO_DATE(b.LIMIT_START_DT,'dd/mm/yyyy'),'DD-MON-YYYY') FROM SME_ONLINE_OD_OFFER_CUST_DTL a, SME_ONLINE_OD_RENEWAL_MST b WHERE b.ACTIVE_FLAG = 'Y' AND a.ACTIVE_FLAG = 'P' AND TO_CHAR(COMPANY_ID) = TO_CHAR(?) AND TO_CHAR(COMPANY_ID) = TO_CHAR(CUSTOMER_ID) AND TO_CHAR(ACCOUNT_NO) = TO_CHAR(ACCOUNT_NUMBER) AND TRIM(TO_DATE(POP_END_DATE,'dd/mm/yyyy')) >= TRIM(TO_DATE(SYSDATE,'dd/mm/yyyy'))
RENEWAL_OFFER=SELECT COMPANY_ID, BORROWER_NAME, CONSTITUTION, INDUSTRY, ACCOUNT_NO, BRN_CODE, OD_AMOUNT, ROI_SPREAD_RATE, b.PF, PS, TEMPLATE_ID, FORMAT_ID, MCLR_DESC, RENEWAL_FILE_ID,TO_CHAR(b.LIMIT_EXPIRY_DT,'DD-MON-YYYY'),TO_CHAR(b.LIMIT_START_DT,'DD-MON-YYYY'),b.TENURE,b.MONTHLY_REDUCTION_AMT,TO_CHAR(b.POP_END_DATE,'DD-MON-YYYY') FROM SME_ONLINE_OD_OFFER_CUST_DTL a, SME_ONLINE_OD_RENEWAL_MST b WHERE b.ACTIVE_FLAG = 'Y' AND a.ACTIVE_FLAG = 'P' AND TO_CHAR(COMPANY_ID) = TO_CHAR(?) AND TO_CHAR(COMPANY_ID) = TO_CHAR(CUSTOMER_ID) AND TO_CHAR(ACCOUNT_NO) = TO_CHAR(ACCOUNT_NUMBER) AND TO_DATE(TO_CHAR(b.POP_END_DATE,'DD-MON-YYYY'),'dd/mm/yyyy') >= TRIM(TO_DATE(SYSDATE,'dd/mm/yyyy'))
RENEWAL_OFFER_UAT=SELECT COMPANY_ID, BORROWER_NAME, CONSTITUTION, INDUSTRY, ACCOUNT_NO, BRN_CODE, OD_AMOUNT, INTEREST_SPREAD, b.PF, PS, TEMPLATE_ID, FORMAT_ID, MCLR_DESC, RENEWAL_FILE_ID,TO_CHAR(TO_DATE(b.LIMIT_EXPIRY_DT,'dd/mm/yyyy'),'DD-MON-YYYY'),TO_CHAR(TO_DATE(b.LIMIT_START_DT,'dd/mm/yyyy'),'DD-MON-YYYY') FROM SME_ONLINE_OD_OFFER_CUST_DTL a, SME_ONLINE_OD_RENEWAL_MST b WHERE b.ACTIVE_FLAG = 'Y' AND a.ACTIVE_FLAG = 'P' AND TO_CHAR(COMPANY_ID) = TO_CHAR(?) AND TO_CHAR(COMPANY_ID) = TO_CHAR(CUSTOMER_ID) AND TO_CHAR(ACCOUNT_NO) = TO_CHAR(ACCOUNT_NUMBER) AND TO_CHAR(TO_DATE(b.POP_END_DATE,'dd/mm/yyyy'),'dd/mm/yyyy') >= TRIM(TO_DATE(SYSDATE,'dd/mm/yyyy'))
RENEW_OFFER_OPT_OUT_ENTRY=INSERT INTO SME_ONLINE_OD_OPT_ENTRY(RENEWAL_ID,COMPANY_ID,OPT_IN_FLAG,OPT_IN_DT) VALUES(?,?,?,SYSDATE)
RENEW_OFFER_OPT_OUT_ENTRY_COUNT=SELECT COUNT(*) FROM SME_ONLINE_OD_OPT_ENTRY WHERE RENEWAL_ID=? AND COMPANY_ID=?
FIND_OPT_OUT_ENTRY= SELECT COUNT(*) FROM SME_ONLINE_OD_OPT_ENTRY WHERE COMPANY_ID=? AND RENEWAL_ID=? AND (OPT_IN_FLAG ='N' OR OPT_IN_FLAG ='Y')
FIND_OPT_OUT_ENTRY_UAT= SELECT COUNT(*) FROM SME_ONLINE_OD_OPT_OUT_ENTRY WHERE CUSTOMER_ID=? AND RENEWAL_ID=?
SELECT_FORMAT_TEMP_DTLFOR_RENEWAL=SELECT VARIABLE_COUNT,SUBJECT_PART,PURPOSE_CODE,VARIABLE_DETAILES,EMAIL_BODY_START,EMAIL_BODY_MAIN,EMAIL_BODY_END FROM SME_FORMAT_MTN_MST where EVENT_ID=? and ACTIVE_FLAG = 'Y'
SELECT_RENEWAL_OFFER_DTL=SELECT RENEWAL_FILE_ID, ID, ACTIVE_FLAG, AUTH_STATUS, LINE_NUMBER, COMPANY_ID, ACCOUNT_NO, PF, MCLR_DESC, ROI_SPREAD_RATE, ASSET_RM_ID, TO_CHAR(LIMIT_START_DT,'dd/mm/yyyy HH:MI:SS AM') AS LIMIT_START_DT, TO_CHAR(LIMIT_EXPIRY_DT,'dd/mm/yyyy HH:MI:SS AM') AS LIMIT_EXPIRY_DT, TO_CHAR(POP_END_DATE,'dd/mm/yyyy HH:MI:SS AM') AS POP_END_DATE, OD_AMOUNT, TENURE, MONTHLY_REDUCTION_AMT, FORMAT_ID, TEMPLATE_ID, ALIAS_ID, BROWSE_FILE_NAME, MAKER_CD, TO_CHAR(MAKER_CAL_DT,'dd/mm/yyyy HH:MI:SS AM') AS MAKER_CAL_DT, TO_CHAR(MAKER_DT,'dd/mm/yyyy HH:MI:SS AM') AS MAKER_DT, AUTHOR_CD, TO_CHAR(AUTHOR_CAL_DT,'dd/mm/yyyy HH:MI:SS AM') AS AUTHOR_CAL_DT, TO_CHAR(AUTHOR_DT,'dd/mm/yyyy HH:MI:SS AM') AS AUTHOR_DT, LAST_CHANGE_ID FROM SME_ONLINE_OD_RENEWAL_MST WHERE RENEWAL_FILE_ID=? AND COMPANY_ID=?
SELECT_OFFER_CUST_DTL=SELECT OFFER_MST_ID, CUSTOMER_ID, BORROWER_NAME, CONSTITUTION, ACTIVE_FLAG, INDUSTRY, ACCOUNT_NUMBER, BRN_CODE, LOAN_AMOUNT, RATE, PF, PS, MISC_OFFR_1, MISC_OFFR_2, MISC_OFFR_3, MISC_OFFR_4, MISC_OFFR_5, MISC_OFFR_6, MISC_OFFR_7, MISC_OFFR_8, MISC_OFFR_9, MISC_OFFR_10, MISC_OFFR_11, MISC_OFFR_12, MISC_OFFR_13, MISC_OFFR_14, MISC_OFFR_15, MISC_OFFR_16, MISC_OFFR_17, MISC_OFFR_18, MISC_OFFR_19, MISC_OFFR_20, TO_CHAR(DATA_INSERT_DT,'dd/mm/yyyy HH24:MI:SS'), TO_CHAR(LIMIT_EXPIRY_DT,'dd/mm/yyyy HH24:MI:SS'), RENEWAL_FLAG, TO_CHAR(LIMIT_START_DATE,'dd/mm/yyyy HH24:MI:SS') FROM SME_ONLINE_OD_OFFER_CUST_DTL WHERE ACCOUNT_NUMBER=? AND CUSTOMER_ID=? AND ACTIVE_FLAG='P'
INSERT_INTO_OFFER_CUST_ARC= INSERT INTO SME_ONLINE_OD_OFFER_CUST_ARC(OFFER_MST_ID, CUSTOMER_ID, BORROWER_NAME, CONSTITUTION, ACTIVE_FLAG, INDUSTRY, ACCOUNT_NUMBER, BRN_CODE, LOAN_AMOUNT, RATE, PF, PS, MISC_OFFR_1, MISC_OFFR_2, MISC_OFFR_3, MISC_OFFR_4, MISC_OFFR_5, MISC_OFFR_6, MISC_OFFR_7, MISC_OFFR_8, MISC_OFFR_9, MISC_OFFR_10, MISC_OFFR_11, MISC_OFFR_12, MISC_OFFR_13, MISC_OFFR_14, MISC_OFFR_15, MISC_OFFR_16, MISC_OFFR_17, MISC_OFFR_18, MISC_OFFR_19, MISC_OFFR_20, DATA_INSERT_DT, LIMIT_EXPIRY_DT, RENEWAL_FLAG, LIMIT_START_DATE) VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
#                                                                              1          2        3            4            5           6           7       8       9              10             11           12            13                 14         15        16          17                  18          19          20           21             22       23             24         25       26               27         28                 1 2 3 4 5 6 7 8 91011              12                                  13                               14                       1516171819202122                   23                               24                  25                    26                  27
INSERT_INTO_RENEWAL_OFFER_ARC= INSERT INTO SME_ONLINE_OD_RENEWAL_MST_ARC(RENEWAL_FILE_ID, ID, ACTIVE_FLAG, AUTH_STATUS, LINE_NUMBER, COMPANY_ID, ACCOUNT_NO, PF, MCLR_DESC, ROI_SPREAD_RATE, ASSET_RM_ID, LIMIT_START_DT, LIMIT_EXPIRY_DT, POP_END_DATE, OD_AMOUNT, TENURE, MONTHLY_REDUCTION_AMT, FORMAT_ID, TEMPLATE_ID, ALIAS_ID, BROWSE_FILE_NAME, MAKER_CD, MAKER_CAL_DT, MAKER_DT, AUTHOR_CD, AUTHOR_CAL_DT, AUTHOR_DT, LAST_CHANGE_ID) VALUES(?,?,?,?,?,?,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),?,?,?,?,?,?,?,?,TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),?,TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),TO_DATE(?,'dd/mm/yyyy HH:MI:SS AM'),?)
DELETE_RENEWAL_OFFER_DTL= DELETE FROM SME_ONLINE_OD_RENEWAL_MST WHERE RENEWAL_FILE_ID=? AND COMPANY_ID=?
UPDATE_OFFER_CUST_DTL=UPDATE SME_ONLINE_OD_OFFER_CUST_DTL SET OFFER_MST_ID=?, LOAN_AMOUNT=?, RATE=?, PF=?, LIMIT_EXPIRY_DT=?, LIMIT_START_DATE=?,DATA_INSERT_DT=SYSDATE,RENEWAL_FLAG='Y' WHERE ACCOUNT_NUMBER=? AND CUSTOMER_ID=? AND ACTIVE_FLAG='P'

################# Added by 2299 for SME-AMC session expired ################
UPDATE_BENE_ACC_NO_IN_BENE_DTL = UPDATE SME_BENEFICIARY_DTL SET BENE_ACCOUNT_NO = ? WHERE BENE_ID = ?

################## Added by 2157 for NON-RNB customer entry on 04-08-2020 
INSERT_INTO_SME_NON_RNB_CUSTOMER_DTL=INSERT INTO SME_NON_RNB_CUSTOMER_DTL (CUSTOMER_ID,REG_DATE_TIME) VALUES (?,CURRENT_TIMESTAMP)
SELECT_COUNT_SME_NON_RNB_CUSTOMER_DTL=SELECT COUNT(*) FROM SME_NON_RNB_CUSTOMER_DTL WHERE  CUSTOMER_ID = ? AND IS_CUSTOMER_EXIT = 'Y'
UPDATE_INTO_SME_NON_RNB_CUSTOMER_DTL=UPDATE SME_NON_RNB_CUSTOMER_DTL SET IS_CUSTOMER_EXIT = ? WHERE CUSTOMER_ID = ?

                                ##FIRST THREAD QUERY Enable Full Access
UPDATE_CUST_NON_RNB_STS=UPDATE SME_NON_RNB_CUSTOMER_DTL SET REQUEST_DATE_TIME=CURRENT_TIMESTAMP,API_HIT_COUNT=?,BENE_PUSH_STATUS=?,UPDATE_RNB_FLAG =? WHERE CUSTOMER_ID=? AND IS_CUSTOMER_EXIT='Y'

SELECT_NON_RNB_CUST=SELECT CUSTOMER_ID,IS_CUSTOMER_EXIT,API_HIT_COUNT FROM SME_NON_RNB_CUSTOMER_DTL WHERE UPDATE_RNB_FLAG=? AND IS_CUSTOMER_EXIT='Y' ORDER BY REG_DATE_TIME  ASC  OFFSET 0 ROWS  FETCH NEXT <1> ROWS ONLY

SELECT_CONFIG_DATA=SELECT  PARAMETER_VALUE  FROM GENERAL_PARAM_MST WHERE PARAMETER_NAME=?

CHECK_NONRNB_IN_MSME=SELECT COUNT(*) FROM SME_NON_RNB_CUSTOMER_DTL WHERE  CUSTOMER_ID = ? AND IS_CUSTOMER_EXIT = 'Y' AND UPDATE_RNB_FLAG='N'

CHECK_RECORD_IN_NONRNB=SELECT COUNT(*) FROM SME_NON_RNB_CUSTOMER_DTL WHERE  CUSTOMER_ID = ? 

INSERT_CUSTOMER_DTL=INSERT INTO SME_NON_RNB_CUSTOMER_DTL (CUSTOMER_ID,IS_CUSTOMER_EXIT,UPDATE_RNB_FLAG,REG_DATE_TIME) VALUES (?,?,?,CURRENT_TIMESTAMP)

                               ##SECOND THREAD QUERY Enable Full Access
SELECT_RNB_CUST_FROM_DB=SELECT CUSTOMER_ID,IS_CUSTOMER_EXIT,API_HIT_COUNT FROM SME_NON_RNB_CUSTOMER_DTL WHERE UPDATE_RNB_FLAG=? AND IS_CUSTOMER_EXIT='Y' AND BENE_PUSH_STATUS='NOT_PUSHED' ORDER BY REQUEST_DATE_TIME  ASC , API_HIT_COUNT ASC   OFFSET 0 ROWS  FETCH NEXT <1> ROWS ONLY

SELECT_RNB_CUST_FROM_DB_NEW_ONBOARD=SELECT CUSTOMER_ID,IS_CUSTOMER_EXIT,API_HIT_COUNT FROM SME_NON_RNB_CUSTOMER_DTL WHERE UPDATE_RNB_FLAG=? AND IS_CUSTOMER_EXIT='Y' AND BENE_PUSH_STATUS='NOT_PUSHED' ORDER BY REG_DATE_TIME  ASC, API_HIT_COUNT ASC  OFFSET 0 ROWS  FETCH NEXT <1> ROWS ONLY

SELECT_RNB_BENE_FROM_DB=SELECT CUSTOMER_ID, BENE_ID,BENE_NAME,BENE_TRANSFER_TYPE,BENE_ACCOUNT_NO,BENE_EMAIL_ID,BENE_MOBILE_NO,BENE_IFSC,BENE_DESC,API_HIT_COUNT,BENE_TYPE,BENE_ACCOUNT_NAME,BANK_NAME,BENE_ADDED_AMT FROM SME_BENEFICIARY_DTL WHERE CUSTOMER_ID=? AND BENE_ADD_FLAG='Y' AND BENE_MODE IN ('A','U')  AND BENE_PUSH_FLAG='N' ORDER BY API_HIT_COUNT ASC OFFSET 0 ROWS  FETCH NEXT <1> ROWS ONLY 

UPDATE_BENE_RNB_STS=UPDATE SME_BENEFICIARY_DTL SET REQUEST_DATE_TIME=CURRENT_TIMESTAMP,API_HIT_COUNT=?,BENE_PUSH_FLAG=? WHERE CUSTOMER_ID=? AND BENE_ID=?  

SELECT_RNB_CUST_LIST_FROM_DB=SELECT * FROM SME_NON_RNB_CUSTOMER_DTL WHERE IS_CUSTOMER_EXIT='Y' AND UPDATE_RNB_FLAG='Y' AND BENE_PUSH_STATUS='NOT_PUSHED' AND CUSTOMER_ID NOT IN( SELECT CUSTOMER_ID FROM SME_BENEFICIARY_DTL  WHERE BENE_ADD_FLAG='Y' AND BENE_MODE IN ('A','U') AND BENE_PUSH_FLAG='N')

UPDATE_CUST_PUSH_STATUS=UPDATE SME_NON_RNB_CUSTOMER_DTL SET BENE_PUSH_DATE_TIME=CURRENT_TIMESTAMP,BENE_PUSH_STATUS=?,IS_CUSTOMER_EXIT='N' WHERE CUSTOMER_ID=? AND IS_CUSTOMER_EXIT='Y'

########################## Added by 2299 for NO authorizer 28072020 ###########################
SELECT_APPROVER_NAME_COUNT = SELECT COUNT(*) FROM COM_APPROVALMAPPING_MST WHERE SERVICECDID =? AND ACCOUNT_NO =? AND SERVICE_CD =?
#Add new Product code - 237 for version 7.9.0 on 11-04-2023
#Product code - 237 addition in Yes MSME
SELECT_VW_CH_ACCT_CUST_XREF_CUST_REL_ACCT_NO=SELECT COD_ACCT_NO,COD_ACCT_CUST_REL FROM VW_CH_ACCT_CUST_XREF WHERE COD_CUST= ? AND ((COD_PROD BETWEEN 501 AND 599)  OR (COD_PROD BETWEEN 901 AND 999) OR (COD_PROD BETWEEN 601 AND 899) OR COD_PROD IN (207,208,237,204,210,240,236,249))
#Add new Product code - 237 for version 7.9.0 on 11-04-2023
#Product code - 237 addition in Yes MSME
SELECT_AUS_FROM_XREF_ACCT_NO=SELECT distinct COD_CUST FROM VW_CH_ACCT_CUST_XREF WHERE ((COD_PROD BETWEEN 501 AND 599)  OR (COD_PROD BETWEEN 901 AND 999) OR (COD_PROD BETWEEN 601 AND 899) OR COD_PROD IN (207,208,237,204,210,240,236,249)) AND COD_ACCT_NO IN  
COM_APPROVE_MST_INSERT_ONLY= INSERT INTO COM_APPROVE_MST (CUSTOMER_ID,APPROVER_CD,APPROVER_NAME,ID,AUTH_STATUS,MAKER_CD,MAKER_DT,MAKER_CAL_DT,AUTHOR_CD,AUTHOR_DT,AUTHOR_CAL_DT,ACTIVE_FLAG, LAST_CHANGE_ID,BANK_ID,APPROVER_ID,DATA_SOURCE) VALUES(?, ?, ?, COM_APPROVE_MST_SEQ.NEXTVAL, ?, ?, SYSDATE, SYSDATE, ?, SYSDATE,SYSDATE,?,?,?,?,?)
SELECT_APPROVER_DETAILS = SELECT MAKER_CD,AUTHOR_CD FROM COM_APPROVALMAPPING_MST WHERE SERVICECDID =? AND ACCOUNT_NO =? AND SERVICE_CD =?
SELECT_COD_ACC_NO_XREF = select COD_ACCT_NO from vw_ch_acct_cust_xref where COD_CUST=?
CHECK_ENTRY_COM_APPROVE_MST = select count(*) from com_approve_mst where CUSTOMER_ID=? and APPROVER_CD=?
SELECT_TOTAL_SCORE_FRM_MAPPING = SELECT TOTAL_SCORE,APPROVER_LIST FROM COM_APPROVALMAPPING_MST WHERE SERVICECDID=? AND ACCOUNT_NO=?

########################## Added by 2273 for Registration part 10092020 ###########################
INSERT_INTO_DROP_OFF_CUSTOMER_DTL=Insert into SME_USER_DROP_OFF_DTL (CUSTOMER_ID,COMPANY_ID,REQUEST_DT,ERROR_LOG,TRANSACTION_CHANNEL,REG_MODE_USED) values (?,?,SYSDATE,?,?,?)
DELETE_DROP_OFF_CUSTOMER_DTL=DELETE SME_USER_DROP_OFF_DTL WHERE CUSTOMER_ID = ?
SELECT_DROP_OFF_ENTRY=SELECT COUNT(*) FROM SME_USER_DROP_OFF_DTL  WHERE CUSTOMER_ID = ? AND COMPANY_ID=? AND TRANSACTION_CHANNEL=? AND REG_MODE_USED=?
DELETE_DROP_OFF_CUSTOMER_DTL_BEFORE=DELETE SME_USER_DROP_OFF_DTL WHERE CUSTOMER_ID = ? AND COMPANY_ID=? AND TRANSACTION_CHANNEL=? AND REG_MODE_USED=?
UPDATE_REGISTRATION_DTL=UPDATE SME_USER_DROP_OFF_DTL SET REQUEST_DT=SYSDATE,ERROR_LOG = ? WHERE CUSTOMER_ID = ? AND REG_MODE_USED= ? AND COMPANY_ID=? AND TRANSACTION_CHANNEL=?
COUNT_REG_USER=SELECT COUNT(*) FROM SME_REG_USER_INFO WHERE CUST_ID=?
SELECT_PAGE_GROUP=SELECT PAGE_NAME,PAGE_GROUP FROM SME_PAGE_GROUP where PAGE_GROUP is not null
CUSTOMER_ACTIVITY_INSERTS=INSERT INTO SME_MAINTAIN_CUSTOMER_ACTIVITY (CUSTOMER_ID,COMPANY_ID,SERVICE_NAME,PAGE_NAME,IS_TRANSACTIONAL,PAGE_LOAD_START_TIME,PAGE_CHAGE_TIME,TOTAL_DURATION_MIN,PLATFORM,IP_ADDRESS,PAGE_GROUP_NAME) values (?,?,?,?,?,TO_DATE(?,'dd-MM-yyyy hh24:mi:ss'),TO_DATE(?,'dd-MM-yyyy hh24:mi:ss'),?,?,?,?)
SELECT_APP_LOGIN_INFO_COUNT = SELECT COUNT(1) from SME_APP_LOGIN_INFO WHERE LOGIN_ID  = ? 
GET_COMPANY_ID_FOR_MAKER = SELECT SMEMAKERCD FROM COM_MAKER_MST WHERE MAKER_ALIAS_NAME =?

########################## Added by 2157 for TOKEN ISSUE  10092020 ###########################
l_queryLastTokenDBV =select HOST_SESSIONID,SEQ from MSME_SECURITYLOG_DTL where SEQ = (select MAX(SEQ) from MSME_SECURITYLOG_DTL where USERID = ? and SESSION_ACTIVE = 'Y')
l_querySecondLastTokenDB =select HOST_SESSIONID,NVL(TIMEDIFFERENCE,0) from MSME_SECURITYLOG_DTL where SEQ = (select MAX(SEQ) from MSME_SECURITYLOG_DTL where USERID = ? and SEQ < (select MAX(SEQ) from MSME_SECURITYLOG_DTL where  USERID = ?))
l_queryThirdLastTokenDB =select HOST_SESSIONID,NVL(TIMEDIFFERENCE,0) from MSME_SECURITYLOG_DTL where SEQ = (select MAX(SEQ) from MSME_SECURITYLOG_DTL where USERID = ? and SEQ < (select MAX(SEQ) from MSME_SECURITYLOG_DTL where  USERID = ? and SEQ < (select MAX(SEQ) from MSME_SECURITYLOG_DTL where  USERID = ?)))
l_insertNewRequestIntoDB =INSERT INTO msme_securitylog_dtl(seq,userid,logindt,requesttime,serviceid,session_active)VALUES(msme_securitylog_dtl_seq.nextval,?,sysdate,sysdate,?,'Y')
l_updateSessionFlag =UPDATE msme_securitylog_dtl SET session_active = 'N' where SEQ = ?
l_queryLastTokenDB =select MAX(SEQ) from MSME_SECURITYLOG_DTL where USERID = ? and SESSION_ACTIVE = 'Y' and serviceid = ?
l_updateSession =UPDATE msme_securitylog_dtl SET RESPONSETIME = sysdate, TIMEDIFFERENCE = (select CEIL((SYSDATE - cast (requesttime AS DATE)) * 86400000) from msme_securitylog_dtl where SEQ = ?), HOST_SESSIONID = ? where SEQ = ?
l_insertSmeAppInfo =INSERT INTO msme_securitylog_dtl(seq,userid,logindt,requesttime,serviceid,session_active,HOST_SESSIONID)VALUES(msme_securitylog_dtl_seq.nextval,?,sysdate,sysdate,?,'Y',?)
queryTokenInDb =select REQ_TOKEN from SME_APP_LOGIN_INFO where LOGIN_ID = ?
SELECT_FROM_IMAGE_OFFER_POR=SELECT portal_source_folder,portal_file_name,portal_file_priority,portal_urls FROM sme_offer_images_mst WHERE portal_display_at = ? AND active_flag = 'Y' AND TO_DATE(TO_CHAR(portal_offer_start_date,'dd-MM-yyyy'),'dd-MM-yyyy') <= TO_DATE(TO_CHAR(sysdate,'dd-MM-yyyy'),'dd-MM-yyyy') AND TO_DATE(TO_CHAR(portal_offer_end_date,'dd-MM-yyyy'),'dd-MM-yyyy') >= TO_DATE(TO_CHAR(sysdate,'dd-MM-yyyy'),'dd-MM-yyyy') ORDER BY portal_offer_start_date desc
SELECT_FROM_IMAGE_OFFER_MOB=SELECT mobile_source_folder, mobile_file_name, mobile_file_priority, mobile_urls FROM sme_offer_images_mst WHERE mobile_display_at = ? AND active_flag = 'Y' AND TO_DATE(TO_CHAR(mobile_offer_start_date,'dd-MM-yyyy'),'dd-MM-yyyy') <= TO_DATE(TO_CHAR(sysdate,'dd-MM-yyyy'),'dd-MM-yyyy') AND TO_DATE(TO_CHAR(mobile_offer_end_date,'dd-MM-yyyy'),'dd-MM-yyyy') >= TO_DATE(TO_CHAR(sysdate,'dd-MM-yyyy'),'dd-MM-yyyy') ORDER BY mobile_offer_start_date desc

#################################
INSERT_REQUEST_RESPONSE_MANAGE_CARD=INSERT INTO SME_MAINTAIN_TXN_CNT (SRN,CUSTOMER_ID,REQUEST_FOR_API,REQUEST_API_SSL,TXN_INITIATE_DATETIME,TXN_FLAG,TXN_COUNT,EXTUNIQUEREFID,SERVICE_CD,PAYMENT_MODE,COMPANY_ID,TXN_STATUS_FLAG,IP_ADDRESS,PLATFORM_TYPE,HEADER,PLATFORM) VALUES (?,?,?,?,systimestamp,?,?,?,?,?,?,?,?,?,?,?)
UPDATE_RESPONSE_MANAGE_CARD=UPDATE SME_MAINTAIN_TXN_CNT SET TXN_FINISH_DATETIME = SYSDATE , RESPONSE_FROM_API = ? , TXN_STATUS_FLAG = ? WHERE EXTUNIQUEREFID= ?

############################ Added by 2273 for BILL DESK
SELECT_CNT_FOR_DESK=SELECT SME_BILL_DESK.NEXTVAL FROM DUAL
#INSERT_BILL_DESK=INSERT INTO SME_MAINTAIN_BILL_DESK(SRN,CUSTOMER_ID,COMPANY_ID,REQUEST_FOR_API,SERVICE_CD,TXN_INITIATE_DATETIME) VALUES(?,?,?,?,?,SYSDATE)
INSERT_BILL_DESK=INSERT INTO SME_MAINTAIN_BILL_DESK(SRN,CUSTOMER_ID,COMPANY_ID,REQUEST_FOR_API,SERVICE_CD,TXN_INITIATE_DATETIME,IP_ADDRESS,PLATFORM,HEADER) VALUES(?,?,?,?,?,SYSDATE,?,?,?)
UPDATE_BILL_DESK=UPDATE SME_MAINTAIN_BILL_DESK SET RESPONSE_FROM_API=?,TXN_FINISH_DATETIME=SYSDATE WHERE SRN=? AND CUSTOMER_ID=?
FETCH_MAKER_LIST=SELECT MAKER_ALIAS_NAME FROM COM_MAKER_MST WHERE AUTHORIZER_CUST_ID=? AND active_flag='Y'
MAKER_ALERT_INSERT=INSERT INTO NOTIFICATION (NOTIFICATION_ID,NOTIFICATION_TAG_NAME,NOTIFICATION_DESCRIPTION,CUSTOMER_ID,CREATED_ON,SEND_STATUS) VALUES (NOTIFICATION_SEQ.NEXTVAL,?,?,?,sysdate,?)

###added y 2330 for 10 march 2021 for account statement 
BRANCH_ADDRESS_ACCOUNT_STATEMENT =  SELECT NAM_BRANCH from VW_IFSC where COD_ACCT_NO=cast(? as char(48))
CUSTOMER_DETAILS_ACCOUNT_STATEMENT = SELECT NAM_CUST_FULL,TXT_CUSTADR_ADD1,NVL(TXT_CUSTADR_ADD2,' '),NVL(TXT_CUSTADR_ADD3,' '),NVL(NAM_CUSTADR_CITY,' '),NVL(NAM_CUSTADR_STATE,' '),NVL(NAM_PERMADR_CNTRY,' '),NVL(TXT_PERMADR_ZIP,' ') from MV_CI_CUSTMAST_ALL where  COD_CUST_ID = ? 

############################ Added by 2273 for Beneficiary update module #################
UPDATE_BENE_FROM_TABLE=UPDATE SME_BENEFICIARY_DTL SET BENE_MODE = 'D',BENE_ADD_DT=SYSDATE  WHERE BENE_ID IN (
FETCH_BENE_DTL=SELECT BENE_MODE,BENE_IFSC,BENE_ACCOUNT_NO,BENE_TRANSFER_TYPE,TO_CHAR(BENE_ADD_DT, 'DD-MM-YYYY') FROM SME_BENEFICIARY_DTL WHERE BENE_ID=? AND CUSTOMER_ID=?
BENE_DTL=SELECT BENE_MODE,BENE_IFSC,BENE_ACCOUNT_NO,BENE_TRANSFER_TYPE,BENE_MOBILE_NO,BENE_PUSH_FLAG FROM SME_BENEFICIARY_DTL WHERE BENE_ID=? AND CUSTOMER_ID=?
UPDATE_BENE_DTL_FRM_API=UPDATE SME_BENEFICIARY_DTL SET BENE_MODE='U',BENE_IFSC =?,BENE_ACCOUNT_NO=?,BENE_NAME =?,BENE_TRANSFER_TYPE=?,BENE_ADD_DT=SYSDATE WHERE BENE_ID=? AND CUSTOMER_ID = ?
UPDATE_SME_GROUP=UPDATE SME_GROUP_BENE_DTL SET GROUP_MODE = 'D',BENE_ADD_FLAG='N',GROUP_ADD_FLG='N',BENE_MOD_DATE=SYSDATE,GROUP_MOD_DATE=SYSDATE WHERE GROUP_ID=? AND CUSTOMER_ID=? AND BENE_ID=?

#-----------------//FRM Integeration by 2459 at 2023--------------------------------------------------------------------------------------
GET_DEVICE_BND_DATE = SELECT TO_CHAR(MOBILE_REG_DATE, 'YYYY-MM-dd HH24:MI:SS.FF1') FROM SME_REGISTRATION_DATE_DTL WHERE REG_ID=?
GET_LOGIN_CNT = select count(*) from SME_USER_INTERFACE_SERVICE_DTL where SERVICE_NAME=? and CUSTOMER_ID=?
GET_AUTH_FACTOR = select SECOND_FACTOR from SME_FRM_BAND_FACTOR where RISK_BAND=? and DEVICE_TYPE=?

#-----------------------------------Sim Binding 2023----2459-------------------------------------------------
SME_SIMBND_DTL_SEQ = SELECT SME_SIMBND_DTL_SEQ.NEXTVAL FROM DUAL

INSERT_SME_SIMBND_DTL=INSERT INTO SME_SIMBND_DTL(ID,CUSTOMER_ID,VERIFIED,CREATED_DATE,MSG)VALUES(?,?,'N',CURRENT_TIMESTAMP,?)

UPDATE_SME_SIMBND_DTL =UPDATE SME_SIMBND_DTL SET VERIFIED=?,VERIFICATION_DATE=CURRENT_TIMESTAMP,SENT_DATE_TIME=?,MOBILE_NUMBER=? WHERE MSG=? and VERIFIED='N'

SELECT_SME_SIMBND_DTL =SELECT CUSTOMER_ID FROM SME_SIMBND_DTL WHERE MSG=?
     
GET_MOBILE_NO_FROM_VIEW=SELECT REF_CUST_TELEX FROM MV_CI_CUSTMAST_ALL WHERE COD_CUST_ID=?

GET_SME_SIMBND_VERIFICATION_FLAG=SELECT count(*) FROM SME_SIMBND_DTL WHERE VERIFIED='Y' and CUSTOMER_ID=? and MSG=?

########################OTP flooding attack################################
LAST_SERVICE_CALL=select TO_CHAR(max(NAVIGATE_DT), 'DD-MON-YYYY HH24:MI:SS'),TO_CHAR(systimestamp, 'DD-MON-YYYY HH24:MI:SS')  from SME_USER_INTERFACE_SERVICE_DTL where CUSTOMER_ID =? and SERVICE_NAME=?

#Added BY Swapnil  On 26-07-2022 for giving maker creation limit to checker
PER_DAY_MAKER_COUNT=SELECT COUNT(*) FROM COM_MAKER_MST WHERE SUBSTR(SMEMAKERCD,0, INSTR(SMEMAKERCD,'_')-1)=? AND  TO_CHAR(INTIATED_TIME,'dd-MM-yy')= TO_CHAR(SYSDATE,'dd-MM-yy')

##############################CRM###June2022###################################
SELECT_CRM_MASTER=SELECT CRMI.CASE_ID,CRMI.ISSUE_ID,CRMC.CASE_NAME,CRMI.CATEGORY_TYPE ,CRMI.ISSUE_NAME FROM SME_CRM_ISSUE_MST CRMI ,SME_CRM_CASE_MST CRMC WHERE  CRMI.CASE_ID = CRMC.CASE_ID AND CRMI.AUTH_STATUS = CRMC.AUTH_STATUS AND CRMI.AUTH_STATUS ='A' AND CRMI.ACTIVE_FLAG = CRMC.ACTIVE_FLAG AND CRMC.ACTIVE_FLAG='Y' ORDER BY CRMC.CASE_ID,CRMI.ISSUE_ID,CRMI.ISSUE_NAME
SELECT_SEQ_FOR_API_DTL=SELECT SME_MAINTAIN_API_DTL_SEQ.NEXTVAL FROM DUAL
INSERT_API_DTL=INSERT INTO SME_MAINTAIN_API_DTL(SRN,CUSTOMER_ID,COMPANY_ID,REQUEST_FOR_API,SERVICE_CD,API_INITIATE_DATETIME,IP_ADDRESS,PLATFORM,HEADER) VALUES(?,?,?,?,?,SYSDATE,?,?,?)
UPDATE_API_DTL=UPDATE SME_MAINTAIN_API_DTL SET RESPONSE_FROM_API=?,API_FINISH_DATETIME=SYSDATE WHERE SRN=? AND CUSTOMER_ID=?

SELECT_SEQ_FOR_CRM_CASE_DTL=SELECT SME_CRM_CASE_DTL_SEQ.NEXTVAL FROM DUAL
INSERT_SME_CRM_CASE_DTL = INSERT INTO SME_CRM_CASE_DTL(ID,CUSTOMER_ID,COMPANY_ID,ISSUE_ID,REMARKS,CREATE_DATETIME,PLATFORM) VALUES(?,?,?,?,?,SYSDATE,?)
UPDATE_CASEID_SME_CRM_CASE_DTL = UPDATE SME_CRM_CASE_DTL SET API_CASE_ID=?,STATUS=?,REASON=?,UPDATE_DATETIME=SYSDATE WHERE ID = ?
#SELECT_SME_CRM_CASE_DTL= SELECT CASEDTL.ISSUE_ID,ISS.ISSUE_NAME,ISS.CATEGORY_TYPE,CASEMST.CASE_NAME,CASEDTL.REMARKS from SME_CRM_CASE_DTL CASEDTL, SME_CRM_ISSUE_MST ISS ,SME_CRM_CASE_MST CASEMST WHERE ISS.ISSUE_ID=CASEDTL.ISSUE_ID and CASEMST.CASE_ID = ISS.CASE_ID and CASEDTL.API_CASE_ID=?
SELECT_SME_CRM_CASE_DTL=SELECT CASEDTL.ISSUE_ID,ISS.ISSUE_NAME,ISS.CATEGORY_TYPE,CASEMST.CASE_NAME,CASEDTL.REMARKS,ISS.TURNAROUND_TIME from SME_CRM_CASE_DTL CASEDTL, SME_CRM_ISSUE_MST ISS ,SME_CRM_CASE_MST CASEMST WHERE ISS.ISSUE_ID=CASEDTL.ISSUE_ID and CASEMST.CASE_ID = ISS.CASE_ID and CASEDTL.API_CASE_ID=?

#------------TAT_CR_NEW_SCRIPT JUNE-2024-----------------------------------------------------

SELECT_TURNAROUND_TIME=SELECT ASSIGN_TEAM, TURNAROUND_TIME FROM SME_CRM_ISSUE_MST WHERE  ISSUE_ID = ? 
SELECT_TURNAROUND_TIME_BY_API_CASEID=SELECT ISS.TURNAROUND_TIME FROM SME_CRM_CASE_DTL CASEDTL, SME_CRM_ISSUE_MST ISS  WHERE ISS.ISSUE_ID = CASEDTL.ISSUE_ID AND CASEDTL.API_CASE_ID = ?
SELECT_ISSUE_DETAILS_FOR_CUSTOMER=SELECT CASEDTL.ISSUE_ID, ISS.ISSUE_NAME, ISS.CATEGORY_TYPE,CASEMST.CASE_NAME ,CASEDTL.REMARKS,ISS.ASSIGN_TEAM, ISS.TURNAROUND_TIME,CASEDTL.API_CASE_ID,CASEDTL.CREATE_DATETIME,CASEDTL.STATUS FROM SME_CRM_CASE_DTL CASEDTL, SME_CRM_ISSUE_MST ISS, SME_CRM_CASE_MST CASEMST WHERE ISS.ISSUE_ID = CASEDTL.ISSUE_ID AND CASEMST.CASE_ID = ISS.CASE_ID AND CASEDTL.CUSTOMER_ID = ?


############################8CR changes for Approved time fetch#############################
FETCH_APPROVED_DATE = select TO_CHAR(AUTH_DT, 'DD-MON-YYYY HH24:MI:SS')  from SME_TXN_APPROVAL_ACTIVITY_LOG where  TRAN_REF_NO=?

###########################################Added by Swapnil for Maker Transaction Count###############################
PER_DAY_MAKER_TRANSACTION_COUNT=SELECT count(*) FROM SME_SINGLE_TXN_MAKER_DTL WHERE SERVICECD IN('FT01','FT02','FT03','GT01','EC02') AND MAKER_ID=? AND TO_CHAR(MAKE_DT,'dd-MM-yy')= TO_CHAR(SYSDATE,'dd-MM-yy')
PER_DAY_MAKER_BULK_TRANSACTION_COUNT=SELECT count(*) FROM SME_BULK_TRANSACTION_DTL WHERE MAKER_ID=? AND TO_CHAR(INITIATED_DATE_TIME,'dd-MM-yy')= TO_CHAR(SYSDATE,'dd-MM-yy')
PER_DAY_MAKER_SALARY_TRANSACTION_COUNT=SELECT count(*) FROM SME_SALARY_TRANSACTION_DTL WHERE MAKERID=? AND TO_CHAR(MAKER_DT,'dd-MM-yy')= TO_CHAR(SYSDATE,'dd-MM-yy')
MAKER_TRANSACTION_COUNT_FROM_COM_MAKER_MASTER=SELECT TRANSACTIONCNT FROM COM_MAKER_MST WHERE MAKER_ALIAS_NAME=? AND ACTIVE_FLAG='Y'


############################View Limit CR#############################
SELECT_COD_ACCT_NO_FROM_VW_CH_ACCT_MAST=SELECT COD_ACCT_NO FROM VW_CH_ACCT_MAST WHERE COD_CUST = ?

SELECT_ACCOUNT_NO_SERVICE_CD_GROUP_NAME_DAILY_LIMIT=select a.ACCOUNT_NO,a.SERVICE_CD,b.GROUP_NAME,a.daily_limit from COM_APPROVAL_GRP_MST a,com_servicegroup b where a.service_cd = b.group_id  and a.ACCOUNT_NO =? order by a.SERVICE_CD




########################## Deregister User for mobile device - 27-02-2023 ################ 
SELECT_COUNT_FROM_SME_REG_USER_INFO_FOR_DEREGISTER=SELECT COUNT(*) FROM SME_REG_USER_INFO WHERE CUST_ID =?

UPDATE_SME_REG_USER_INFO_SET_REGISTERED_DT_FOR_DEREGISTER=UPDATE SME_REG_USER_INFO SET REGISTERED_DT=SYSDATE, MPIN=?, APIN=?, REG_ID=? WHERE CUST_ID=?



DUAL_ENTRY_CHECK_IN_SME_TRANSACTION_DTL=SELECT COUNT(*) FROM SME_TRANSACTION_DTL WHERE CUSTOMER_ID = ? AND  SOURCE_ACC_NO = ? AND TRAN_AMOUNT = ? AND TRAN_TYPE = ? AND REMARKS = ? AND DEST_ACC_NO = ? AND TO_DATE(TRAN_DATE) in (trunc(SYSDATE))
